<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>OmniService TG ‚Äî Services professionnels √† Lom√©</title>
<meta name="description" content="OmniService TG ‚Äî Alimentation, livraison, nettoyage, restauration et plus √† Lom√©, Togo."/>
<meta name="theme-color" content="#1E6FBE"/>
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="default"/>
<meta name="apple-mobile-web-app-title" content="OmniService TG"/>
<meta name="msapplication-TileColor" content="#1E6FBE"/>
<meta property="og:title" content="OmniService TG"/>
<meta property="og:description" content="Alimentation, livraison, nettoyage, restauration et plus √† Lom√©, Togo."/>
<meta property="og:type" content="website"/>
<link rel="manifest" href="manifest.json"/>
<link rel="icon" href="assets/logo.png" type="image/png"/>
<link rel="apple-touch-icon" href="assets/logo.png"/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;800;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="style.css"/>
<style>
/* ‚ïê‚ïê Override grille services : 2 colonnes, grandes cases ‚ïê‚ïê */
.svc-grid{display:grid;grid-template-columns:repeat(2,1fr)!important;gap:14px!important}
.svc-btn{background:#fff;border:none;border-radius:20px;padding:24px 10px;display:flex;flex-direction:column;align-items:center;gap:10px;cursor:pointer;box-shadow:0 2px 12px rgba(0,0,0,.08);transition:all .22s;position:relative;min-height:140px;justify-content:center;width:100%}
.svc-btn:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(30,111,190,.18)}
.svc-ico{width:68px;height:68px;border-radius:18px;display:flex;align-items:center;justify-content:center;font-size:34px}
.svc-lbl{font-size:13px;font-weight:700;color:#4A4A6A;text-align:center;line-height:1.3}
.svc-soon{position:absolute;top:-7px;right:-2px;background:#F5820A;color:#fff;font-size:7.5px;font-weight:800;padding:3px 7px;border-radius:999px;line-height:1.5}
@media(min-width:480px){.svc-grid{grid-template-columns:repeat(3,1fr)!important}}
@media(min-width:768px){.svc-grid{grid-template-columns:repeat(4,1fr)!important}}
</style>
#view-restaurants { padding-bottom: 20px; }

/* ‚ïê‚ïê KITS VIEW ‚ïê‚ïê */
#view-kits { padding-bottom: 20px; }
#view-kit-detail { padding-bottom: 20px; }

.kit-card {
  display: flex;
  align-items: flex-start;
  gap: 14px;
  background: #fff;
  border-radius: 18px;
  padding: 14px 16px;
  margin: 0 16px 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,.08);
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
  position: relative;
  overflow: hidden;
}
.kit-card:active { transform: scale(.98); }
.kit-card:hover { box-shadow: 0 4px 20px rgba(30,111,190,.15); }
.kit-img-wrap {
  width: 80px;
  height: 80px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  overflow: hidden;
}
.kit-body { flex: 1; min-width: 0; }
.kit-badge {
  display: inline-block;
  font-size: 9px;
  font-weight: 800;
  color: #1E6FBE;
  background: #E3F2FD;
  border-radius: 999px;
  padding: 3px 9px;
  text-transform: uppercase;
  letter-spacing: .4px;
  margin-bottom: 5px;
}
.kit-name {
  font-size: 14px;
  font-weight: 700;
  color: #1A1A2E;
  margin-bottom: 3px;
}
.kit-desc {
  font-size: 11px;
  color: #4A4A6A;
  line-height: 1.4;
  margin-bottom: 8px;
}
.kit-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.kit-price {
  font-size: 14px;
  font-weight: 800;
  color: #1E6FBE;
}
.kit-count {
  font-size: 10px;
  font-weight: 600;
  color: #9999BB;
  background: #F4F6FA;
  border-radius: 999px;
  padding: 3px 9px;
}
.kit-arrow { font-size: 22px; color: #E8EAF0; flex-shrink: 0; align-self: center; }

/* ‚ïê‚ïê KIT DETAIL ‚ïê‚ïê */
.kit-detail-hero {
  margin: 0 16px 14px;
  background: linear-gradient(135deg, #1E6FBE, #155A9C);
  border-radius: 20px;
  padding: 22px 20px;
  color: #fff;
  position: relative;
  overflow: hidden;
}
.kit-detail-hero::before {
  content: attr(data-emoji);
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 70px;
  opacity: .2;
}
.kit-detail-hero-name {
  font-size: 18px;
  font-weight: 800;
  font-family: 'Nunito', sans-serif;
  margin-bottom: 5px;
}
.kit-detail-hero-desc {
  font-size: 12px;
  color: rgba(255,255,255,.75);
  line-height: 1.5;
  margin-bottom: 12px;
}
.kit-detail-hero-price {
  font-size: 22px;
  font-weight: 900;
  font-family: 'Nunito', sans-serif;
  color: #fff;
}
.kit-detail-hero-price-label {
  font-size: 10px;
  color: rgba(255,255,255,.55);
  text-transform: uppercase;
  letter-spacing: .5px;
  margin-bottom: 3px;
}

.kit-articles-card {
  margin: 0 16px 14px;
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 2px 12px rgba(0,0,0,.07);
  overflow: hidden;
}
.kit-articles-title {
  padding: 14px 18px 10px;
  font-size: 13px;
  font-weight: 700;
  color: #1A1A2E;
  border-bottom: 1px solid #F0F0F8;
}
.kit-article-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 11px 18px;
  border-bottom: 1px solid #F4F6FA;
}
.kit-article-row:last-child { border-bottom: none; }
.kit-article-emoji {
  font-size: 22px;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #F4F6FA;
  border-radius: 10px;
  flex-shrink: 0;
}
.kit-article-info { flex: 1; min-width: 0; }
.kit-article-name { font-size: 13px; font-weight: 600; color: #1A1A2E; }
.kit-article-qty { font-size: 11px; color: #9999BB; margin-top: 2px; }
.kit-article-price { font-size: 12px; font-weight: 700; color: #1E6FBE; }

.kit-order-btn {
  display: block;
  margin: 0 16px 16px;
  width: calc(100% - 32px);
  background: linear-gradient(135deg, #1E6FBE, #155A9C);
  color: #fff;
  border: none;
  border-radius: 16px;
  padding: 16px;
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  box-shadow: 0 4px 18px rgba(30,111,190,.35);
  transition: all .2s;
}
.kit-order-btn:hover { transform: translateY(-1px); box-shadow: 0 8px 28px rgba(30,111,190,.45); }

.kits-section-title {
  font-size: 12px;
  font-weight: 800;
  color: #9999BB;
  text-transform: uppercase;
  letter-spacing: .6px;
  padding: 16px 16px 8px;
}
  display: flex;
  align-items: center;
  gap: 14px;
  background: #fff;
  border-radius: 18px;
  padding: 14px 16px;
  margin: 0 16px 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,.08);
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
  position: relative;
  overflow: hidden;
}
.restaurant-card:active { transform: scale(.98); }
.restaurant-card:hover { box-shadow: 0 4px 20px rgba(30,111,190,.15); }
.rst-img-wrap {
  width: 72px;
  height: 72px;
  border-radius: 14px;
  background: linear-gradient(135deg,#E3F2FD,#BBDEFB);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  overflow: hidden;
}
.rst-body { flex: 1; min-width: 0; }
.rst-name {
  font-size: 14px;
  font-weight: 700;
  color: #1A1A2E;
  margin-bottom: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.rst-spec { font-size: 11px; color: #1E6FBE; font-weight: 600; margin-bottom: 2px; }
.rst-loc  { font-size: 10px; color: #9999BB; }
.rst-desc { font-size: 11px; color: #4A4A6A; margin-top: 4px; line-height: 1.4; }
.rst-arrow { font-size: 22px; color: #E8EAF0; flex-shrink: 0; }
.rst-section-title {
  font-size: 12px;
  font-weight: 800;
  color: #9999BB;
  text-transform: uppercase;
  letter-spacing: .6px;
  padding: 16px 16px 8px;
}

#auth-modal{
  display:none;position:fixed;inset:0;z-index:2000;
  background:rgba(10,18,32,.75);backdrop-filter:blur(6px);
  align-items:center;justify-content:center;padding:16px;
}
.auth-box{
  background:#fff;border-radius:24px;width:100%;max-width:420px;
  box-shadow:0 30px 80px rgba(0,0,0,.35);overflow:hidden;
  max-height:92vh;overflow-y:auto;
}
.auth-header{
  background:linear-gradient(135deg,#1E6FBE,#155A9C);
  padding:24px 24px 20px;text-align:center;position:relative;
}
.auth-header-logo{
  display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:6px;
}
.auth-header-logo img{width:36px;height:36px;object-fit:contain;border-radius:9px}
.auth-header-brand{
  font-family:'Nunito',sans-serif;font-size:20px;font-weight:900;color:#fff;
}
.auth-header-sub{font-size:11px;color:rgba(255,255,255,.6);margin-top:2px}
.auth-close{
  position:absolute;top:14px;right:14px;
  background:rgba(255,255,255,.15);border:none;color:#fff;
  width:30px;height:30px;border-radius:50%;cursor:pointer;
  font-size:16px;display:flex;align-items:center;justify-content:center;
}
.auth-tabs{
  display:flex;border-bottom:1.5px solid #E8EAF0;
}
.auth-tab{
  flex:1;padding:14px;text-align:center;font-size:13px;font-weight:700;
  cursor:pointer;color:#9999BB;border:none;background:transparent;
  font-family:'Poppins',sans-serif;transition:all .2s;
  border-bottom:2.5px solid transparent;margin-bottom:-1.5px;
}
.auth-tab.on{color:#1E6FBE;border-bottom-color:#1E6FBE}
.auth-panel{padding:22px 24px 28px}
.auth-field{margin-bottom:14px}
.auth-label{
  display:block;font-size:11px;font-weight:700;color:#4A4A6A;
  margin-bottom:5px;text-transform:uppercase;letter-spacing:.4px;
}
.auth-inp{
  width:100%;padding:11px 13px;border:1.5px solid #E8EAF0;border-radius:11px;
  font-size:13px;font-family:'Poppins',sans-serif;background:#F4F6FA;outline:none;
  color:#1A1A2E;transition:border-color .2s,background .2s;
}
.auth-inp:focus{border-color:#1E6FBE;background:#fff}
.auth-inp-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.auth-btn{
  width:100%;background:linear-gradient(135deg,#1E6FBE,#155A9C);color:#fff;
  border:none;border-radius:999px;padding:14px;font-size:14px;font-weight:700;
  cursor:pointer;font-family:'Poppins',sans-serif;margin-top:6px;
  box-shadow:0 4px 18px rgba(30,111,190,.35);transition:all .2s;
  display:flex;align-items:center;justify-content:center;gap:8px;
}
.auth-btn:hover{transform:translateY(-1px);box-shadow:0 8px 28px rgba(30,111,190,.45)}
.auth-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.auth-err{
  min-height:18px;font-size:12px;font-weight:600;color:#C62828;
  text-align:center;margin-top:10px;
}
.auth-sep{
  text-align:center;font-size:11px;color:#9999BB;
  margin:14px 0 10px;display:flex;align-items:center;gap:10px;
}
.auth-sep::before,.auth-sep::after{content:'';flex:1;height:1px;background:#E8EAF0}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.4);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* ‚ïê‚ïê PROFIL REFACTO ‚ïê‚ïê */
#prof-auth-card{
  background:#fff;border-radius:16px;padding:22px;text-align:center;
  box-shadow:0 2px 12px rgba(0,0,0,.07);margin-bottom:16px;
}
#prof-auth-card .auth-card-title{
  font-size:15px;font-weight:700;color:#1A1A2E;margin-bottom:6px;
}
#prof-auth-card .auth-card-sub{
  font-size:12px;color:#9999BB;margin-bottom:16px;line-height:1.6;
}
#prof-auth-card .btn-row{display:flex;gap:10px}
#prof-auth-card .btn-login{
  flex:1;background:linear-gradient(135deg,#1E6FBE,#155A9C);color:#fff;
  border:none;border-radius:999px;padding:12px;font-size:13px;font-weight:700;
  cursor:pointer;font-family:'Poppins',sans-serif;
}
#prof-auth-card .btn-signup{
  flex:1;background:#fff;color:#1E6FBE;border:1.5px solid #1E6FBE;
  border-radius:999px;padding:12px;font-size:13px;font-weight:700;
  cursor:pointer;font-family:'Poppins',sans-serif;
}

/* ‚ïê‚ïê SECTION COMMANDES PAGE ‚ïê‚ïê */
.orders-user-info{
  background:#fff;border-radius:16px;padding:14px 18px;
  box-shadow:0 2px 12px rgba(0,0,0,.07);margin-bottom:18px;
  display:flex;align-items:center;gap:12px;
}
.orders-user-avatar{
  font-size:32px;width:48px;height:48px;display:flex;
  align-items:center;justify-content:center;
  background:linear-gradient(135deg,#1E6FBE,#155A9C);
  border-radius:50%;
}
.orders-user-name{font-size:13px;font-weight:700;color:#1A1A2E}
.orders-user-phone{font-size:11px;color:#9999BB;margin-top:2px}
.orders-refresh-btn{
  margin-left:auto;background:#F4F6FA;border:1.5px solid #E8EAF0;
  border-radius:999px;padding:8px 14px;font-size:11px;font-weight:700;
  cursor:pointer;color:#4A4A6A;font-family:'Poppins',sans-serif;white-space:nowrap;
}
.orders-refresh-btn:hover{background:#E3F2FD;border-color:#1E6FBE;color:#1E6FBE}

/* ‚ïê‚ïê BOUTON ANNULATION COMMANDE ‚ïê‚ïê */
.o-cancel-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 7px;
  width: 100%;
  margin-top: 8px;
  background: #FFF5F5;
  border: 1.5px solid #FFCDD2;
  border-radius: 12px;
  padding: 11px 16px;
  font-size: 12px;
  font-weight: 700;
  color: #C62828;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  transition: all .15s;
}
.o-cancel-btn:hover {
  background: #FFEBEE;
  border-color: #C62828;
  box-shadow: 0 2px 10px rgba(198,40,40,.15);
}

/* ‚ïê‚ïê CONTENEUR DES ACTIONS COMMANDE ‚ïê‚ïê */
.o-actions {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 0;
}

/* ‚ïê‚ïê BOUTON VOIR ARTICLES COMMAND√âS ‚ïê‚ïê */
.o-articles-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 7px;
  width: 100%;
  background: #EEF4FF;
  border: 1.5px solid #C5D8FF;
  border-radius: 12px;
  padding: 11px 16px;
  font-size: 12px;
  font-weight: 700;
  color: #1E6FBE;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  transition: all .15s;
}
.o-articles-btn:hover {
  background: #E3F2FD;
  border-color: #1E6FBE;
  box-shadow: 0 2px 10px rgba(30,111,190,.15);
}

@keyframes slideUp {
  from { transform: translateY(100%); }
  to   { transform: translateY(0); }
}

/* ‚ïê‚ïê NOTIFICATION PANEL ‚ïê‚ïê */
@keyframes notifSlideIn {
  from { opacity:0; transform:translateY(-10px) scale(.97); }
  to   { opacity:1; transform:translateY(0) scale(1); }
}

/* ‚ïê‚ïê PRIVACY MODAL ‚ïê‚ïê */
#privacy-modal {
  display:none;position:fixed;inset:0;z-index:4000;
  background:rgba(10,18,32,.75);backdrop-filter:blur(6px);
  align-items:flex-end;justify-content:center;padding:0;
}
#privacy-modal.open { display:flex; }
.privacy-box {
  background:#fff;border-radius:28px 28px 0 0;width:100%;max-width:600px;
  max-height:90vh;overflow-y:auto;
  box-shadow:0 -8px 40px rgba(0,0,0,.2);
  animation:privacyUp .3s cubic-bezier(.16,1,.3,1);
}
@keyframes privacyUp {
  from { transform:translateY(100%); opacity:0; }
  to   { transform:translateY(0); opacity:1; }
}
.privacy-header {
  position:sticky;top:0;background:#fff;padding:20px 22px 14px;
  border-bottom:1px solid #F0F0F8;display:flex;align-items:center;
  justify-content:space-between;z-index:1;
}
.privacy-title { font-family:'Nunito',sans-serif;font-size:18px;font-weight:900;color:#1A1A2E; }
.privacy-close { background:none;border:none;font-size:22px;color:#9999BB;cursor:pointer;padding:4px; }
.privacy-body { padding:20px 22px 40px; }
.privacy-section { margin-bottom:22px; }
.privacy-section-title { font-size:13px;font-weight:800;color:#1E6FBE;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px;display:flex;align-items:center;gap:6px; }
.privacy-section p { font-size:13px;color:#4A4A6A;line-height:1.7;margin:0; }
.privacy-trust-badges { display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px; }
.privacy-badge { background:#F4F6FA;border-radius:14px;padding:14px;text-align:center; }
.privacy-badge-ico { font-size:24px;margin-bottom:6px; }
.privacy-badge-label { font-size:11px;font-weight:700;color:#1A1A2E; }
.privacy-badge-sub { font-size:10px;color:#9999BB;margin-top:2px; }
</style>
</head>
<body>

<!-- ‚ïê‚ïê SPLASH SCREEN ‚ïê‚ïê -->
<div id="splash-screen">
  <div class="splash-bg"></div>
  <div class="splash-content">
    <div class="splash-logo-wrap">
      <div class="splash-logo-ring"></div>
      <div class="splash-logo-box">
        <img src="assets/logo.png" alt="OmniService TG" id="splash-img"
             onerror="this.outerHTML='<div class=splash-fallback>üõ°Ô∏è</div>'"/>
      </div>
    </div>
    <div class="splash-brand">
      <span class="splash-blue">Omni</span><span class="splash-ora">Service</span> <span class="splash-blue">TG</span>
    </div>
    <div class="splash-tagline">Appelez, on s'en charge</div>
    <div class="splash-loader">
      <div class="splash-loader-bar"></div>
    </div>
    <div class="splash-footer">üáπüá¨ Bas√© √† Lom√©, Togo</div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL AUTH (Connexion / Inscription) ‚ïê‚ïê -->
<div id="auth-modal" onclick="if(event.target===this)closeAuthModal()">
  <div class="auth-box">
    <!-- Header avec logo + nom -->
    <div class="auth-header">
      <div class="auth-header-logo">
        <img src="assets/logo.png" alt="OmniService TG" onerror="this.outerHTML='üõ°Ô∏è'"/>
        <div class="auth-header-brand">
          <span style="color:#fff">Omni</span><span style="color:#F5820A">Service</span> <span style="color:#fff">TG</span>
        </div>
      </div>
      <div class="auth-header-sub">Votre espace personnel OmniService</div>
      <button class="auth-close" onclick="closeAuthModal()">‚úï</button>
    </div>
    <!-- Onglets -->
    <div class="auth-tabs">
      <button class="auth-tab on" id="auth-tab-login"  onclick="switchAuthTab('login')">Connexion</button>
      <button class="auth-tab"    id="auth-tab-signup" onclick="switchAuthTab('signup')">Inscription</button>
    </div>
    <!-- Panneau Connexion (par t√©l√©phone) -->
    <div id="auth-login-panel" class="auth-panel">
      <div class="auth-field">
        <label class="auth-label">Num√©ro de t√©l√©phone</label>
        <input type="tel" class="auth-inp" id="login-phone" placeholder="+228 XX XX XX XX" autocomplete="tel"
               onkeydown="if(event.key==='Enter')doLogin()"/>
      </div>
      <button class="auth-btn" id="login-btn" onclick="doLogin()">Se connecter ‚Üí</button>
      <div class="auth-err" id="auth-err"></div>
      <div class="auth-sep">Pas encore de compte ?</div>
      <button style="width:100%;background:transparent;border:1.5px solid #1E6FBE;color:#1E6FBE;border-radius:999px;padding:12px;font-size:13px;font-weight:700;cursor:pointer;font-family:'Poppins',sans-serif" onclick="switchAuthTab('signup')">Cr√©er mon compte ‚Üí</button>
    </div>
    <!-- Panneau Inscription (t√©l√©phone uniquement) -->
    <div id="auth-signup-panel" class="auth-panel" style="display:none">
      <div class="auth-inp-row">
        <div class="auth-field">
          <label class="auth-label">Pr√©nom *</label>
          <input type="text" class="auth-inp" id="signup-prenom" placeholder="Ex : Kofi" autocomplete="given-name"/>
        </div>
        <div class="auth-field">
          <label class="auth-label">Nom *</label>
          <input type="text" class="auth-inp" id="signup-nom" placeholder="Ex : Mensah" autocomplete="family-name"/>
        </div>
      </div>
      <div class="auth-field">
        <label class="auth-label">Genre *</label>
        <select class="auth-inp" id="signup-genre">
          <option value="">‚Äî S√©lectionner ‚Äî</option>
          <option value="homme">üë® Homme</option>
          <option value="femme">üë© Femme</option>
        </select>
      </div>
      <div class="auth-field">
        <label class="auth-label">T√©l√©phone * <span style="font-size:10px;color:var(--light);font-weight:400">(identifiant unique)</span></label>
        <input type="tel" class="auth-inp" id="signup-phone" placeholder="+228 XX XX XX XX" autocomplete="tel"
               onkeydown="if(event.key==='Enter')doSignup()"/>
      </div>
      <div class="auth-field">
        <label class="auth-label">Ville de r√©sidence *</label>
        <input type="text" class="auth-inp" id="signup-ville" placeholder="Ex : Lom√©, Kpalim√©, Kara..." autocomplete="address-level2"/>
      </div>
      <button class="auth-btn" id="signup-btn" onclick="doSignup()">S'inscrire ‚Üí</button>
      <div class="auth-err" id="auth-err"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê BANNI√àRE PWA ‚ïê‚ïê -->
<div id="pwa-banner" style="display:none">
  <div class="pwa-inner">
    <div class="pwa-logo">
      <img src="assets/logo.png" alt="" onerror="this.outerHTML='üõ°Ô∏è'"/>
    </div>
    <div class="pwa-text">
      <div class="pwa-title">Installer l'application</div>
      <div class="pwa-sub">Acc√©dez rapidement √† OmniService TG</div>
    </div>
    <button class="pwa-btn" id="pwa-install-btn">Installer</button>
    <button class="pwa-close" onclick="dismissPWA()">‚úï</button>
  </div>
</div>

<!-- ‚ïê‚ïê TOP NAV ‚ïê‚ïê -->
<header class="topnav">
  <div class="topnav-inner">
    <div class="topnav-row1">
      <div class="logo-area">
        <!-- Logo + Nom -->
        <div class="logo-box">
          <img src="assets/logo.png" alt="OmniService TG" onerror="this.parentElement.innerHTML='üõ°Ô∏è'"/>
        </div>
        <div>
          <div class="brand-name">
            <span class="brand-blue">Omni</span><span class="brand-ora">Service</span> <span class="brand-blue">TG</span>
          </div>
          <div class="brand-sub">Appelez, on s'en charge</div>
        </div>
        <nav class="nav-links">
          <button class="nav-link on"  id="nl-home"     onclick="goTab('home')">üè† Accueil</button>
          <button class="nav-link"     id="nl-services" onclick="goTab('services')">üõ†Ô∏è Services</button>
          <button class="nav-link"     id="nl-orders"   onclick="goTab('orders')">üì¶ Commandes</button>
          <button class="nav-link"     id="nl-about"    onclick="goTab('about')">‚ÑπÔ∏è √Ä propos</button>
        </nav>
      </div>
      <div class="nav-right">
        <button class="nav-btn" onclick="goTab('orders')" title="Mes commandes">
          üõí<span class="cart-badge" id="cart-count" style="display:none">0</span>
        </button>
        <!-- Cloche notifications -->
        <button class="nav-btn" id="notif-btn" onclick="openNotifPanel()" title="Notifications" style="position:relative">
          üîî<span id="notif-badge" style="display:none;position:absolute;top:4px;right:4px;background:#C62828;color:#fff;font-size:9px;font-weight:800;min-width:16px;height:16px;border-radius:999px;display:none;align-items:center;justify-content:center;padding:0 3px;line-height:1"></span>
        </button>
        <!-- Bouton profil ‚Äî devient avatar homme/femme apr√®s connexion -->
        <button class="nav-btn" id="nav-btn-profile" onclick="goTab('profile')" title="Mon profil">üë§</button>
      </div>
    </div>
    <div class="search-wrap">
      <span class="search-ico">üîç</span>
      <input type="text" placeholder="Rechercher un service..." id="search-input" oninput="filterServices(this.value)"/>
    </div>
  </div>
</header>

<div class="app-body">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PAGE : ACCUEIL
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="page on" id="p-home">
    <div class="marquee-wrap">
      <div class="mtrack">
        <span class="mtext">‚úî Professionnalisme &nbsp;‚úî Fiabilit√© &nbsp;‚úî Excellence &nbsp;‚úî Respect &nbsp;‚Äî &nbsp;<b>OmniService TG</b> &nbsp;‚Äî Simplifiez votre quotidien ! &nbsp;&nbsp;&nbsp;</span>
        <span class="mtext">‚úî Professionnalisme &nbsp;‚úî Fiabilit√© &nbsp;‚úî Excellence &nbsp;‚úî Respect &nbsp;‚Äî &nbsp;<b>OmniService TG</b> &nbsp;‚Äî Simplifiez votre quotidien ! &nbsp;&nbsp;&nbsp;</span>
      </div>
    </div>
    <!-- ‚ïê‚ïê BANDEAU PUBLICITAIRE (style Gozem / Yas / Flooz) ‚ïê‚ïê -->
    <div class="adband-wrap">
      <div class="adband-track" id="adband-track">

        <!-- Pub 1 ‚Äî Livraison Express -->
        <div class="adcard" data-service="delivery" onclick="openService('delivery')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#1E6FBE 0%,#0d3d6e 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">üöÄ</span>
          </div>
          <div class="adcard-badge">‚ö° Express</div>
          <div class="adcard-body">
            <div class="adcard-promo">LIVRAISON RAPIDE</div>
            <div class="adcard-title">Courses livr√©es
√† domicile</div>
            <div class="adcard-sub">Partout √† Lom√©</div>
            <div class="adcard-cta">Commander ‚Üí</div>
          </div>
        </div>

        <!-- Pub 2 ‚Äî Restauration -->
        <div class="adcard" data-service="restaurant" onclick="openService('restaurant')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#F5820A 0%,#8B3A00 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">üçΩÔ∏è</span>
          </div>
          <div class="adcard-badge adcard-badge--orange">üç¥ Restauration</div>
          <div class="adcard-body">
            <div class="adcard-promo">PLATS & TRAITEUR</div>
            <div class="adcard-title">Restaurants
partenaires</div>
            <div class="adcard-sub">Livraison & √©v√©nements</div>
            <div class="adcard-cta">D√©couvrir ‚Üí</div>
          </div>
        </div>

        <!-- Pub 3 ‚Äî Alimentation -->
        <div class="adcard" data-service="food" onclick="openService('food')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#1a7a35 0%,#0a3d18 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">ü•ò</span>
          </div>
          <div class="adcard-badge adcard-badge--green">üåø Produits frais</div>
          <div class="adcard-body">
            <div class="adcard-promo">MARCH√â LOCAL</div>
            <div class="adcard-title">Tilapia, volailles
& l√©gumes</div>
            <div class="adcard-sub">Qualit√© locale garantie</div>
            <div class="adcard-cta">Commander ‚Üí</div>
          </div>
        </div>

        <!-- Pub 4 ‚Äî Nettoyage -->
        <div class="adcard" data-service="cleaning" onclick="openService('cleaning')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#7B1FA2 0%,#3a0a5e 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">‚ú®</span>
          </div>
          <div class="adcard-badge adcard-badge--purple">üßπ Nettoyage</div>
          <div class="adcard-body">
            <div class="adcard-promo">MAISON PROPRE</div>
            <div class="adcard-title">Nettoyage
professionnel</div>
            <div class="adcard-sub">R√©sidentiel & bureaux</div>
            <div class="adcard-cta">R√©server ‚Üí</div>
          </div>
        </div>

        <!-- Pub 5 ‚Äî Pr√™t-√†-porter -->
        <div class="adcard" data-service="clothes" onclick="openService('clothes')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#C2185B 0%,#5c0a28 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">üëó</span>
          </div>
          <div class="adcard-badge adcard-badge--pink">üëó Mode</div>
          <div class="adcard-body">
            <div class="adcard-promo">TENDANCE TOGO</div>
            <div class="adcard-title">Mode wax
& accessoires</div>
            <div class="adcard-sub">Livr√© chez vous</div>
            <div class="adcard-cta">Voir ‚Üí</div>
          </div>
        </div>

        <!-- Pub 6 ‚Äî Kits & PACKS -->
        <div class="adcard" data-service="kits" onclick="openService('kits')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#2E7D32 0%,#1b5e20 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">üéÅ</span>
          </div>
          <div class="adcard-badge adcard-badge--green">üì¶ Kits</div>
          <div class="adcard-body">
            <div class="adcard-promo">OFFRES GROUP√âES</div>
            <div class="adcard-title">Kits &amp; PACKS
pr√™ts √† commander</div>
            <div class="adcard-sub">Repas, Mode, √âv√©nement...</div>
            <div class="adcard-cta">D√©couvrir ‚Üí</div>
          </div>
        </div>

      </div>
      <!-- Indicateurs dots -->
      <div class="adband-dots" id="adband-dots">
        <span class="adband-dot on"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
      </div>
    </div>
    <div class="sec">
      <div class="sec-head">
        <div><div class="sec-title">Services disponibles</div><div class="sec-sub">Choisissez ce dont vous avez besoin</div></div>
        <button class="see-all" onclick="goTab('services')">Tous ‚Ä∫</button>
      </div>
      <div class="svc-grid" style="grid-template-columns:repeat(2,1fr);gap:14px">
        <button class="svc-btn" onclick="openService('food')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:#FFF3E0">üõí</div><span class="svc-lbl">Alimentation</span></button>
        <button class="svc-btn" onclick="openService('restaurant')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:#E3F2FD">üçΩÔ∏è</div><span class="svc-lbl">Restaurants</span></button>
        <button class="svc-btn" onclick="openService('delivery')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:#FFF3E0">üöó</div><span class="svc-lbl">Livraison</span></button>
        <button class="svc-btn" onclick="openService('maintenance')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:#E3F2FD">üîß</div><span class="svc-lbl">D√©pannage</span></button>
        <button class="svc-btn" onclick="openService('kits')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#E8F5E9">üì¶</div><span class="svc-lbl">Kits/PACKS</span></button>
        <button class="svc-btn" onclick="openService('cleaning')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#E3F2FD">‚ú®</div><span class="svc-lbl">Nettoyage</span></button>
        <button class="svc-btn" onclick="openService('clothes')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#FFF3E0">üëó</div><span class="svc-lbl">Pr√™t-√†-porter</span></button>
        <button class="svc-btn" onclick="openService('togo_expertise')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#EDE7F6">üèÜ</div><span class="svc-lbl">TOGO Expertise</span></button>
        <button class="svc-btn" onclick="openService('immobilier')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#E8F5E9">üè¢</div><span class="svc-lbl">Immobilier</span></button>
        <button class="svc-btn" onclick="openService('security')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#E3F2FD">üõ°Ô∏è</div><span class="svc-lbl">Gardiennage</span></button>
        <button class="svc-btn" onclick="openService('traiteur')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#FFF8E1">üçΩÔ∏è</div><span class="svc-lbl">Traiteur</span></button>
        <button class="svc-btn" onclick="openService('omni_drink')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#E0F7FA">üçæ</div><span class="svc-lbl">Omni Drink</span></button>
        <button class="svc-btn" onclick="openService('marketplace')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:#FCE4EC">üõçÔ∏è</div><span class="svc-lbl">Marketplace</span></button>
      </div>
    </div>
    <div class="sec">
      <div class="sec-title" style="margin-bottom:14px">Pourquoi nous choisir ?</div>
      <div class="why-grid">
        <div class="why-card"><div class="why-ico" style="background:#E3F2FD">üõ°Ô∏è</div><div><div class="why-title">Organisation structur√©e</div><div class="why-desc">Chaque intervention planifi√©e et encadr√©e.</div></div></div>
        <div class="why-card"><div class="why-ico" style="background:#FFF3E0">‚≠ê</div><div><div class="why-title">√âquipe identifiable</div><div class="why-desc">Personnel form√©, professionnel et fiable.</div></div></div>
        <div class="why-card"><div class="why-ico" style="background:#E3F2FD">‚ö°</div><div><div class="why-title">Service moderne</div><div class="why-desc">Communication claire et suivi efficace.</div></div></div>
        <div class="why-card"><div class="why-ico" style="background:#FFF3E0">üïê</div><div><div class="why-title">Engagement qualit√©</div><div class="why-desc">D√©lais et standards toujours respect√©s.</div></div></div>
      </div>
    </div>
    <div class="sec">
      <div class="cta-banner">
        <div class="cta-title">Pr√™t √† travailler avec des professionnels ?</div>
        <div class="cta-sub">Contactez OmniService TG et d√©couvrez une nouvelle mani√®re de g√©rer vos services au quotidien.</div>
        <div class="cta-btns">
          <a href="tel:+22870652222" class="cta-btn">üìû Nous appeler</a>
          <a href="https://wa.me/22870652222" class="cta-btn cta-wa">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
            WhatsApp
          </a>
        </div>
      </div>
    </div>
  </div><!-- /home -->

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PAGE : SERVICES
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="page" id="p-services">
    <!-- VUE 1 : Liste -->
    <div id="view-list">
      <div class="sec" style="padding-top:20px">
        <div class="sec-title">Nos Services</div>
        <div class="sec-sub" style="margin-bottom:16px">Une solution int√©gr√©e pour tous vos besoins</div>
        <div class="svc-list">
          <button class="svc-row" onclick="openService('food')"><div class="svc-row-ico" style="background:#FFF3E0">üõí</div><div style="flex:1"><div class="svc-row-name">Alimentation g√©n√©rale et produits locaux <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">Kits alimentaires, produits frais (Tilapia, Volailles, L√©gumes), N√©r√©, Vin de palme.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('restaurant')"><div class="svc-row-ico" style="background:#E3F2FD">üçΩÔ∏è</div><div style="flex:1"><div class="svc-row-name">Restaurants <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">D√©couvrez nos restaurants partenaires et commandez vos plats pr√©f√©r√©s.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('delivery')"><div class="svc-row-ico" style="background:#FFF3E0">üöó</div><div style="flex:1"><div class="svc-row-name">Livraison et courses <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">Livraison express, courses personnalis√©es, livraison entreprise et de plats.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('maintenance')"><div class="svc-row-ico" style="background:#E3F2FD">üîß</div><div style="flex:1"><div class="svc-row-name">D√©pannage <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">√âlectricit√©, plomberie, climatisation, √©lectrom√©nager, informatique, pose TV/antenne.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('kits')"><div class="svc-row-ico" style="background:#E8F5E9">üì¶</div><div style="flex:1"><div class="svc-row-name">Kits &amp; Packs <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Associations d'articles pr√©par√©s par notre √©quipe : kits repas, packs √©v√©nement, mode, nettoyage et plus.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('cleaning')"><div class="svc-row-ico" style="background:#E3F2FD">‚ú®</div><div style="flex:1"><div class="svc-row-name">Nettoyage professionnel <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Nettoyage r√©sidentiel, bureaux, entretien r√©gulier et industriel.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('clothes')"><div class="svc-row-ico" style="background:#FFF3E0">üëó</div><div style="flex:1"><div class="svc-row-name">Pr√™t-√†-porter <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">V√™tements africains, boubous, robes, ensembles, accessoires de mode.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('togo_expertise')"><div class="svc-row-ico" style="background:#EDE7F6">üèÜ</div><div style="flex:1"><div class="svc-row-name">TOGO Expertise <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Formation commerciale (Mathivick) et financement de projets (Omega Conseils) ‚Äî deux expertises, un seul p√¥le.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('immobilier')"><div class="svc-row-ico" style="background:#E8F5E9">üè¢</div><div style="flex:1"><div class="svc-row-name">Service Immobilier <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Location, vente, gestion locative, assistance diaspora pour l'investissement immobilier.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('security')"><div class="svc-row-ico" style="background:#E3F2FD">üõ°Ô∏è</div><div style="flex:1"><div class="svc-row-name">Gardiennage &amp; S√©curit√© <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Gardiennage r√©sidentiel/boutique/bureau, s√©curit√© √©v√©nementielle.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('traiteur')"><div class="svc-row-ico" style="background:#FFF8E1">üçΩÔ∏è</div><div style="flex:1"><div class="svc-row-name">Service Traiteur <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Anniversaires, f√™tes, √©v√©nements ‚Äî repas pr√©par√©s et servis sur mesure.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('omni_drink')"><div class="svc-row-ico" style="background:#E0F7FA">üçæ</div><div style="flex:1"><div class="svc-row-name">Omni Drink TG <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Boissons fra√Æches, jus naturels, eau min√©rale et softs livr√©s chez vous.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
          <button class="svc-row" onclick="openService('marketplace')"><div class="svc-row-ico" style="background:#FCE4EC">üõçÔ∏è</div><div style="flex:1"><div class="svc-row-name">Marketplace ‚Äî Articles divers <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Trouvez tout ce dont vous avez besoin : articles m√©nagers, √©lectronique, fournitures et plus.</div></div><span style="font-size:20px;color:#E8EAF0">‚Ä∫</span></button>
        </div>
      </div>
    </div>

    <!-- VUE 1b : Liste des Restaurants -->
    <div id="view-restaurants" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('list')">‚Üê</button>
        <div id="rest-svc-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E3F2FD">üçΩÔ∏è</div>
        <div>
          <div id="rest-svc-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Restaurants</div>
          <div style="font-size:11px;color:#9999BB">Choisissez un restaurant</div>
        </div>
      </div>
      <div class="rst-section-title">üè™ Nos restaurants partenaires</div>
      <div id="restaurants-list"></div>
    </div>

    <!-- VUE 1c : Liste des Kits/PACKS -->
    <div id="view-kits" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('list')">‚Üê</button>
        <div id="kits-svc-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">üéÅ</div>
        <div>
          <div id="kits-svc-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Kits &amp; PACKS</div>
          <div style="font-size:11px;color:#9999BB">Des ensembles pr√™ts √† commander</div>
        </div>
      </div>
      <div class="kits-section-title" id="kits-section-title">üì¶ Nos kits disponibles</div>
      <div id="kits-list"></div>
    </div>

    <!-- VUE 1d : D√©tail d'un Kit -->
    <div id="view-kit-detail" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('kits')">‚Üê</button>
        <div id="kit-detail-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">üéÅ</div>
        <div>
          <div id="kit-detail-name" style="font-size:14px;font-weight:700;color:#1A1A2E">Kit</div>
          <div style="font-size:11px;color:#9999BB">D√©tail du kit</div>
        </div>
      </div>
      <!-- Hero du kit -->
      <div class="kit-detail-hero" id="kit-hero">
        <div class="kit-detail-hero-name" id="kit-hero-name">‚Äî</div>
        <div class="kit-detail-hero-desc" id="kit-detail-desc"></div>
        <div class="kit-detail-hero-price-label">Prix total du kit</div>
        <div class="kit-detail-hero-price" id="kit-detail-price">‚Äî</div>
      </div>
      <!-- Articles du kit -->
      <div class="kit-articles-card">
        <div class="kit-articles-title">üìã Articles inclus dans ce kit</div>
        <div id="kit-detail-items"></div>
      </div>
      <!-- Bouton commander -->
      <button class="kit-order-btn" onclick="commanderKit()">üõí Commander ce kit</button>
    </div>

    <!-- VUE 1e : Options d'une cat√©gorie Immobilier -->
    <div id="view-immo-options" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="immo-options-back-btn" onclick="showView('list')">‚Üê</button>
        <div id="immo-options-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">üè¢</div>
        <div>
          <div id="immo-options-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Cat√©gorie</div>
          <div style="font-size:11px;color:#9999BB">Choisissez une prestation</div>
        </div>
      </div>
      <div style="padding:8px 16px 4px;font-size:12px;font-weight:800;color:#9999BB;text-transform:uppercase;letter-spacing:.5px">üè° Nos prestations disponibles</div>
      <div id="immo-options-list"></div>
    </div>

    <!-- VUE 1f : Formulaire d'une prestation Immobilier -->
    <div id="view-immo-form" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="immo-form-back-btn" onclick="immoFormGoBack()">‚Üê</button>
        <div id="immo-form-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">üè¢</div>
        <div>
          <div id="immo-form-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Demande</div>
          <div style="font-size:11px;color:#9999BB">Formulaire de demande</div>
        </div>
      </div>
      <div id="immo-form-soon" style="display:none" class="warn-box">
        <div style="font-weight:700;font-size:13px;margin-bottom:3px">‚è≥ Bient√¥t disponible</div>
        <div style="font-size:12px;opacity:.92">Op√©rationnel le 07 Avril 2026. Vous pouvez d√©j√† pr√©-enregistrer votre demande.</div>
      </div>
      <!-- Hero de la prestation -->
      <div style="margin:0 16px 14px;background:linear-gradient(135deg,#1E6FBE,#155A9C);border-radius:20px;padding:20px 20px;color:#fff;position:relative;overflow:hidden">
        <div style="position:absolute;right:10px;top:50%;transform:translateY(-50%);font-size:60px;opacity:.18" id="immo-form-hero-emoji">üè¢</div>
        <div style="font-size:10px;font-weight:700;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px" id="immo-form-category">Service Immobilier</div>
        <div style="font-size:17px;font-weight:800;font-family:'Nunito',sans-serif;margin-bottom:4px" id="immo-form-prestation-name">Prestation</div>
        <div style="font-size:11px;color:rgba(255,255,255,.75);line-height:1.5" id="immo-form-prestation-desc"></div>
      </div>
      <div class="order-card">
        <div class="order-card-title">üìã Votre demande</div>
        <div id="immo-form-fields">
          <label class="f-label">Description de votre besoin</label>
          <textarea class="f-textarea" rows="4" id="immo-ff-besoin" placeholder="D√©crivez votre besoin en d√©tail : superficie, budget, localisation souhait√©e, d√©lai..."></textarea>
          <label class="f-label" data-immo-loc>Localisation / Quartier souhait√©</label>
          <input type="text" class="f-input" id="immo-ff-localisation" placeholder="Ex : Adidogom√©, B√®, Tokoin, Ago√®..."/>
          <label class="f-label" data-immo-budget>Budget estim√© <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
          <input type="text" class="f-input" id="immo-ff-budget" placeholder="Ex : 500 000 FCFA/mois ou 15 000 000 FCFA"/>

          <label class="f-label">Date souhait√©e <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
          <input type="date" class="f-input" id="immo-ff-date"/>
          <label class="f-label">Remarques suppl√©mentaires <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
          <textarea class="f-textarea" rows="2" id="immo-ff-notes" placeholder="Pr√©cisions additionnelles..."></textarea>
        </div>
        <button class="btn-primary" id="immo-form-submit-btn" onclick="submitImmoForm()">üì® Envoyer ma demande</button>
      </div>
    </div>

    <!-- VUE 2 : Catalogue -->
    <div id="view-catalogue" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="catalogue-back-btn" onclick="showView('list')">‚Üê</button>
        <div id="cat-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0"></div>
        <div>
          <div id="cat-title" style="font-size:14px;font-weight:700;color:#1A1A2E"></div>
          <div style="font-size:11px;color:#9999BB">S√©lectionnez vos articles</div>
        </div>
      </div>
      <div id="catalogue-items" class="catalogue-grid"></div>
      <div class="cart-bar" id="cart-bar" style="display:none" onclick="showView('delivery')">
        <div class="cart-bar-left">
          <span class="cart-bar-count" id="cb-count">0 article</span>
          <span class="cart-bar-text">Voir ma commande</span>
        </div>
        <span class="cart-bar-total" id="cb-total">0 FCFA</span>
      </div>
    </div>

    <!-- VUE 3 : Formulaire standard -->
    <div id="view-form" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('list')">‚Üê</button>
        <div id="form-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0"></div>
        <div>
          <div id="form-title" style="font-size:14px;font-weight:700;color:#1A1A2E"></div>
          <div style="font-size:11px;color:#9999BB">Formulaire de demande</div>
        </div>
      </div>
      <div id="form-soon" style="display:none" class="warn-box">
        <div style="font-weight:700;font-size:13px;margin-bottom:3px">‚è≥ Bient√¥t disponible</div>
        <div style="font-size:12px;opacity:.92" id="form-soon-date"></div>
      </div>
      <div class="order-card">
        <div id="form-fields"></div>
        <button class="btn-primary" id="form-submit-btn" onclick="submitStandardForm()">üì® Envoyer ma demande</button>
      </div>
    </div>

    <!-- VUE 4 : Livraison (sans champ t√©l√©phone) -->
    <div id="view-delivery" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="delivery-back-btn" onclick="showView('catalogue')">‚Üê</button>
        <div style="font-size:22px">üìç</div>
        <div>
          <div style="font-size:14px;font-weight:700;color:#1A1A2E">Informations de livraison</div>
          <div style="font-size:11px;color:#9999BB">√âtape 1 sur 2</div>
        </div>
      </div>
      <div class="step-bar">
        <div class="step active"><div class="step-num">1</div><span>Livraison</span></div>
        <div class="step-line"></div>
        <div class="step"><div class="step-num">2</div><span>Paiement</span></div>
      </div>
      <div class="order-card">
        <div class="order-card-title">üìç Votre position</div>
        <div class="loc-toggle">
          <button class="loc-btn on" id="loc-btn-gps"  onclick="setLocMode('gps')">üì° Par localisation GPS</button>
          <button class="loc-btn"    id="loc-btn-desc" onclick="setLocMode('desc')">‚úçÔ∏è Par description</button>
        </div>
        <div id="loc-gps-panel">
          <button class="btn-secondary" id="gps-btn" onclick="getGPS()">üì° Obtenir ma position</button>
          <div id="gps-result" style="margin-top:10px;font-size:12px;color:#4A4A6A;display:none"></div>
        </div>
        <div id="loc-desc-panel" style="display:none">
          <label class="f-label">Description de votre position</label>
          <textarea class="f-textarea" id="del-desc" rows="3" placeholder="Ex : Quartier Adidogom√©, derri√®re le march√©, maison bleue avec portail noir..."></textarea>
        </div>
      </div>
      <div class="order-card">
        <div class="order-card-title">üè† Adresse de livraison</div>
        <label class="f-label">Rue / quartier / rep√®re</label>
        <input type="text" class="f-input" id="del-address" placeholder="Ex : Adidogom√©, rue des Cocotiers"/>
        <label class="f-label">Notes suppl√©mentaires (optionnel)</label>
        <textarea class="f-textarea" id="del-notes" rows="2" placeholder="√âtage, couleur de la maison..."></textarea>
      </div>
      <button class="btn-primary" onclick="goToPayment()">Continuer ‚Üí Paiement</button>
    </div>

    <!-- VUE 5 : Paiement -->
    <div id="view-payment" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('delivery')">‚Üê</button>
        <div style="font-size:22px">üí≥</div>
        <div>
          <div style="font-size:14px;font-weight:700;color:#1A1A2E">Confirmation &amp; Paiement</div>
          <div style="font-size:11px;color:#9999BB">√âtape 2 sur 2</div>
        </div>
      </div>
      <div class="step-bar">
        <div class="step done"><div class="step-num">‚úì</div><span>Livraison</span></div>
        <div class="step-line done"></div>
        <div class="step active"><div class="step-num">2</div><span>Paiement</span></div>
      </div>
      <div class="order-card">
        <div class="order-card-title">üõí Votre commande</div>
        <div id="recap-items"></div>
        <div class="recap-total">
          <span class="recap-total-label">Total</span>
          <span class="recap-total-val" id="recap-total-val">0 FCFA</span>
        </div>
      </div>
      <div class="order-card" style="padding:0;overflow:hidden">
        <div style="padding:16px 18px 12px;font-size:15px;font-weight:700;color:#1A1A2E">üí≥ Mode de paiement</div>
        <button class="pay-opt" id="pay-mixx" onclick="selectPay('mixx')">
          <div class="pay-ico" style="background:#E8F5E9">üíö</div>
          <div><div class="pay-name">Mixx By Yas</div><div class="pay-sub">Paiement mobile s√©curis√©</div></div>
          <span class="pay-soon">Bient√¥t</span>
          <div class="pay-radio"></div>
        </button>
        <button class="pay-opt" id="pay-flooz" onclick="selectPay('flooz')">
          <div class="pay-ico" style="background:#FFF3E0">üß°</div>
          <div><div class="pay-name">Flooz</div><div class="pay-sub">Paiement mobile Moov</div></div>
          <span class="pay-soon">Bient√¥t</span>
          <div class="pay-radio"></div>
        </button>
        <button class="pay-opt selected" id="pay-livraison" onclick="selectPay('livraison')">
          <div class="pay-ico" style="background:#F3E5F5">üè†</div>
          <div><div class="pay-name">Payer √† la livraison</div><div class="pay-sub">Esp√®ces ou mobile √† la r√©ception</div></div>
          <div class="pay-radio"></div>
        </button>
      </div>
      <button class="btn-primary" id="confirm-btn" onclick="confirmOrder()">‚úÖ Confirmer la commande</button>
    </div>

    <!-- VUE 6 : Succ√®s -->
    <div id="view-success" style="display:none">
      <div class="success">
        <div class="succ-emoji">‚úÖ</div>
        <div class="succ-title">Commande confirm√©e !</div>
        <div class="succ-desc" id="succ-msg">Votre commande a √©t√© re√ßue.<br/>Notre √©quipe vous contactera tr√®s bient√¥t.</div>
        <div id="succ-redirect-msg" style="font-size:11px;color:#9999BB;margin:8px 0 14px;text-align:center">Redirection vers vos commandes dans <strong id="succ-countdown">3</strong>s...</div>
        <!-- Bouton "Voir mes commandes" ‚Äî affich√© apr√®s confirmation -->
        <button id="succ-view-orders-btn" class="btn-primary" style="max-width:300px;margin:0 auto 10px;background:linear-gradient(135deg,#2E7D32,#1B5E20)" onclick="goTab('orders')">üì¶ Voir mes commandes ‚Üí</button>
        <button class="btn-primary" style="max-width:300px;margin:0 auto;background:#F4F6FA;color:#4A4A6A;box-shadow:none;border:1.5px solid #E8EAF0" onclick="showView('list')">‚Üê Retour aux services</button>
      </div>
    </div>
  </div><!-- /services -->

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PAGE : COMMANDES (suivi)
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="page" id="p-orders">
    <div class="orders-page">
      <div class="orders-header">
        <div class="sec-title">Mes Commandes</div>
        <div class="sec-sub">Suivez l'√©tat de vos demandes en temps r√©el</div>
      </div>
      <!-- Info utilisateur connect√© + bouton actualiser -->
      <div class="orders-user-info" id="orders-user-bar" style="display:none">
        <div class="orders-user-avatar" id="orders-user-avatar">üë§</div>
        <div>
          <div class="orders-user-name" id="orders-user-name">‚Äî</div>
          <div class="orders-user-phone" id="orders-user-phone">‚Äî</div>
        </div>
        <button class="orders-refresh-btn" onclick="loadMyOrders()">üîÑ Actualiser</button>
      </div>
      <div id="orders-out">
        <div class="orders-empty">
          <div class="orders-empty-ico">üîê</div>
          <div class="orders-empty-title">Connexion requise</div>
          <div class="orders-empty-sub">Connectez-vous pour voir vos commandes et leur historique.</div>
          <button class="btn-primary" style="max-width:220px;margin:20px auto 0" onclick="openAuthModal('login')">Se connecter</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PAGE : √Ä PROPOS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="page" id="p-about">
    <div style="padding-top:20px">
      <div class="about-hero">
        <div class="about-logo">
          <img src="assets/logo.png" alt="OmniService TG" onerror="this.parentElement.innerHTML='<div style=font-size:50px>üõ°Ô∏è</div>'"/>
        </div>
        <div class="about-name"><span class="brand-blue">Omni</span><span class="brand-ora">Service</span> <span class="brand-blue">TG</span></div>
        <div style="font-size:12px;color:var(--light);margin-top:4px">Appelez, on s'en charge</div>
        <div style="overflow:hidden;width:100%;margin-top:6px">
          <div style="display:inline-block;white-space:nowrap;animation:marquee-about 12s linear infinite;font-size:12px;color:var(--mid);font-weight:700">
            üèõÔ∏è Entreprise promotrice : St√©. ASSISTANCE GLOBALE &nbsp;‚Ä¢&nbsp; 14 ans d'exp√©rience &nbsp;‚Ä¢&nbsp; üèõÔ∏è Entreprise promotrice : St√©. ASSISTANCE GLOBALE &nbsp;‚Ä¢&nbsp; 14 ans d'exp√©rience &nbsp;‚Ä¢&nbsp;
          </div>
        </div>
        <style>@keyframes marquee-about{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}</style>
        <div class="about-flag">üáπüá¨ Entreprise togolaise</div>
      </div>
      <div class="a-card" style="background:linear-gradient(135deg,rgba(30,111,190,.03),rgba(245,130,10,.03));border:1px solid rgba(30,111,190,.1)">
        <div class="a-card-title">üöÄ Notre Vision</div>
        <p>Construire un Togo o√π chaque foyer acc√®de √† des services fiables, modernes et dignes des standards internationaux. OmniService TG vise √† devenir une <strong style="color:var(--blue)">r√©f√©rence nationale</strong> dans le secteur des services professionnels.</p>
      </div>
      <div class="a-card">
        <div class="a-card-title">üéØ Notre Mission</div>
        <p>Offrir aux m√©nages et entreprises togolais des services multisectoriels professionnels, accessibles et structur√©s, qui simplifient leur quotidien et valorisent leur cadre de vie.</p>
      </div>
      <div class="sec-title" style="margin-bottom:12px">Nos Valeurs</div>
      <div class="val-row"><div class="val-ico">üéØ</div><div><div class="val-name">Professionnalisme</div><div class="val-desc">Standards √©lev√©s √† chaque intervention.</div></div></div>
      <div class="val-row"><div class="val-ico">üîí</div><div><div class="val-name">Fiabilit√©</div><div class="val-desc">Vous pouvez compter sur nous.</div></div></div>
      <div class="val-row"><div class="val-ico">ü§ù</div><div><div class="val-name">Respect</div><div class="val-desc">De nos clients, √©quipes et partenaires.</div></div></div>
      <div class="val-row"><div class="val-ico">üîç</div><div><div class="val-name">Transparence</div><div class="val-desc">Tarifs clairs, pas de surprises.</div></div></div>
      <div class="val-row" style="margin-bottom:18px"><div class="val-ico">‚≠ê</div><div><div class="val-name">Excellence</div><div class="val-desc">Toujours le meilleur r√©sultat.</div></div></div>
      <div class="who-grid">
        <div class="who-card"><div style="font-size:30px;margin-bottom:9px">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div><div style="font-size:13px;font-weight:700;color:var(--dark);margin-bottom:5px">Particuliers</div><div style="font-size:11px;color:var(--light);line-height:1.5">Familles et propri√©taires cherchant un service organis√©.</div></div>
        <div class="who-card"><div style="font-size:30px;margin-bottom:9px">üè¢</div><div style="font-size:13px;font-weight:700;color:var(--dark);margin-bottom:5px">Entreprises</div><div style="font-size:11px;color:var(--light);line-height:1.5">Bureaux, commerces, soci√©t√©s en croissance.</div></div>
      </div>
      <div class="a-card">
        <div class="a-card-title">üìû Contact</div>
        <div class="ct-row"><div class="ct-ico">üìç</div><span style="font-size:13px;color:var(--mid)">Bas√© √† Lom√©, Togo</span></div>
        <div class="ct-row"><div class="ct-ico">üìû</div><a href="tel:+22870652222" style="font-size:13px;color:var(--blue);font-weight:600;text-decoration:none">+228 70 65 22 22</a></div>
        <div class="ct-row"><div class="ct-ico">üìß</div><a href="/cdn-cgi/l/email-protection#3c5f5352485d5f487c535152554f594e4a555f59485b125f5351" style="font-size:13px;color:var(--blue);font-weight:600;text-decoration:none"><span class="__cf_email__" data-cfemail="7f1c10110b1e1c0b3f101211160c1a0d09161c1a0b18511c1012">[email&#160;protected]</span></a></div>
        <div class="ct-row"><div class="ct-ico">üåê</div><span style="font-size:13px;color:var(--mid)">www.omniservicetg.com</span></div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PAGE : PROFIL
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="page" id="p-profile">
    <div style="padding-top:20px">
      <div class="prof-hero">
        <!-- Avatar dynamique homme/femme -->
        <div class="avatar" id="prof-avatar">üë§</div>
        <div style="font-family:'Nunito',sans-serif;font-size:22px;font-weight:900;color:#fff" id="prof-name-disp">Mon Profil</div>
        <div style="font-size:12px;color:rgba(255,255,255,.5);margin-top:5px" id="prof-phone-disp">Connectez-vous pour acc√©der √† votre compte</div>
      </div>

      <!-- Carte si NON connect√© -->
      <div id="prof-auth-card">
        <div class="auth-card-title">Bienvenue sur OmniService TG !</div>
        <div class="auth-card-sub">Connectez-vous ou cr√©ez un compte pour passer des commandes, suivre leur statut et g√©rer votre profil.</div>
        <div class="btn-row">
          <button class="btn-login" onclick="openAuthModal('login')">Se connecter</button>
          <button class="btn-signup" onclick="openAuthModal('signup')">S'inscrire</button>
        </div>
      </div>

      <!-- Carte si connect√© -->
      <div id="prof-logged-card" style="display:none">
        <div class="prof-card">
          <div style="font-size:14px;font-weight:700;color:var(--dark);margin-bottom:14px">‚úèÔ∏è Modifier mes informations</div>
          <div class="p-inw"><span class="p-pfx">üë§</span><input type="text" class="p-inp" placeholder="Pr√©nom" id="pf-prenom"/></div>
          <div class="p-inw"><span class="p-pfx">üë§</span><input type="text" class="p-inp" placeholder="Nom" id="pf-nom"/></div>
          <div class="p-inw"><span class="p-pfx">üìû</span><input type="tel" class="p-inp" placeholder="+228 XX XX XX XX" id="pf-phone"/></div>
          <div class="p-inw"><span class="p-pfx">üìç</span><input type="text" class="p-inp" placeholder="Ville de r√©sidence" id="pf-ville"/></div>
          <div class="p-inw" style="margin-bottom:16px"><span class="p-pfx">üìß</span><input type="email" class="p-inp" placeholder="Email" id="pf-email" readonly style="opacity:.6"/></div>
          <button class="p-save" onclick="saveProfile()">üíæ Enregistrer</button>
        </div>
        <div class="menu-list">
          <div class="menu-row" onclick="goTab('orders')"><div class="menu-ico" style="background:#E3F2FD">üì¶</div><span style="flex:1;font-size:13px;font-weight:600;color:var(--dark)">Mes commandes</span><span style="color:var(--border);font-size:18px">‚Ä∫</span></div>
          <div class="menu-row" onclick="openNotifPanel()" style="cursor:pointer"><div class="menu-ico" style="background:#FFF3E0">üîî</div><span style="flex:1;font-size:13px;font-weight:600;color:var(--dark)">Notifications</span><span style="color:var(--border);font-size:18px">‚Ä∫</span></div>
          <div class="menu-row" onclick="openPrivacyModal()"><div class="menu-ico" style="background:#E3F2FD">üîí</div><span style="flex:1;font-size:13px;font-weight:600;color:var(--dark)">Confidentialit√©</span><span style="color:var(--border);font-size:18px">‚Ä∫</span></div>
          <div class="menu-row" onclick="doLogout()"><div class="menu-ico" style="background:#FFEBEE">üö™</div><span style="flex:1;font-size:13px;font-weight:600;color:#C62828">Se d√©connecter</span><span style="color:var(--border);font-size:18px">‚Ä∫</span></div>
        </div>
      </div>

    </div>
  </div>

</div><!-- /app-body -->

<!-- ‚ïê‚ïê MODAL POLITIQUE DE CONFIDENTIALIT√â ‚ïê‚ïê -->
<div id="privacy-modal" onclick="if(event.target===this)closePrivacyModal()">
  <div class="privacy-box">
    <div class="privacy-header">
      <div class="privacy-title">üîí Politique de Confidentialit√©</div>
      <button class="privacy-close" onclick="closePrivacyModal()">‚úï</button>
    </div>
    <div class="privacy-body">

      <!-- Intro -->
      <div style="background:linear-gradient(135deg,#1E6FBE,#155A9C);border-radius:18px;padding:20px;color:#fff;margin-bottom:22px">
        <div style="font-size:28px;margin-bottom:8px">üõ°Ô∏è</div>
        <div style="font-family:'Nunito',sans-serif;font-size:16px;font-weight:800;margin-bottom:6px">Vos donn√©es sont en s√©curit√©</div>
        <div style="font-size:12px;color:rgba(255,255,255,.8);line-height:1.6">Chez OmniService TG, la protection de votre vie priv√©e est une priorit√© absolue. Nous nous engageons √† ne jamais vendre, louer ou compromettre vos informations personnelles.</div>
      </div>

      <!-- Badges de confiance -->
      <div class="privacy-trust-badges" style="margin-bottom:22px">
        <div class="privacy-badge"><div class="privacy-badge-ico">üîê</div><div class="privacy-badge-label">Donn√©es chiffr√©es</div><div class="privacy-badge-sub">Stockage s√©curis√© Firebase</div></div>
        <div class="privacy-badge"><div class="privacy-badge-ico">üö´</div><div class="privacy-badge-label">Jamais revendues</div><div class="privacy-badge-sub">Aucun partage √† des tiers</div></div>
        <div class="privacy-badge"><div class="privacy-badge-ico">üëÅÔ∏è‚Äçüó®Ô∏è</div><div class="privacy-badge-label">Transparence totale</div><div class="privacy-badge-sub">Vous contr√¥lez vos donn√©es</div></div>
        <div class="privacy-badge"><div class="privacy-badge-ico">üáπüá¨</div><div class="privacy-badge-label">Entreprise togolaise</div><div class="privacy-badge-sub">St√©. ASSISTANCE GLOBALE</div></div>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üìã 1. Qui sommes-nous ?</div>
        <p>OmniService TG est un service d√©velopp√© et op√©r√© par la <strong>St√©. ASSISTANCE GLOBALE</strong>, entreprise togolaise forte de 14 ans d'exp√©rience dans les services aux particuliers et aux entreprises. Nous sommes bas√©s √† Lom√©, Togo.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üì¶ 2. Donn√©es collect√©es</div>
        <p>Nous collectons uniquement les informations n√©cessaires √† la fourniture de nos services : <strong>votre pr√©nom et nom</strong> pour personnaliser votre exp√©rience, <strong>votre num√©ro de t√©l√©phone</strong> comme identifiant unique de compte, <strong>votre ville de r√©sidence</strong> pour adapter notre offre, et <strong>vos adresses de livraison</strong> pour ex√©cuter vos commandes. Nous ne collectons jamais de donn√©es de paiement directement ‚Äî les transactions sont g√©r√©es par des op√©rateurs certifi√©s (Flooz, Mixx by Yas).</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üéØ 3. Utilisation de vos donn√©es</div>
        <p>Vos donn√©es sont utilis√©es exclusivement pour : traiter et suivre vos commandes, vous contacter concernant l'ex√©cution de vos services, am√©liorer la qualit√© de nos prestations et, avec votre accord, vous informer de nos nouvelles offres. <strong>Nous n'utilisons jamais vos donn√©es √† des fins publicitaires ou de profilage commercial.</strong></p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üîí 4. S√©curit√© & Stockage</div>
        <p>Toutes vos donn√©es sont stock√©es sur <strong>Firebase (Google Cloud)</strong>, une infrastructure certifi√©e et chiffr√©e de bout en bout. L'acc√®s √† vos donn√©es est strictement limit√© aux membres autoris√©s de l'√©quipe OmniService TG, qui sont soumis √† une obligation de confidentialit√©. Aucun tiers commercial n'a acc√®s √† vos informations personnelles.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">‚öñÔ∏è 5. Vos droits</div>
        <p>Conform√©ment aux principes de protection des donn√©es, vous disposez √† tout moment du droit de <strong>consulter, modifier ou supprimer</strong> vos informations personnelles depuis votre profil dans l'application. Pour toute demande concernant vos donn√©es, contactez-nous directement via WhatsApp ou par e-mail.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üç™ 6. Donn√©es locales (cookies)</div>
        <p>L'application utilise le stockage local de votre navigateur (<em>localStorage</em>) uniquement pour maintenir votre session ouverte entre les visites, √©vitant ainsi que vous ayez √† vous reconnectez √† chaque fois. Aucun cookie tiers ni outil de tracking publicitaire n'est utilis√©.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üîî 7. Notifications</div>
        <p>Si vous acceptez les notifications dans votre navigateur, OmniService TG vous envoie uniquement des alertes utiles concernant l'√©tat de vos commandes (passage en cours, commande termin√©e). Ces notifications sont g√©r√©es localement et ne n√©cessitent aucun service tiers de tracking.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">üìû 8. Contact & R√©clamations</div>
        <p>Pour toute question relative √† la confidentialit√© de vos donn√©es, notre √©quipe est disponible 7j/7 :</p>
        <div style="margin-top:12px;display:flex;flex-direction:column;gap:8px">
          <a href="tel:+22870652222" style="display:flex;align-items:center;gap:10px;background:#E3F2FD;border-radius:12px;padding:12px;text-decoration:none">
            <span style="font-size:20px">üìû</span>
            <div><div style="font-size:13px;font-weight:700;color:#1E6FBE">+228 70 65 22 22</div><div style="font-size:11px;color:#9999BB">Appel / WhatsApp</div></div>
          </a>
          <a href="/cdn-cgi/l/email-protection#8fece0e1fbeeecfbcfe0e2e1e6fceafdf9e6eceafbe8a1ece0e2" style="display:flex;align-items:center;gap:10px;background:#FFF3E0;border-radius:12px;padding:12px;text-decoration:none">
            <span style="font-size:20px">üìß</span>
            <div><div style="font-size:13px;font-weight:700;color:#F5820A"><span class="__cf_email__" data-cfemail="a4c7cbcad0c5c7d0e4cbc9cacdd7c1d6d2cdc7c1d0c38ac7cbc9">[email&#160;protected]</span></div><div style="font-size:11px;color:#9999BB">E-mail</div></div>
          </a>
        </div>
      </div>

      <div style="margin-top:22px;padding:16px;background:#F4F6FA;border-radius:14px;text-align:center">
        <div style="font-size:20px;margin-bottom:6px">üèõÔ∏è</div>
        <div style="font-size:12px;color:#9999BB;line-height:1.6"><strong style="color:#1A1A2E">St√©. ASSISTANCE GLOBALE</strong><br/>14 ans d'exp√©rience ¬∑ Lom√©, Togo üáπüá¨<br/>Politique en vigueur depuis le 07 Avril 2026</div>
      </div>

    </div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL CONFIRMATION D'ANNULATION ‚ïê‚ïê -->
<div id="cancel-order-modal" style="display:none;position:fixed;inset:0;z-index:3500;background:rgba(10,18,32,.75);backdrop-filter:blur(6px);align-items:center;justify-content:center;padding:20px" onclick="if(event.target===this)closeCancelModal()">
  <div style="background:#fff;border-radius:24px;width:100%;max-width:360px;padding:28px 24px;box-shadow:0 30px 80px rgba(0,0,0,.3);text-align:center">
    <div style="width:64px;height:64px;background:#FFEBEE;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 16px">üóëÔ∏è</div>
    <div style="font-family:'Nunito',sans-serif;font-size:18px;font-weight:800;color:#1A1A2E;margin-bottom:8px">Annuler la commande ?</div>
    <div style="font-size:13px;color:#4A4A6A;line-height:1.6;margin-bottom:6px">
      Vous √™tes sur le point d'annuler et de supprimer :<br/>
      <strong id="cancel-order-name" style="color:#1A1A2E"></strong>
    </div>
    <div style="font-size:11px;color:#9999BB;margin-bottom:22px">R√©f : <strong id="cancel-order-ref"></strong></div>
    <div style="background:#FFF3E0;border-radius:12px;padding:12px;font-size:12px;color:#B45309;margin-bottom:22px;text-align:left">
      ‚ö†Ô∏è Cette action est <strong>irr√©versible</strong>. La suppression n'est possible que si la commande est encore <strong>En attente</strong>.
    </div>
    <div style="display:flex;gap:10px">
      <button onclick="closeCancelModal()" style="flex:1;background:#F4F6FA;border:1.5px solid #E8EAF0;border-radius:14px;padding:14px;font-size:13px;font-weight:700;color:#4A4A6A;cursor:pointer;font-family:'Poppins',sans-serif">Garder</button>
      <button onclick="confirmCancelOrder()" style="flex:1;background:linear-gradient(135deg,#C62828,#B71C1C);border:none;border-radius:14px;padding:14px;font-size:13px;font-weight:700;color:#fff;cursor:pointer;font-family:'Poppins',sans-serif;box-shadow:0 4px 16px rgba(198,40,40,.35)">üóëÔ∏è Supprimer</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê PANNEAU NOTIFICATIONS ‚ïê‚ïê -->
<div id="notif-panel" style="display:none;position:fixed;inset:0;z-index:3000;background:rgba(10,18,32,.65);backdrop-filter:blur(4px)" onclick="if(event.target===this)closeNotifPanel()">
  <div style="position:absolute;top:0;right:0;width:min(100vw,380px);height:100%;background:#fff;box-shadow:-8px 0 40px rgba(0,0,0,.18);display:flex;flex-direction:column;animation:slideInRight .25s cubic-bezier(.4,0,.2,1)">
    <div style="background:linear-gradient(135deg,#1E6FBE,#155A9C);padding:20px 20px 18px;display:flex;align-items:center;gap:12px;flex-shrink:0">
      <div style="font-size:24px">üîî</div>
      <div style="flex:1">
        <div style="font-family:'Nunito',sans-serif;font-size:18px;font-weight:800;color:#fff">Notifications</div>
        <div style="font-size:11px;color:rgba(255,255,255,.65);margin-top:2px">Suivi de vos commandes en temps r√©el</div>
      </div>
      <button onclick="closeNotifPanel()" style="background:rgba(255,255,255,.15);border:none;color:#fff;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center">‚úï</button>
    </div>
    <div id="notif-list" style="flex:1;overflow-y:auto;padding:16px">
      <div id="notif-empty" style="text-align:center;padding:60px 20px;color:#9999BB">
        <div style="font-size:48px;margin-bottom:14px">üîî</div>
        <div style="font-size:15px;font-weight:700;color:#1A1A2E;margin-bottom:6px">Aucune notification</div>
        <div style="font-size:12px;line-height:1.6">Vous recevrez des alertes ici d√®s que le statut de vos commandes changera.</div>
      </div>
    </div>
    <div style="padding:14px 16px;border-top:1px solid #F0F0F8;flex-shrink:0">
      <button onclick="clearAllNotifs()" style="width:100%;background:#F4F6FA;border:1.5px solid #E8EAF0;border-radius:12px;padding:12px;font-size:12px;font-weight:700;color:#4A4A6A;cursor:pointer;font-family:'Poppins',sans-serif">üóëÔ∏è Effacer toutes les notifications</button>
    </div>
  </div>
</div>
<style>
@keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }
/* Notification item */
.notif-item {
  background: #fff;
  border: 1.5px solid #F0F0F8;
  border-radius: 14px;
  padding: 14px 15px;
  margin-bottom: 10px;
  display: flex;
  align-items: flex-start;
  gap: 12px;
  position: relative;
  cursor: pointer;
  transition: all .15s;
}
.notif-item:hover { box-shadow: 0 4px 16px rgba(30,111,190,.1); border-color: #1E6FBE; }
.notif-item.unread { border-color: #1E6FBE; background: #F0F7FF; }
.notif-item.unread::before { content:''; position:absolute; top:12px; right:12px; width:8px; height:8px; background:#1E6FBE; border-radius:50%; }
.notif-ico { width:40px; height:40px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0; }
.notif-title { font-size:13px; font-weight:700; color:#1A1A2E; margin-bottom:3px; }
.notif-sub { font-size:11px; color:#4A4A6A; line-height:1.5; }
.notif-time { font-size:10px; color:#9999BB; margin-top:4px; }
/* Cloche badge */
#notif-badge {
  position:absolute;top:4px;right:4px;
  background:#C62828;color:#fff;
  font-size:9px;font-weight:800;
  min-width:16px;height:16px;
  border-radius:999px;
  align-items:center;justify-content:center;
  padding:0 3px;line-height:1;
}
/* Bouton suppression commande */
.o-delete-btn {
  width: 100%;
  background: transparent;
  border: 1.5px solid #FFCDD2;
  border-radius: 12px;
  padding: 11px 14px;
  font-size: 12px;
  font-weight: 700;
  color: #C62828;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: all .2s;
}
.o-delete-btn:hover {
  background: #FFEBEE;
  border-color: #C62828;
  box-shadow: 0 2px 12px rgba(198,40,40,.15);
}
/* Privacy modal */
#privacy-modal{
  display:none;position:fixed;inset:0;z-index:2500;
  background:rgba(10,18,32,.75);backdrop-filter:blur(6px);
  align-items:center;justify-content:center;padding:16px;overflow-y:auto;
}
.privacy-box{
  background:#fff;border-radius:24px;width:100%;max-width:520px;
  box-shadow:0 30px 80px rgba(0,0,0,.3);max-height:90vh;
  display:flex;flex-direction:column;
}
.privacy-header{
  background:linear-gradient(135deg,#1E6FBE,#155A9C);
  padding:20px 22px;display:flex;align-items:center;justify-content:space-between;
  border-radius:24px 24px 0 0;flex-shrink:0;
}
.privacy-title{font-family:'Nunito',sans-serif;font-size:17px;font-weight:800;color:#fff}
.privacy-close{background:rgba(255,255,255,.15);border:none;color:#fff;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center}
.privacy-body{padding:20px 22px;overflow-y:auto;flex:1}
.privacy-section{margin-bottom:18px}
.privacy-section-title{font-size:13px;font-weight:800;color:#1A1A2E;margin-bottom:8px}
.privacy-section p{font-size:12px;color:#4A4A6A;line-height:1.7;margin:0}
.privacy-trust-badges{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.privacy-badge{background:#F4F6FA;border-radius:14px;padding:12px;text-align:center}
.privacy-badge-ico{font-size:22px;margin-bottom:4px}
.privacy-badge-label{font-size:11px;font-weight:700;color:#1A1A2E}
.privacy-badge-sub{font-size:10px;color:#9999BB;margin-top:2px}
</style>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Bottom Nav -->
<nav class="botnav">
  <button class="btab on" id="t-home"     onclick="goTab('home')">    <div class="btab-ico">üè†</div><span class="btab-lbl">Accueil</span></button>
  <button class="btab"    id="t-services" onclick="goTab('services')"><div class="btab-ico">üõ†Ô∏è</div><span class="btab-lbl">Services</span></button>
  <button class="btab"    id="t-orders"   onclick="goTab('orders')">  <div class="btab-ico">üì¶</div><span class="btab-lbl">Commandes</span></button>
  <button class="btab"    id="t-about"    onclick="goTab('about')">   <div class="btab-ico">‚ÑπÔ∏è</div><span class="btab-lbl">√Ä propos</span></button>
</nav>

<!-- Script principal -->
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="module" src="app.js"></script>
<script>
/* ‚ïê‚ïê PATCH : Nouveaux services + Immobilier restructur√© ‚ïê‚ïê */

// Donn√©es Immobilier ‚Äî 4 sous-services
const IMMO_ENVELOPE = {
  id: 'immobilier',
  name: 'Service Immobilier',
  emoji: 'üè¢',
  color: '#E8F5E9',
  subServices: [
    {
      id: 'immo_vendre',
      name: '√Ä Vendre',
      emoji: 'üè°',
      color: '#E8F5E9',
      type: 'catalogue', // comme Alimentation : grille d'articles
      desc: 'Biens immobiliers disponibles √† la vente',
      items: [
        { name: 'Villa 4 ch + S √† Ago√®', price: 200000000, unit: 'FCFA', emoji: 'üè°', desc: '4 chambres, salon, cuisine √©quip√©e, cl√¥tur√©e' },
        { name: 'Terrain 600m¬≤ (1 lot) √† B√®', price: 100000000, unit: 'FCFA', emoji: 'üåç', desc: 'Titre foncier disponible, bien localis√©' },
      ]
    },
    {
      id: 'immo_louer',
      name: '√Ä Louer',
      emoji: 'üîë',
      color: '#E3F2FD',
      type: 'catalogue', // comme Alimentation : grille d'articles
      desc: 'Biens immobiliers disponibles √† la location',
      items: [
        { name: 'Appartement 2 Ch + S √† Sagbado', price: 65000, unit: 'FCFA/mois', emoji: 'üè†', desc: '2 chambres, salon, sanitaires' },
        { name: 'Villa 4 Ch + S √† Ago√®', price: 200000, unit: 'FCFA/mois', emoji: 'üè°', desc: '4 chambres, salon, cuisine, garage' },
        { name: 'Bureau', price: 0, unit: 'Sur devis', emoji: 'üè¢', desc: 'Espaces bureaux professionnels disponibles' },
        { name: 'Espace commercial', price: 0, unit: 'Sur devis', emoji: 'üè™', desc: 'Boutiques et locaux commerciaux' },
        { name: 'Entrep√¥t', price: 0, unit: 'Sur devis', emoji: 'üè≠', desc: 'Entrep√¥ts de diverses capacit√©s' },
      ]
    },
    {
      id: 'immo_assistance',
      name: 'Assistance Immobili√®re',
      emoji: 'ü§ù',
      color: '#EDE7F6',
      type: 'kits',
      desc: 'Services d\'assistance et d\'accompagnement immobilier',
      options: [
        { name: 'Recherche de terrain s√©curis√©',                      emoji: 'üó∫Ô∏è', desc: 'Identification et v√©rification de terrains selon vos crit√®res' },
        { name: 'Recherche de Villa / Appartement / Bureau / Magasin', emoji: 'üîç', desc: 'Recherche personnalis√©e du bien adapt√© √† vos besoins' },
        { name: 'Suivi et Supervision de construction / chantier',     emoji: 'üèóÔ∏è', desc: 'Suivi et supervision de vos travaux de construction' },
        { name: 'V√©rification de titres fonciers',                     emoji: 'üìú', desc: 'Contr√¥le et validation des documents de propri√©t√©' },
        { name: 'Accompagnement juridique',                            emoji: '‚öñÔ∏è', desc: 'Aide aux d√©marches l√©gales et contrats immobiliers' },
        { name: 'Encaissement des loyers / Suivi des locataires',      emoji: 'üíµ', desc: 'Gestion locative, suivi des paiements et des locataires' },
      ]
    },
    {
      id: 'immo_gestion',
      name: 'Gestion Locative',
      emoji: 'üèõÔ∏è',
      color: '#FFF3E0',
      type: 'form',
      desc: 'Gestion locative compl√®te de votre bien immobilier',
      options: [
        { id: 'appartement', label: 'Appartement',        emoji: 'üè†' },
        { id: 'villa',       label: 'Villa',              emoji: 'üè°' },
        { id: 'bureau',      label: 'Bureau / Local',     emoji: 'üè¢' },
        { id: 'magasin',     label: 'Commerce / Magasin', emoji: 'üè™' },
        { id: 'terrain',     label: 'Terrain',            emoji: 'üåç' },
        { id: 'entrepot',    label: 'Entrep√¥t',           emoji: 'üè≠' },
      ]
    },
  ]
};

// Donn√©es Traiteur
const TRAITEUR_DATA = {
  id: 'traiteur',
  name: 'Service Traiteur',
  emoji: 'üçΩÔ∏è',
  color: '#FFF8E1',
  type: 'form',
  desc: 'Repas pr√©par√©s pour vos √©v√©nements',
  options: [
    { id: 'anniversaire', label: 'Anniversaire', emoji: 'üéÇ' },
    { id: 'fete_famille', label: 'F√™te de famille', emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶' },
    { id: 'mariage', label: 'Mariage / C√©r√©monie', emoji: 'üíç' },
    { id: 'bapteme', label: 'Bapt√™me / Communion', emoji: 'üïäÔ∏è' },
    { id: 'evenement_entreprise', label: '√âv√©nement d\'entreprise', emoji: 'üè¢' },
    { id: 'fete_nationale', label: 'F√™te nationale / Culturelle', emoji: 'üéâ' },
    { id: 'autre', label: 'Autre √©v√©nement', emoji: 'üéä' },
  ]
};

// Donn√©es Omni Drink TG
const OMNI_DRINK_DATA = {
  id: 'omni_drink',
  name: 'Omni Drink TG',
  emoji: 'üçæ',
  color: '#E0F7FA',
  type: 'catalogue',
  desc: 'Boissons fra√Æches livr√©es chez vous',
  items: [
    { name: 'Eau min√©rale (casier 24√ó50cl)', price: 3500, unit: 'FCFA', emoji: 'üíß', desc: 'Eau min√©rale pure, casier de 24 bouteilles' },
    { name: 'Jus de fruits naturels (1L)', price: 1500, unit: 'FCFA', emoji: 'üçä', desc: 'Jus frais sans conservateurs : orange, ananas, bissap...' },
    { name: 'Sodas assortis (casier 24)', price: 9000, unit: 'FCFA', emoji: 'ü•§', desc: 'Coca-Cola, Fanta, Sprite et autres' },
    { name: 'Bi√®res locales (casier 24)', price: 14000, unit: 'FCFA', emoji: 'üç∫', desc: 'Awooyo, Castel, Flag et autres bi√®res du Togo' },
    { name: 'Vin de palme (5L)', price: 4000, unit: 'FCFA', emoji: 'üå¥', desc: 'Vin de palme artisanal frais, production locale' },
    { name: 'Pack √©v√©nement boissons', price: 45000, unit: 'FCFA', emoji: 'üéâ', desc: 'Assortiment complet pour 50 personnes' },
  ]
};

// Donn√©es Marketplace
const MARKETPLACE_DATA = {
  id: 'marketplace',
  name: 'Marketplace ‚Äî Articles divers',
  emoji: 'üõçÔ∏è',
  color: '#FCE4EC',
  type: 'catalogue',
  desc: 'Tous vos articles livr√©s √† domicile',
  items: [
    { name: 'Articles m√©nagers', price: 0, unit: 'Sur devis', emoji: 'üè†', desc: 'Ustensiles, vaisselle, electrom√©nager petit format' },
    { name: 'Fournitures de bureau', price: 0, unit: 'Sur devis', emoji: '‚úèÔ∏è', desc: 'Papeterie, classeurs, stylos, cartouches...' },
    { name: 'Produits d\'hygi√®ne & beaut√©', price: 0, unit: 'Sur devis', emoji: 'üß¥', desc: 'Savons, shampooings, produits de soin' },
    { name: '√âlectronique & Accessoires', price: 0, unit: 'Sur devis', emoji: 'üì±', desc: 'C√¢bles, batteries, accessoires informatiques' },
    { name: 'Jouets & Articles enfants', price: 0, unit: 'Sur devis', emoji: 'üß∏', desc: 'Jouets, fournitures scolaires, articles b√©b√©' },
    { name: 'Article personnalis√©', price: 0, unit: 'Sur devis', emoji: 'üõí', desc: 'Dites-nous ce que vous cherchez, on le trouve!' },
  ]
};

// ‚ïê‚ïê VUE IMMO ENVELOPE ‚ïê‚ïê 
// Nouvelle vue : enveloppe Immobilier avec 4 options (style service principal)
function renderImmoEnvelope() {
  const container = document.getElementById('immo-options-list');
  if (!container) return;
  
  // Mettre √† jour le header
  const titleEl = document.getElementById('immo-options-title');
  const icoEl = document.getElementById('immo-options-ico');
  if (titleEl) titleEl.textContent = 'Service Immobilier';
  if (icoEl) icoEl.textContent = 'üè¢';

  container.innerHTML = IMMO_ENVELOPE.subServices.map(sub => `
    <button class="svc-row" style="margin:0 16px 12px;display:flex;align-items:center;gap:14px;background:#fff;border-radius:18px;padding:14px 16px;box-shadow:0 2px 12px rgba(0,0,0,.08);cursor:pointer;border:none;width:calc(100% - 32px);transition:transform .15s;" 
      onclick="openImmoSubService('${sub.id}')">
      <div style="width:44px;height:44px;border-radius:12px;background:${sub.color};display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">${sub.emoji}</div>
      <div style="flex:1;text-align:left">
        <div style="font-size:14px;font-weight:700;color:#1A1A2E;margin-bottom:3px">${sub.name}</div>
        <div style="font-size:11px;color:#9999BB">${sub.desc}</div>
      </div>
      <span style="font-size:20px;color:#E8EAF0">‚Ä∫</span>
    </button>
  `).join('');
}

// Ouvrir un sous-service immobilier
function openImmoSubService(subId) {
  const sub = IMMO_ENVELOPE.subServices.find(s => s.id === subId);
  if (!sub) return;
  
  if (sub.type === 'catalogue') {
    // Afficher comme catalogue (alimentation/pr√™t-√†-porter)
    renderImmoSubCatalogue(sub);
  } else if (sub.type === 'kits') {
    // Afficher comme liste Mathivik
    renderImmoAssistance(sub);
  } else if (sub.type === 'form') {
    // Afficher comme gardiennage : liste de types puis formulaire
    renderImmoGestion(sub);
  }
}

// ‚ïê‚ïê Catalogue Immobilier (√Ä Vendre / √Ä Louer) ‚Äî m√™me design qu'Alimentation ‚ïê‚ïê
let _immoCartItems = [];
let _immoCurrentSub = null;

function renderImmoSubCatalogue(sub) {
  _immoCurrentSub = sub;

  // Utiliser view-catalogue existant comme Alimentation
  const catTitle = document.getElementById('cat-title');
  const catIco = document.getElementById('cat-ico');
  const catItems = document.getElementById('catalogue-items');
  const backBtn = document.getElementById('catalogue-back-btn');
  const cartBar = document.getElementById('cart-bar');

  if (catTitle) catTitle.textContent = sub.name;
  if (catIco) { catIco.textContent = sub.emoji; catIco.style.background = sub.color; }
  if (backBtn) backBtn.onclick = () => showView('immo-options');

  // Convertir les items en format article compatible avec renderArticleCard
  // Pour immo : le "+" ouvre le formulaire immo au lieu de la livraison
  if (catItems) {
    catItems.innerHTML = sub.items.map((item, i) => {
      const id = `immo_${sub.id}_${i}`;
      const priceStr = item.price > 0
        ? Number(item.price).toLocaleString('fr-FR') + ' FCFA'
        : item.unit;
      const unitStr = item.price > 0 ? '' : '';
      return `
      <div class="article-card" id="acard-${id}">
        <div class="art-img-wrap" style="background:${sub.color};display:flex;align-items:center;justify-content:center;font-size:44px">
          ${item.emoji}
        </div>
        <div class="art-check">‚úì</div>
        <div class="art-body">
          <div class="art-name">${item.name}</div>
          <div class="art-desc">${item.desc}</div>
          <div class="art-footer">
            <div>
              <span class="art-price">${priceStr}</span>
              ${item.price > 0 ? `<span class="art-price-unit">/ ${item.unit}</span>` : ''}
            </div>
            <button class="art-add" onclick="addImmoItem(${i})" title="Faire une demande">‚Üí</button>
          </div>
        </div>
      </div>`;
    }).join('');
  }

  // Cacher la cart-bar (immo va vers formulaire, pas livraison)
  if (cartBar) cartBar.style.display = 'none';
  showView('catalogue');
}

function addImmoItem(idx) {
  const item = _immoCurrentSub.items[idx];
  const subId = _immoCurrentSub.id;
  
  // Pour √Ä vendre (immo_vendre) et √Ä Louer (immo_louer) : masquer localisation et budget
  const isVenteOuLocation = subId === 'immo_vendre' || subId === 'immo_louer';
  
  const nameEl = document.getElementById('immo-form-prestation-name');
  const descEl = document.getElementById('immo-form-prestation-desc');
  const catEl = document.getElementById('immo-form-category');
  const heroEmoji = document.getElementById('immo-form-hero-emoji');
  const formTitle = document.getElementById('immo-form-title');
  const backBtn2 = document.getElementById('immo-form-back-btn');
  const besoin = document.getElementById('immo-ff-besoin');
  
  // Masquer/afficher les champs selon le sous-service
  const locRow = document.getElementById('immo-ff-localisation')?.closest('.f-row') || 
                  (() => {
                    const el = document.getElementById('immo-ff-localisation');
                    return el ? el.parentNode.querySelector('label[for="immo-ff-localisation"], label + #immo-ff-localisation') : null;
                  })();
  
  setImmoFormFieldsVisibility(isVenteOuLocation ? 'vente-location' : 'default');
  
  if (nameEl) nameEl.textContent = item.name;
  if (descEl) descEl.textContent = item.desc;
  if (catEl) catEl.textContent = _immoCurrentSub.name;
  if (heroEmoji) heroEmoji.textContent = item.emoji;
  if (formTitle) formTitle.textContent = item.name;
  _immoFormBackFn = () => showView('catalogue');
  if (besoin) besoin.placeholder = `Je suis int√©ress√©(e) par : ${item.name}. Pr√©cisez vos souhaits...`;
  
  const soonBox = document.getElementById('immo-form-soon');
  if (soonBox) soonBox.style.display = 'block';
  
  showView('immo-form');
}

// ‚ïê‚ïê Assistance Immobili√®re (style Mathivik ‚Äî liste puis commander) ‚ïê‚ïê
// ‚ïê‚ïê immoFormGoBack : gestion du bouton retour du formulaire immo ‚ïê‚ïê
let _immoFormBackFn = null;
function immoFormGoBack() {
  if (typeof _immoFormBackFn === 'function') {
    _immoFormBackFn();
  } else {
    showView('immo-options');
  }
}
window.immoFormGoBack = immoFormGoBack;

// ‚ïê‚ïê Helper : injection d'un <select> en t√™te de formulaire ‚ïê‚ïê
function injectSelectInImmoForm(labelText, options, fieldId) {
  const fields = document.getElementById('immo-form-fields');
  if (!fields) return;
  // Supprimer l'ancien select s'il existe
  const old = document.getElementById(fieldId);
  if (old) {
    const oldWrap = old.closest('.f-select-wrap');
    if (oldWrap) oldWrap.remove();
    else old.remove();
  }
  const oldLbl = fields.querySelector('[data-select-label]');
  if (oldLbl) oldLbl.remove();

  const wrap = document.createElement('div');
  wrap.className = 'f-select-wrap';
  wrap.style.cssText = 'margin-bottom:14px';
  wrap.innerHTML = \`
    <label class="f-label" data-select-label style="margin-bottom:6px">\${labelText}</label>
    <select class="f-input" id="\${fieldId}" style="background:#F7F8FC;font-size:14px;font-weight:600;color:#1A1A2E;cursor:pointer">
      <option value="">‚Äî S√©lectionnez ‚Äî</option>
      \${options.map(o => \`<option value="\${o.value}">\${o.emoji} \${o.label}</option>\`).join('')}
    </select>
  \`;
  fields.insertBefore(wrap, fields.firstChild);
}

// ‚ïê‚ïê Gardiennage : formulaire direct avec select ‚ïê‚ïê
function openSecurityDirectForm() {
  const titleEl  = document.getElementById('immo-form-title');
  const catEl    = document.getElementById('immo-form-category');
  const heroEl   = document.getElementById('immo-form-hero-emoji');
  const nameEl   = document.getElementById('immo-form-prestation-name');
  const descEl   = document.getElementById('immo-form-prestation-desc');
  const besoin   = document.getElementById('immo-ff-besoin');
  const soonBox  = document.getElementById('immo-form-soon');
  const icoEl    = document.getElementById('immo-form-ico');

  if (titleEl)  titleEl.textContent  = 'Gardiennage & S√©curit√©';
  if (catEl)    catEl.textContent    = 'S√©curit√©';
  if (heroEl)   heroEl.textContent   = 'üõ°Ô∏è';
  if (nameEl)   nameEl.textContent   = 'Gardiennage & S√©curit√©';
  if (descEl)   descEl.textContent   = 'Protection r√©sidentielle, commerciale, √©v√©nementielle et temporaire';
  if (icoEl)    { icoEl.textContent  = 'üõ°Ô∏è'; icoEl.style.background = '#E3F2FD'; }
  if (besoin)   besoin.placeholder   = 'D√©crivez vos besoins de s√©curit√© : adresse, horaires, nombre de gardes...';
  if (soonBox)  soonBox.style.display = 'block';

  setImmoFormFieldsVisibility('default');
  injectSelectInImmoForm('Type de gardiennage *', [
    { value: 'residentiel',   emoji: 'üè†', label: 'R√©sidentiel' },
    { value: 'boutique',      emoji: 'üè™', label: 'Boutique / Magasin' },
    { value: 'bureau',        emoji: 'üè¢', label: 'Bureau / Local' },
    { value: 'evenementiel',  emoji: 'üé™', label: '√âv√©nementiel' },
    { value: 'temporaire',    emoji: 'üîí', label: 'Temporaire' },
  ], 'security-type-select');

  _immoFormBackFn = () => showView('list');

  const submitBtn = document.getElementById('immo-form-submit-btn');
  if (submitBtn) submitBtn.onclick = () => submitDirectForm('security');

  showView('immo-form');
}
window.openSecurityDirectForm = openSecurityDirectForm;

// ‚ïê‚ïê Gestion Locative : formulaire direct avec select ‚ïê‚ïê
function openGestionLocativeDirectForm() {
  const titleEl  = document.getElementById('immo-form-title');
  const catEl    = document.getElementById('immo-form-category');
  const heroEl   = document.getElementById('immo-form-hero-emoji');
  const nameEl   = document.getElementById('immo-form-prestation-name');
  const descEl   = document.getElementById('immo-form-prestation-desc');
  const besoin   = document.getElementById('immo-ff-besoin');
  const soonBox  = document.getElementById('immo-form-soon');
  const icoEl    = document.getElementById('immo-form-ico');

  if (titleEl)  titleEl.textContent  = 'Gestion Locative';
  if (catEl)    catEl.textContent    = 'Immobilier';
  if (heroEl)   heroEl.textContent   = 'üèõÔ∏è';
  if (nameEl)   nameEl.textContent   = 'Gestion Locative';
  if (descEl)   descEl.textContent   = 'Gestion locative compl√®te de votre bien immobilier';
  if (icoEl)    { icoEl.textContent  = 'üèõÔ∏è'; icoEl.style.background = '#FFF3E0'; }
  if (besoin)   besoin.placeholder   = 'D√©crivez votre bien : adresse, superficie, loyer actuel, vos attentes...';
  if (soonBox)  soonBox.style.display = 'block';

  setImmoFormFieldsVisibility('gestion');
  injectSelectInImmoForm('Type de bien *', [
    { value: 'appartement', emoji: 'üè†', label: 'Appartement' },
    { value: 'villa',       emoji: 'üè°', label: 'Villa' },
    { value: 'bureau',      emoji: 'üè¢', label: 'Bureau / Local' },
    { value: 'magasin',     emoji: 'üè™', label: 'Commerce / Magasin' },
    { value: 'terrain',     emoji: 'üåç', label: 'Terrain' },
    { value: 'entrepot',    emoji: 'üè≠', label: 'Entrep√¥t' },
  ], 'gestion-type-select');

  _immoFormBackFn = () => { renderImmoEnvelope(); showView('immo-options'); };

  const submitBtn = document.getElementById('immo-form-submit-btn');
  if (submitBtn) submitBtn.onclick = () => submitDirectForm('gestion_locative');

  showView('immo-form');
}
window.openGestionLocativeDirectForm = openGestionLocativeDirectForm;

// ‚ïê‚ïê Assistance Immobili√®re : formulaire direct avec select ‚ïê‚ïê
function openAssistanceDirectForm() {
  const titleEl  = document.getElementById('immo-form-title');
  const catEl    = document.getElementById('immo-form-category');
  const heroEl   = document.getElementById('immo-form-hero-emoji');
  const nameEl   = document.getElementById('immo-form-prestation-name');
  const descEl   = document.getElementById('immo-form-prestation-desc');
  const besoin   = document.getElementById('immo-ff-besoin');
  const soonBox  = document.getElementById('immo-form-soon');
  const icoEl    = document.getElementById('immo-form-ico');

  if (titleEl)  titleEl.textContent  = 'Assistance Immobili√®re';
  if (catEl)    catEl.textContent    = 'Immobilier';
  if (heroEl)   heroEl.textContent   = 'ü§ù';
  if (nameEl)   nameEl.textContent   = 'Assistance Immobili√®re';
  if (descEl)   descEl.textContent   = 'Accompagnement personnalis√© pour tous vos projets immobiliers';
  if (icoEl)    { icoEl.textContent  = 'ü§ù'; icoEl.style.background = '#EDE7F6'; }
  if (besoin)   besoin.placeholder   = 'D√©crivez votre projet immobilier en d√©tail...';
  if (soonBox)  soonBox.style.display = 'block';

  setImmoFormFieldsVisibility('default');
  injectSelectInImmoForm('Type de prestation *', [
    { value: 'terrain_securise',      emoji: 'üó∫Ô∏è', label: 'Recherche de terrain s√©curis√©' },
    { value: 'recherche_bien',        emoji: 'üîç', label: 'Recherche de Villa / Appartement / Bureau / Magasin' },
    { value: 'supervision_chantier',  emoji: 'üèóÔ∏è', label: 'Suivi et Supervision de construction / chantier' },
    { value: 'titres_fonciers',       emoji: 'üìú', label: 'V√©rification de titres fonciers' },
    { value: 'juridique',             emoji: '‚öñÔ∏è', label: 'Accompagnement juridique' },
    { value: 'encaissement_loyers',   emoji: 'üíµ', label: 'Encaissement des loyers / Suivi des locataires' },
  ], 'assistance-type-select');

  _immoFormBackFn = () => { renderImmoEnvelope(); showView('immo-options'); };

  const submitBtn = document.getElementById('immo-form-submit-btn');
  if (submitBtn) submitBtn.onclick = () => submitDirectForm('assistance_immo');

  showView('immo-form');
}
window.openAssistanceDirectForm = openAssistanceDirectForm;

// ‚ïê‚ïê submitDirectForm : soumission pour les 3 services directs ‚ïê‚ïê
function submitDirectForm(serviceType) {
  const selectMap = {
    'security':           'security-type-select',
    'gestion_locative':   'gestion-type-select',
    'assistance_immo':    'assistance-type-select',
  };
  const selectId  = selectMap[serviceType];
  const selectEl  = selectId ? document.getElementById(selectId) : null;
  const typeValue = selectEl ? selectEl.value : '';

  if (selectEl && !typeValue) {
    selectEl.style.border = '2px solid #E74C3C';
    selectEl.focus();
    return;
  }
  if (selectEl) selectEl.style.border = '';

  const besoin      = (document.getElementById('immo-ff-besoin')?.value || '').trim();
  const localisation= (document.getElementById('immo-ff-localisation')?.value || '').trim();
  const budget      = (document.getElementById('immo-ff-budget')?.value || '').trim();
  const date        = document.getElementById('immo-ff-date')?.value || '';
  const notes       = (document.getElementById('immo-ff-notes')?.value || '').trim();

  if (!besoin) {
    const el = document.getElementById('immo-ff-besoin');
    if (el) { el.style.border = '2px solid #E74C3C'; el.focus(); }
    return;
  }

  const labelMap = {
    'security':         'Gardiennage & S√©curit√©',
    'gestion_locative': 'Gestion Locative',
    'assistance_immo':  'Assistance Immobili√®re',
  };

  const payload = {
    service:      serviceType,
    serviceLabel: labelMap[serviceType] || serviceType,
    typeChoisi:   typeValue,
    besoin, localisation, budget, date, notes,
    createdAt:    new Date().toISOString(),
  };

  // R√©utiliser submitImmoForm si disponible, sinon √©crire en Firestore directement
  if (typeof window._submitImmoPayload === 'function') {
    window._submitImmoPayload(payload);
  } else {
    // Fallback : utiliser la m√™me logique que submitImmoForm via app.js
    const evt = new CustomEvent('omni-direct-form-submit', { detail: payload });
    window.dispatchEvent(evt);
  }
}
window.submitDirectForm = submitDirectForm;

// ‚ïê‚ïê Gestion Locative et Assistance redirig√©es depuis l'envelope immo ‚ïê‚ïê
function renderImmoGestion(sub) {
  openGestionLocativeDirectForm();
}

function renderImmoAssistance(sub) {
  openAssistanceDirectForm();
}

// ‚ïê‚ïê Helper : contr√¥le visibilit√© champs formulaire immo ‚ïê‚ïê
function setImmoFormFieldsVisibility(mode) {
  // mode: 'vente-location' | 'gestion' | 'default'
  const locLabel  = document.querySelector('label[data-immo-loc]');
  const locInput  = document.getElementById('immo-ff-localisation');
  const budgetLabel = document.querySelector('label[data-immo-budget]');
  const budgetInput = document.getElementById('immo-ff-budget');
  
  if (!locLabel || !locInput) return;
  
  if (mode === 'vente-location') {
    // √Ä vendre / √Ä Louer : masquer localisation ET budget
    locLabel.style.display = 'none';
    locInput.style.display = 'none';
    if (budgetLabel) budgetLabel.style.display = 'none';
    if (budgetInput) budgetInput.style.display = 'none';
  } else if (mode === 'gestion') {
    // Votre Propri√©t√© Notre Gestion : label "Quartier de votre propri√©t√©", budget visible
    locLabel.style.display = '';
    locInput.style.display = '';
    locLabel.childNodes[0].textContent = 'Quartier de votre propri√©t√©';
    locInput.placeholder = 'Ex : Adidogom√©, B√®, Tokoin, Ago√®...';
    if (budgetLabel) budgetLabel.style.display = '';
    if (budgetInput) budgetInput.style.display = '';
  } else {
    // Default (Assistance) : tout visible
    locLabel.style.display = '';
    locInput.style.display = '';
    locLabel.childNodes[0].textContent = 'Localisation / Quartier souhait√©';
    locInput.placeholder = 'Ex : Adidogom√©, B√®, Tokoin, Ago√®...';
    if (budgetLabel) budgetLabel.style.display = '';
    if (budgetInput) budgetInput.style.display = '';
  }
}
window.setImmoFormFieldsVisibility = setImmoFormFieldsVisibility;
window.addEventListener('load', () => {
  // Patcher openService apr√®s chargement de app.js
  setTimeout(() => {
    const _origOpen = window.openService;
    window.openService = function(id) {
      if (id === 'immobilier') {
        goTab('services');
        setTimeout(() => { renderImmoEnvelope(); showView('immo-options'); }, 50);
        return;
      }
      if (id === 'security') {
        goTab('services');
        setTimeout(() => openSecurityDirectForm(), 50);
        return;
      }
      if (id === 'traiteur') {
        openTraiteur();
        return;
      }
      if (_origOpen) _origOpen(id);
    };
  }, 500);
});

// ‚ïê‚ïê Service Traiteur ‚ïê‚ïê
function openTraiteur() {
  goTab('services');
  setTimeout(() => {
    // Utiliser view-form avec champs personnalis√©s
    const titleEl = document.getElementById('form-title');
    const icoEl = document.getElementById('form-ico');
    const fieldsEl = document.getElementById('form-fields');
    const soonEl = document.getElementById('form-soon');
    const soonDate = document.getElementById('form-soon-date');
    
    if (titleEl) titleEl.textContent = 'Service Traiteur';
    if (icoEl) { icoEl.textContent = 'üçΩÔ∏è'; icoEl.style.background = '#FFF8E1'; }
    if (soonEl) soonEl.style.display = 'block';
    if (soonDate) soonDate.textContent = 'Op√©rationnel le 07 Avril 2026. Pr√©-enregistrez votre demande d√®s maintenant.';
    
    if (fieldsEl) {
      fieldsEl.innerHTML = `
        <div class="order-card-title">üçΩÔ∏è Votre √©v√©nement</div>
        <label class="f-label">Type d'√©v√©nement *</label>
        <select class="f-input" id="traiteur-type">
          <option value="">‚Äî S√©lectionnez ‚Äî</option>
          ${TRAITEUR_DATA.options.map(o => `<option value="${o.id}">${o.emoji} ${o.label}</option>`).join('')}
        </select>
        <label class="f-label">Description de l'√©v√©nement *</label>
        <textarea class="f-textarea" rows="4" id="traiteur-desc" placeholder="Date, heure, lieu, th√®me, nombre de personnes attendues, type de repas souhait√©..."></textarea>
        <label class="f-label">Nombre de personnes *</label>
        <input type="number" class="f-input" id="traiteur-nb" placeholder="Ex : 50"/>
        <label class="f-label">Date de l'√©v√©nement *</label>
        <input type="date" class="f-input" id="traiteur-date"/>
        <label class="f-label">Budget estim√© <span style="font-weight:400;font-size:10px;color:#C5C5D8">(optionnel)</span></label>
        <input type="text" class="f-input" id="traiteur-budget" placeholder="Ex : 150 000 FCFA"/>
        <label class="f-label">Remarques <span style="font-weight:400;font-size:10px;color:#C5C5D8">(optionnel)</span></label>
        <textarea class="f-textarea" rows="2" id="traiteur-notes" placeholder="Allergies, restrictions alimentaires, sp√©cialit√©s souhait√©es..."></textarea>
      `;
    }
    showView('form');
  }, 50);
}


</script>
<script>
// Mettre √† jour aussi l'ic√¥ne du bas nav apr√®s connexion
const _origUpdateNav = window.updateNavForAuth;
window.addEventListener('auth-changed', () => {});
// Patch pour l'ic√¥ne bottom nav - profil supprim√© du bas nav, rien √† patcher
function patchBottomNavAvatar(genre) {
  // Profil est uniquement en haut nav, plus besoin de patch bottom nav
}

// ‚ïê‚ïê POLITIQUE DE CONFIDENTIALIT√â ‚ïê‚ïê
function openPrivacyModal() {
  const m = document.getElementById('privacy-modal');
  if (m) { m.style.display = 'flex'; }
}
function closePrivacyModal() {
  const m = document.getElementById('privacy-modal');
  if (m) { m.style.display = 'none'; }
}
window.openPrivacyModal = openPrivacyModal;
window.closePrivacyModal = closePrivacyModal;

// ‚ïê‚ïê SYST√àME DE NOTIFICATIONS ‚ïê‚ïê
let _notifList = JSON.parse(localStorage.getItem('omni_notifs') || '[]');

function saveNotifs() {
  localStorage.setItem('omni_notifs', JSON.stringify(_notifList.slice(0, 50)));
}

function addNotification(title, message, type = 'info', orderId = null) {
  const notif = {
    id: Date.now(),
    title,
    message,
    type, // 'en_cours' | 'terminee' | 'info'
    orderId,
    time: new Date().toISOString(),
    read: false
  };
  _notifList.unshift(notif);
  saveNotifs();
  updateNotifBadge();
  renderNotifList();
  // Notification navigateur si autoris√©
  if (Notification.permission === 'granted') {
    const ico = type === 'en_cours' ? 'üöÄ' : type === 'terminee' ? '‚úÖ' : 'üîî';
    try {
      new Notification(`${ico} OmniService TG`, { body: `${title}\n${message}`, icon: 'assets/logo.png' });
    } catch(e) {}
  }
}
window.addNotification = addNotification;

function updateNotifBadge() {
  const badge = document.getElementById('notif-badge');
  const unread = _notifList.filter(n => !n.read).length;
  if (!badge) return;
  if (unread > 0) {
    badge.textContent = unread > 9 ? '9+' : unread;
    badge.style.display = 'flex';
  } else {
    badge.style.display = 'none';
  }
}

// ‚îÄ‚îÄ Notifications broadcast admin (Firestore ‚Üí tous les clients) ‚îÄ‚îÄ
let _lastBroadcastCheck = parseInt(localStorage.getItem('omni_last_broadcast') || '0');

async function checkBroadcastNotifications() {
  try {
    const { getDocs: gD, collection: col, query: q, where: w, orderBy: ob } =
      await import("https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js");
    const fsApp = (await import("https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js")).getApps()[0];
    if (!fsApp) return;
    const fsDb = (await import("https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js")).getFirestore(fsApp);

    let snap;
    try {
      snap = await gD(q(col(fsDb,'notifications_broadcast'), ob('sentAt','desc')));
    } catch(_) {
      snap = await gD(col(fsDb,'notifications_broadcast'));
    }

    let newCount = 0;
    snap.docs.forEach(docSnap => {
      const n = docSnap.data();
      const sentTs = n.sentAt ? n.sentAt.seconds * 1000 : 0;
      if (sentTs <= _lastBroadcastCheck) return;

      // Eviter les doublons
      const broadcastId = 'broadcast_' + docSnap.id;
      if (_notifList.find(x => x.id === broadcastId)) return;

      _notifList.unshift({
        id: broadcastId,
        title: n.titre || 'Message de OmniService TG',
        message: n.contenu || '',
        type: n.type || 'info',
        lien: n.lien || null,
        time: sentTs ? new Date(sentTs).toISOString() : new Date().toISOString(),
        read: false,
        broadcast: true
      });
      newCount++;
    });

    if (newCount > 0) {
      const maxTs = Math.max(...snap.docs.map(d => d.data().sentAt ? d.data().sentAt.seconds * 1000 : 0));
      if (maxTs > _lastBroadcastCheck) {
        _lastBroadcastCheck = maxTs;
        localStorage.setItem('omni_last_broadcast', String(maxTs));
      }
      saveNotifs();
      updateNotifBadge();
      renderNotifList();
    }
  } catch(e) { /* silencieux */ }
}

// V√©rifier au chargement et toutes les 2 minutes
window.addEventListener('load', () => setTimeout(checkBroadcastNotifications, 3000));
setInterval(checkBroadcastNotifications, 120000);

function renderNotifList() {
  const list = document.getElementById('notif-list');
  const empty = document.getElementById('notif-empty');
  if (!list) return;

  if (!_notifList.length) {
    if (empty) empty.style.display = 'block';
    list.querySelectorAll('.notif-item').forEach(n => n.remove());
    return;
  }
  if (empty) empty.style.display = 'none';

  // Remove old items (keep empty div)
  list.querySelectorAll('.notif-item').forEach(n => n.remove());

  const typeConfig = {
    en_cours:   { ico: 'üöÄ', bg: '#E3F2FD', color: '#1E6FBE' },
    terminee:   { ico: '‚úÖ', bg: '#E8F5E9', color: '#2E7D32' },
    info:       { ico: '‚ÑπÔ∏è', bg: '#FFF3E0', color: '#F5820A' },
    promo:      { ico: 'üè∑Ô∏è', bg: '#FFF3E0', color: '#E65100' },
    alerte:     { ico: '‚ö†Ô∏è', bg: '#FFEBEE', color: '#C62828' },
    nouveaute:  { ico: '‚ú®', bg: '#F3E5F5', color: '#7B1FA2' },
    evenement:  { ico: 'üéâ', bg: '#E8F5E9', color: '#2E7D32' },
  };

  _notifList.forEach(n => {
    const cfg = typeConfig[n.type] || typeConfig.info;
    const timeAgo = formatTimeAgo(n.time);
    const el = document.createElement('div');
    el.className = `notif-item${n.read ? '' : ' unread'}`;
    el.dataset.id = n.id;
    el.innerHTML = `
      <div class="notif-ico" style="background:${cfg.bg}">
        ${cfg.ico}
      </div>
      <div style="flex:1;min-width:0">
        <div class="notif-title">${n.title}</div>
        <div class="notif-sub">${n.message}</div>
        <div class="notif-time">üïê ${timeAgo}</div>
      </div>
    `;
    el.onclick = () => markNotifRead(n.id);
    list.insertBefore(el, list.querySelector('.notif-item'));
    if (!list.querySelector('.notif-item')) list.appendChild(el);
    else list.insertBefore(el, list.firstChild);
  });
}

function markNotifRead(id) {
  const n = _notifList.find(x => x.id === id);
  if (n) { n.read = true; saveNotifs(); updateNotifBadge(); renderNotifList(); }
}

function clearAllNotifs() {
  _notifList = [];
  saveNotifs();
  updateNotifBadge();
  renderNotifList();
}
window.clearAllNotifs = clearAllNotifs;

function formatTimeAgo(iso) {
  const diff = Date.now() - new Date(iso).getTime();
  const mins = Math.floor(diff / 60000);
  if (mins < 1) return "√Ä l'instant";
  if (mins < 60) return `Il y a ${mins} min`;
  const hrs = Math.floor(mins / 60);
  if (hrs < 24) return `Il y a ${hrs}h`;
  const days = Math.floor(hrs / 24);
  return `Il y a ${days} jour${days > 1 ? 's' : ''}`;
}

function openNotifPanel() {
  const panel = document.getElementById('notif-panel');
  if (panel) {
    panel.style.display = 'flex';
    // Mark all as read after 2s
    renderNotifList();
    setTimeout(() => {
      _notifList.forEach(n => n.read = true);
      saveNotifs();
      updateNotifBadge();
    }, 2000);
  }
}
function closeNotifPanel() {
  const panel = document.getElementById('notif-panel');
  if (panel) panel.style.display = 'none';
}
window.openNotifPanel = openNotifPanel;
window.closeNotifPanel = closeNotifPanel;

// ‚ïê‚ïê DEMANDE DE PERMISSION NOTIFICATION NAVIGATEUR ‚ïê‚ïê
function requestNotifPermission() {
  if (!('Notification' in window)) return;
  if (Notification.permission === 'default') {
    Notification.requestPermission().then(perm => {
      if (perm === 'granted') {
        addNotification('Notifications activ√©es !', 'Vous recevrez des alertes sur vos commandes.', 'info');
      }
    });
  }
}

// ‚ïê‚ïê SURVEILLANCE DES CHANGEMENTS DE STATUT ‚ïê‚ïê
// Polling Firestore toutes les 30s pour d√©tecter les changements de statut
let _lastOrderStatuts = {};
let _pollingInterval = null;

async function pollOrderStatuses() {
  // On a besoin de Firebase ‚Äî attendre que app.js l'ait initialis√©
  if (typeof window._firestoreDb === 'undefined' || !window._currentUser) return;

  try {
    const { collection, query, where, getDocs } = window._firestoreUtils || {};
    if (!getDocs) return;
    const db = window._firestoreDb;
    const user = window._currentUser;
    const q = query(collection(db, 'commandes'), where('uid', '==', user.uid));
    const snap = await getDocs(q);
    snap.forEach(d => {
      const data = d.data();
      const id = d.id;
      const statut = data.statut || '';
      const prev = _lastOrderStatuts[id];

      if (prev !== undefined && prev !== statut) {
        // Statut chang√© !
        const ref = '#' + id.slice(0, 8).toUpperCase();
        const svcName = data.serviceName || data.service || 'votre service';

        if (statut === 'En cours') {
          addNotification(
            'üöÄ Commande en cours !',
            `Votre commande ${ref} (${svcName}) est maintenant prise en charge par notre √©quipe.`,
            'en_cours', id
          );
        } else if (statut === 'Termin√©e') {
          addNotification(
            '‚úÖ Commande termin√©e !',
            `Votre commande ${ref} (${svcName}) est termin√©e. Merci de votre confiance ‚Äî OmniService TG üôè`,
            'terminee', id
          );
        }
      }
      _lastOrderStatuts[id] = statut;
    });
  } catch(e) {
    // Silencieux en cas d'erreur
  }
}

// Exposer les utils Firestore depuis app.js via window
// (app.js doit exposer window._firestoreDb, window._firestoreUtils, window._currentUser)

// ‚ïê‚ïê COMPTE √Ä REBOURS PAGE SUCC√àS ‚ïê‚ïê
let _succCountdownTimer = null;
// Patch showView pour d√©marrer le compte √† rebours quand on arrive sur 'success'
const _origShowView = window.showView;
window.showView = function(v) {
  if (_origShowView) _origShowView(v);
  if (v === 'success') {
    startSuccessCountdown();
  } else {
    stopSuccessCountdown();
  }
};

function startSuccessCountdown() {
  stopSuccessCountdown();
  let count = 3;
  const el = document.getElementById('succ-countdown');
  const msgEl = document.getElementById('succ-redirect-msg');
  if (el) el.textContent = count;
  if (msgEl) msgEl.style.display = 'block';

  _succCountdownTimer = setInterval(() => {
    count--;
    if (el) el.textContent = count;
    if (count <= 0) {
      stopSuccessCountdown();
      if (typeof goTab === 'function') goTab('orders');
    }
  }, 1000);
}

function stopSuccessCountdown() {
  if (_succCountdownTimer) {
    clearInterval(_succCountdownTimer);
    _succCountdownTimer = null;
  }
}

// D√©marrer le polling et les initialisations
window.addEventListener('DOMContentLoaded', () => {
  updateNotifBadge();
  renderNotifList();

  // Demander permission notification apr√®s 5s
  setTimeout(requestNotifPermission, 5000);

  // Polling toutes les 30s
  _pollingInterval = setInterval(pollOrderStatuses, 30000);
});

</script>
</body>
</html>