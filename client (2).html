<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>OmniService TG â€” Services professionnels Ã  LomÃ©</title>
<meta name="description" content="OmniService TG â€” Alimentation, livraison, nettoyage, restauration et plus Ã  LomÃ©, Togo."/>
<meta name="theme-color" content="#1E6FBE"/>
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="default"/>
<meta name="apple-mobile-web-app-title" content="OmniService TG"/>
<meta name="msapplication-TileColor" content="#1E6FBE"/>
<meta property="og:title" content="OmniService TG"/>
<meta property="og:description" content="Alimentation, livraison, nettoyage, restauration et plus Ã  LomÃ©, Togo."/>
<meta property="og:type" content="website"/>
<link rel="manifest" href="manifest.json"/>
<link rel="icon" href="assets/logo.png" type="image/png"/>
<link rel="apple-touch-icon" href="assets/logo.png"/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;800;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="style.css"/>
<style>
/* â•â• RESTAURANTS VIEW â•â• */
#view-restaurants { padding-bottom: 20px; }

/* â•â• KITS VIEW â•â• */
#view-kits { padding-bottom: 20px; }
#view-kit-detail { padding-bottom: 20px; }

.kit-card {
  display: flex;
  align-items: flex-start;
  gap: 14px;
  background: #fff;
  border-radius: 18px;
  padding: 14px 16px;
  margin: 0 16px 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,.08);
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
  position: relative;
  overflow: hidden;
}
.kit-card:active { transform: scale(.98); }
.kit-card:hover { box-shadow: 0 4px 20px rgba(30,111,190,.15); }
.kit-img-wrap {
  width: 80px;
  height: 80px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  overflow: hidden;
}
.kit-body { flex: 1; min-width: 0; }
.kit-badge {
  display: inline-block;
  font-size: 9px;
  font-weight: 800;
  color: #1E6FBE;
  background: #E3F2FD;
  border-radius: 999px;
  padding: 3px 9px;
  text-transform: uppercase;
  letter-spacing: .4px;
  margin-bottom: 5px;
}
.kit-name {
  font-size: 14px;
  font-weight: 700;
  color: #1A1A2E;
  margin-bottom: 3px;
}
.kit-desc {
  font-size: 11px;
  color: #4A4A6A;
  line-height: 1.4;
  margin-bottom: 8px;
}
.kit-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.kit-price {
  font-size: 14px;
  font-weight: 800;
  color: #1E6FBE;
}
.kit-count {
  font-size: 10px;
  font-weight: 600;
  color: #9999BB;
  background: #F4F6FA;
  border-radius: 999px;
  padding: 3px 9px;
}
.kit-arrow { font-size: 22px; color: #E8EAF0; flex-shrink: 0; align-self: center; }

/* â•â• KIT DETAIL â•â• */
.kit-detail-hero {
  margin: 0 16px 14px;
  background: linear-gradient(135deg, #1E6FBE, #155A9C);
  border-radius: 20px;
  padding: 22px 20px;
  color: #fff;
  position: relative;
  overflow: hidden;
}
.kit-detail-hero::before {
  content: attr(data-emoji);
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 70px;
  opacity: .2;
}
.kit-detail-hero-name {
  font-size: 18px;
  font-weight: 800;
  font-family: 'Nunito', sans-serif;
  margin-bottom: 5px;
}
.kit-detail-hero-desc {
  font-size: 12px;
  color: rgba(255,255,255,.75);
  line-height: 1.5;
  margin-bottom: 12px;
}
.kit-detail-hero-price {
  font-size: 22px;
  font-weight: 900;
  font-family: 'Nunito', sans-serif;
  color: #fff;
}
.kit-detail-hero-price-label {
  font-size: 10px;
  color: rgba(255,255,255,.55);
  text-transform: uppercase;
  letter-spacing: .5px;
  margin-bottom: 3px;
}

.kit-articles-card {
  margin: 0 16px 14px;
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 2px 12px rgba(0,0,0,.07);
  overflow: hidden;
}
.kit-articles-title {
  padding: 14px 18px 10px;
  font-size: 13px;
  font-weight: 700;
  color: #1A1A2E;
  border-bottom: 1px solid #F0F0F8;
}
.kit-article-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 11px 18px;
  border-bottom: 1px solid #F4F6FA;
}
.kit-article-row:last-child { border-bottom: none; }
.kit-article-emoji {
  font-size: 22px;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #F4F6FA;
  border-radius: 10px;
  flex-shrink: 0;
}
.kit-article-info { flex: 1; min-width: 0; }
.kit-article-name { font-size: 13px; font-weight: 600; color: #1A1A2E; }
.kit-article-qty { font-size: 11px; color: #9999BB; margin-top: 2px; }
.kit-article-price { font-size: 12px; font-weight: 700; color: #1E6FBE; }

.kit-order-btn {
  display: block;
  margin: 0 16px 16px;
  width: calc(100% - 32px);
  background: linear-gradient(135deg, #1E6FBE, #155A9C);
  color: #fff;
  border: none;
  border-radius: 16px;
  padding: 16px;
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  box-shadow: 0 4px 18px rgba(30,111,190,.35);
  transition: all .2s;
}
.kit-order-btn:hover { transform: translateY(-1px); box-shadow: 0 8px 28px rgba(30,111,190,.45); }

.kits-section-title {
  font-size: 12px;
  font-weight: 800;
  color: #9999BB;
  text-transform: uppercase;
  letter-spacing: .6px;
  padding: 16px 16px 8px;
}
  display: flex;
  align-items: center;
  gap: 14px;
  background: #fff;
  border-radius: 18px;
  padding: 14px 16px;
  margin: 0 16px 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,.08);
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
  position: relative;
  overflow: hidden;
}
.restaurant-card:active { transform: scale(.98); }
.restaurant-card:hover { box-shadow: 0 4px 20px rgba(30,111,190,.15); }
.rst-img-wrap {
  width: 72px;
  height: 72px;
  border-radius: 14px;
  background: linear-gradient(135deg,#E3F2FD,#BBDEFB);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  overflow: hidden;
}
.rst-body { flex: 1; min-width: 0; }
.rst-name {
  font-size: 14px;
  font-weight: 700;
  color: #1A1A2E;
  margin-bottom: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.rst-spec { font-size: 11px; color: #1E6FBE; font-weight: 600; margin-bottom: 2px; }
.rst-loc  { font-size: 10px; color: #9999BB; }
.rst-desc { font-size: 11px; color: #4A4A6A; margin-top: 4px; line-height: 1.4; }
.rst-arrow { font-size: 22px; color: #E8EAF0; flex-shrink: 0; }
.rst-section-title {
  font-size: 12px;
  font-weight: 800;
  color: #9999BB;
  text-transform: uppercase;
  letter-spacing: .6px;
  padding: 16px 16px 8px;
}

#auth-modal{
  display:none;position:fixed;inset:0;z-index:2000;
  background:rgba(10,18,32,.75);backdrop-filter:blur(6px);
  align-items:center;justify-content:center;padding:16px;
}
.auth-box{
  background:#fff;border-radius:24px;width:100%;max-width:420px;
  box-shadow:0 30px 80px rgba(0,0,0,.35);overflow:hidden;
  max-height:92vh;overflow-y:auto;
}
.auth-header{
  background:linear-gradient(135deg,#1E6FBE,#155A9C);
  padding:24px 24px 20px;text-align:center;position:relative;
}
.auth-header-logo{
  display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:6px;
}
.auth-header-logo img{width:36px;height:36px;object-fit:contain;border-radius:9px}
.auth-header-brand{
  font-family:'Nunito',sans-serif;font-size:20px;font-weight:900;color:#fff;
}
.auth-header-sub{font-size:11px;color:rgba(255,255,255,.6);margin-top:2px}
.auth-close{
  position:absolute;top:14px;right:14px;
  background:rgba(255,255,255,.15);border:none;color:#fff;
  width:30px;height:30px;border-radius:50%;cursor:pointer;
  font-size:16px;display:flex;align-items:center;justify-content:center;
}
.auth-tabs{
  display:flex;border-bottom:1.5px solid #E8EAF0;
}
.auth-tab{
  flex:1;padding:14px;text-align:center;font-size:13px;font-weight:700;
  cursor:pointer;color:#9999BB;border:none;background:transparent;
  font-family:'Poppins',sans-serif;transition:all .2s;
  border-bottom:2.5px solid transparent;margin-bottom:-1.5px;
}
.auth-tab.on{color:#1E6FBE;border-bottom-color:#1E6FBE}
.auth-panel{padding:22px 24px 28px}
.auth-field{margin-bottom:14px}
.auth-label{
  display:block;font-size:11px;font-weight:700;color:#4A4A6A;
  margin-bottom:5px;text-transform:uppercase;letter-spacing:.4px;
}
.auth-inp{
  width:100%;padding:11px 13px;border:1.5px solid #E8EAF0;border-radius:11px;
  font-size:13px;font-family:'Poppins',sans-serif;background:#F4F6FA;outline:none;
  color:#1A1A2E;transition:border-color .2s,background .2s;
}
.auth-inp:focus{border-color:#1E6FBE;background:#fff}
.auth-inp-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.auth-btn{
  width:100%;background:linear-gradient(135deg,#1E6FBE,#155A9C);color:#fff;
  border:none;border-radius:999px;padding:14px;font-size:14px;font-weight:700;
  cursor:pointer;font-family:'Poppins',sans-serif;margin-top:6px;
  box-shadow:0 4px 18px rgba(30,111,190,.35);transition:all .2s;
  display:flex;align-items:center;justify-content:center;gap:8px;
}
.auth-btn:hover{transform:translateY(-1px);box-shadow:0 8px 28px rgba(30,111,190,.45)}
.auth-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
.auth-err{
  min-height:18px;font-size:12px;font-weight:600;color:#C62828;
  text-align:center;margin-top:10px;
}
.auth-sep{
  text-align:center;font-size:11px;color:#9999BB;
  margin:14px 0 10px;display:flex;align-items:center;gap:10px;
}
.auth-sep::before,.auth-sep::after{content:'';flex:1;height:1px;background:#E8EAF0}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.4);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* â•â• PROFIL REFACTO â•â• */
#prof-auth-card{
  background:#fff;border-radius:16px;padding:22px;text-align:center;
  box-shadow:0 2px 12px rgba(0,0,0,.07);margin-bottom:16px;
}
#prof-auth-card .auth-card-title{
  font-size:15px;font-weight:700;color:#1A1A2E;margin-bottom:6px;
}
#prof-auth-card .auth-card-sub{
  font-size:12px;color:#9999BB;margin-bottom:16px;line-height:1.6;
}
#prof-auth-card .btn-row{display:flex;gap:10px}
#prof-auth-card .btn-login{
  flex:1;background:linear-gradient(135deg,#1E6FBE,#155A9C);color:#fff;
  border:none;border-radius:999px;padding:12px;font-size:13px;font-weight:700;
  cursor:pointer;font-family:'Poppins',sans-serif;
}
#prof-auth-card .btn-signup{
  flex:1;background:#fff;color:#1E6FBE;border:1.5px solid #1E6FBE;
  border-radius:999px;padding:12px;font-size:13px;font-weight:700;
  cursor:pointer;font-family:'Poppins',sans-serif;
}

/* â•â• SECTION COMMANDES PAGE â•â• */
.orders-user-info{
  background:#fff;border-radius:16px;padding:14px 18px;
  box-shadow:0 2px 12px rgba(0,0,0,.07);margin-bottom:18px;
  display:flex;align-items:center;gap:12px;
}
.orders-user-avatar{
  font-size:32px;width:48px;height:48px;display:flex;
  align-items:center;justify-content:center;
  background:linear-gradient(135deg,#1E6FBE,#155A9C);
  border-radius:50%;
}
.orders-user-name{font-size:13px;font-weight:700;color:#1A1A2E}
.orders-user-phone{font-size:11px;color:#9999BB;margin-top:2px}
.orders-refresh-btn{
  margin-left:auto;background:#F4F6FA;border:1.5px solid #E8EAF0;
  border-radius:999px;padding:8px 14px;font-size:11px;font-weight:700;
  cursor:pointer;color:#4A4A6A;font-family:'Poppins',sans-serif;white-space:nowrap;
}
.orders-refresh-btn:hover{background:#E3F2FD;border-color:#1E6FBE;color:#1E6FBE}

/* â•â• BOUTON ANNULATION COMMANDE â•â• */
.o-cancel-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 7px;
  width: 100%;
  margin-top: 8px;
  background: #FFF5F5;
  border: 1.5px solid #FFCDD2;
  border-radius: 12px;
  padding: 11px 16px;
  font-size: 12px;
  font-weight: 700;
  color: #C62828;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  transition: all .15s;
}
.o-cancel-btn:hover {
  background: #FFEBEE;
  border-color: #C62828;
  box-shadow: 0 2px 10px rgba(198,40,40,.15);
}

/* â•â• CONTENEUR DES ACTIONS COMMANDE â•â• */
.o-actions {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 0;
}

/* â•â• BOUTON VOIR ARTICLES COMMANDÃ‰S â•â• */
.o-articles-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 7px;
  width: 100%;
  background: #EEF4FF;
  border: 1.5px solid #C5D8FF;
  border-radius: 12px;
  padding: 11px 16px;
  font-size: 12px;
  font-weight: 700;
  color: #1E6FBE;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  transition: all .15s;
}
.o-articles-btn:hover {
  background: #E3F2FD;
  border-color: #1E6FBE;
  box-shadow: 0 2px 10px rgba(30,111,190,.15);
}

@keyframes slideUp {
  from { transform: translateY(100%); }
  to   { transform: translateY(0); }
}

/* â•â• NOTIFICATION PANEL â•â• */
@keyframes notifSlideIn {
  from { opacity:0; transform:translateY(-10px) scale(.97); }
  to   { opacity:1; transform:translateY(0) scale(1); }
}

/* â•â• PRIVACY MODAL â•â• */
#privacy-modal {
  display:none;position:fixed;inset:0;z-index:4000;
  background:rgba(10,18,32,.75);backdrop-filter:blur(6px);
  align-items:flex-end;justify-content:center;padding:0;
}
#privacy-modal.open { display:flex; }
.privacy-box {
  background:#fff;border-radius:28px 28px 0 0;width:100%;max-width:600px;
  max-height:90vh;overflow-y:auto;
  box-shadow:0 -8px 40px rgba(0,0,0,.2);
  animation:privacyUp .3s cubic-bezier(.16,1,.3,1);
}
@keyframes privacyUp {
  from { transform:translateY(100%); opacity:0; }
  to   { transform:translateY(0); opacity:1; }
}
.privacy-header {
  position:sticky;top:0;background:#fff;padding:20px 22px 14px;
  border-bottom:1px solid #F0F0F8;display:flex;align-items:center;
  justify-content:space-between;z-index:1;
}
.privacy-title { font-family:'Nunito',sans-serif;font-size:18px;font-weight:900;color:#1A1A2E; }
.privacy-close { background:none;border:none;font-size:22px;color:#9999BB;cursor:pointer;padding:4px; }
.privacy-body { padding:20px 22px 40px; }
.privacy-section { margin-bottom:22px; }
.privacy-section-title { font-size:13px;font-weight:800;color:#1E6FBE;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px;display:flex;align-items:center;gap:6px; }
.privacy-section p { font-size:13px;color:#4A4A6A;line-height:1.7;margin:0; }
.privacy-trust-badges { display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:16px; }
.privacy-badge { background:#F4F6FA;border-radius:14px;padding:14px;text-align:center; }
.privacy-badge-ico { font-size:24px;margin-bottom:6px; }
.privacy-badge-label { font-size:11px;font-weight:700;color:#1A1A2E; }
.privacy-badge-sub { font-size:10px;color:#9999BB;margin-top:2px; }
</style>
</head>
<body>

<!-- â•â• SPLASH SCREEN â•â• -->
<div id="splash-screen">
  <div class="splash-bg"></div>
  <div class="splash-content">
    <div class="splash-logo-wrap">
      <div class="splash-logo-ring"></div>
      <div class="splash-logo-box">
        <img src="assets/logo.png" alt="OmniService TG" id="splash-img"
             onerror="this.outerHTML='<div class=splash-fallback>ğŸ›¡ï¸</div>'"/>
      </div>
    </div>
    <div class="splash-brand">
      <span class="splash-blue">Omni</span><span class="splash-ora">Service</span> <span class="splash-blue">TG</span>
    </div>
    <div class="splash-tagline">Appelez, on s'en charge</div>
    <div class="splash-loader">
      <div class="splash-loader-bar"></div>
    </div>
    <div class="splash-footer">ğŸ‡¹ğŸ‡¬ BasÃ© Ã  LomÃ©, Togo</div>
  </div>
</div>

<!-- â•â• MODAL AUTH (Connexion / Inscription) â•â• -->
<div id="auth-modal" onclick="if(event.target===this)closeAuthModal()">
  <div class="auth-box">
    <!-- Header avec logo + nom -->
    <div class="auth-header">
      <div class="auth-header-logo">
        <img src="assets/logo.png" alt="OmniService TG" onerror="this.outerHTML='ğŸ›¡ï¸'"/>
        <div class="auth-header-brand">
          <span style="color:#fff">Omni</span><span style="color:#F5820A">Service</span> <span style="color:#fff">TG</span>
        </div>
      </div>
      <div class="auth-header-sub">Votre espace personnel OmniService</div>
      <button class="auth-close" onclick="closeAuthModal()">âœ•</button>
    </div>
    <!-- Onglets -->
    <div class="auth-tabs">
      <button class="auth-tab on" id="auth-tab-login"  onclick="switchAuthTab('login')">Connexion</button>
      <button class="auth-tab"    id="auth-tab-signup" onclick="switchAuthTab('signup')">Inscription</button>
    </div>
    <!-- Panneau Connexion (par tÃ©lÃ©phone) -->
    <div id="auth-login-panel" class="auth-panel">
      <div class="auth-field">
        <label class="auth-label">NumÃ©ro de tÃ©lÃ©phone</label>
        <input type="tel" class="auth-inp" id="login-phone" placeholder="+228 XX XX XX XX" autocomplete="tel"
               onkeydown="if(event.key==='Enter')doLogin()"/>
      </div>
      <button class="auth-btn" id="login-btn" onclick="doLogin()">Se connecter â†’</button>
      <div class="auth-err" id="auth-err"></div>
      <div class="auth-sep">Pas encore de compte ?</div>
      <button style="width:100%;background:transparent;border:1.5px solid #1E6FBE;color:#1E6FBE;border-radius:999px;padding:12px;font-size:13px;font-weight:700;cursor:pointer;font-family:'Poppins',sans-serif" onclick="switchAuthTab('signup')">CrÃ©er mon compte â†’</button>
    </div>
    <!-- Panneau Inscription (tÃ©lÃ©phone uniquement) -->
    <div id="auth-signup-panel" class="auth-panel" style="display:none">
      <div class="auth-inp-row">
        <div class="auth-field">
          <label class="auth-label">PrÃ©nom *</label>
          <input type="text" class="auth-inp" id="signup-prenom" placeholder="Ex : Kofi" autocomplete="given-name"/>
        </div>
        <div class="auth-field">
          <label class="auth-label">Nom *</label>
          <input type="text" class="auth-inp" id="signup-nom" placeholder="Ex : Mensah" autocomplete="family-name"/>
        </div>
      </div>
      <div class="auth-field">
        <label class="auth-label">Genre *</label>
        <select class="auth-inp" id="signup-genre">
          <option value="">â€” SÃ©lectionner â€”</option>
          <option value="homme">ğŸ‘¨ Homme</option>
          <option value="femme">ğŸ‘© Femme</option>
        </select>
      </div>
      <div class="auth-field">
        <label class="auth-label">TÃ©lÃ©phone * <span style="font-size:10px;color:var(--light);font-weight:400">(identifiant unique)</span></label>
        <input type="tel" class="auth-inp" id="signup-phone" placeholder="+228 XX XX XX XX" autocomplete="tel"
               onkeydown="if(event.key==='Enter')doSignup()"/>
      </div>
      <div class="auth-field">
        <label class="auth-label">Ville de rÃ©sidence *</label>
        <input type="text" class="auth-inp" id="signup-ville" placeholder="Ex : LomÃ©, KpalimÃ©, Kara..." autocomplete="address-level2"/>
      </div>
      <button class="auth-btn" id="signup-btn" onclick="doSignup()">S'inscrire â†’</button>
      <div class="auth-err" id="auth-err"></div>
    </div>
  </div>
</div>

<!-- â•â• BANNIÃˆRE PWA â•â• -->
<div id="pwa-banner" style="display:none">
  <div class="pwa-inner">
    <div class="pwa-logo">
      <img src="assets/logo.png" alt="" onerror="this.outerHTML='ğŸ›¡ï¸'"/>
    </div>
    <div class="pwa-text">
      <div class="pwa-title">Installer l'application</div>
      <div class="pwa-sub">AccÃ©dez rapidement Ã  OmniService TG</div>
    </div>
    <button class="pwa-btn" id="pwa-install-btn">Installer</button>
    <button class="pwa-close" onclick="dismissPWA()">âœ•</button>
  </div>
</div>

<!-- â•â• TOP NAV â•â• -->
<header class="topnav">
  <div class="topnav-inner">
    <div class="topnav-row1">
      <div class="logo-area">
        <!-- Logo + Nom -->
        <div class="logo-box">
          <img src="assets/logo.png" alt="OmniService TG" onerror="this.parentElement.innerHTML='ğŸ›¡ï¸'"/>
        </div>
        <div>
          <div class="brand-name">
            <span class="brand-blue">Omni</span><span class="brand-ora">Service</span> <span class="brand-blue">TG</span>
          </div>
          <div class="brand-sub">Appelez, on s'en charge</div>
        </div>
        <nav class="nav-links">
          <button class="nav-link on"  id="nl-home"     onclick="goTab('home')">ğŸ  Accueil</button>
          <button class="nav-link"     id="nl-services" onclick="goTab('services')">ğŸ› ï¸ Services</button>
          <button class="nav-link"     id="nl-orders"   onclick="goTab('orders')">ğŸ“¦ Commandes</button>
          <button class="nav-link"     id="nl-about"    onclick="goTab('about')">â„¹ï¸ Ã€ propos</button>
        </nav>
      </div>
      <div class="nav-right">
        <button class="nav-btn" onclick="goTab('orders')" title="Mes commandes">
          ğŸ›’<span class="cart-badge" id="cart-count" style="display:none">0</span>
        </button>
        <!-- Cloche notifications -->
        <button class="nav-btn" id="notif-btn" onclick="openNotifPanel()" title="Notifications" style="position:relative">
          ğŸ””<span id="notif-badge" style="display:none;position:absolute;top:4px;right:4px;background:#C62828;color:#fff;font-size:9px;font-weight:800;min-width:16px;height:16px;border-radius:999px;display:none;align-items:center;justify-content:center;padding:0 3px;line-height:1"></span>
        </button>
        <!-- Bouton profil â€” devient avatar homme/femme aprÃ¨s connexion -->
        <button class="nav-btn" id="nav-btn-profile" onclick="goTab('profile')" title="Mon profil">ğŸ‘¤</button>
      </div>
    </div>
    <div class="search-wrap">
      <span class="search-ico">ğŸ”</span>
      <input type="text" placeholder="Rechercher un service..." id="search-input" oninput="filterServices(this.value)"/>
    </div>
  </div>
</header>

<div class="app-body">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE : ACCUEIL
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page on" id="p-home">
    <div class="marquee-wrap">
      <div class="mtrack">
        <span class="mtext">âœ” Professionnalisme &nbsp;âœ” FiabilitÃ© &nbsp;âœ” Excellence &nbsp;âœ” Respect &nbsp;â€” &nbsp;<b>OmniService TG</b> &nbsp;â€” Simplifiez votre quotidien ! &nbsp;&nbsp;&nbsp;</span>
        <span class="mtext">âœ” Professionnalisme &nbsp;âœ” FiabilitÃ© &nbsp;âœ” Excellence &nbsp;âœ” Respect &nbsp;â€” &nbsp;<b>OmniService TG</b> &nbsp;â€” Simplifiez votre quotidien ! &nbsp;&nbsp;&nbsp;</span>
      </div>
    </div>
    <!-- â•â• BANDEAU PUBLICITAIRE (style Gozem / Yas / Flooz) â•â• -->
    <div class="adband-wrap">
      <div class="adband-track" id="adband-track">

        <!-- Pub â€” Kits & PACKS -->
        <div class="adcard" data-service="kits" onclick="openService('kits')">
          <div class="adcard-img" style="background:linear-gradient(135deg,#2E7D32 0%,#1b5e20 100%)">
            <div class="adcard-gradient"></div>
            <span class="adcard-emoji-bg">ğŸ</span>
          </div>
          <div class="adcard-badge adcard-badge--green">ğŸ“¦ Kits</div>
          <div class="adcard-body">
            <div class="adcard-promo">OFFRES GROUPÃ‰ES</div>
            <div class="adcard-title">Kits &amp; PACKS
prÃªts Ã  commander</div>
            <div class="adcard-sub">Repas, Mode, Ã‰vÃ©nement...</div>
            <div class="adcard-cta">DÃ©couvrir â†’</div>
          </div>
        </div>

      </div>
      <!-- Indicateurs dots -->
      <div class="adband-dots" id="adband-dots">
        <span class="adband-dot on"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
        <span class="adband-dot"></span>
      </div>
    </div>
    <div class="sec">
      <div class="sec-head">
        <div><div class="sec-title">Services disponibles</div><div class="sec-sub">Choisissez ce dont vous avez besoin</div></div>
        <button class="see-all" onclick="goTab('services')">Tous â€º</button>
      </div>
      <div class="svc-grid">
        <button class="svc-btn" onclick="openService('food')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:linear-gradient(135deg,#66BB6A,#2E7D32)">ğŸ§º</div><span class="svc-lbl">Produits Locaux/Frais</span></button>
        <button class="svc-btn" onclick="openService('restaurant')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:linear-gradient(135deg,#42A5F5,#1976D2)">ğŸ½ï¸</div><span class="svc-lbl">Restaurants</span></button>
        <button class="svc-btn" onclick="openService('delivery')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:linear-gradient(135deg,#FB8C00,#E65100)">ğŸï¸</div><span class="svc-lbl">Livraison</span></button>
        <button class="svc-btn" onclick="openService('maintenance')"><span class="svc-soon">16 Mars</span><div class="svc-ico" style="background:linear-gradient(135deg,#EF5350,#C62828)">ğŸ”§</div><span class="svc-lbl">DÃ©pannage</span></button>
        <button class="svc-btn" onclick="openService('kits')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#4CAF50,#2E7D32)">ğŸ“¦</div><span class="svc-lbl">Kits/PACKS</span></button>
        <button class="svc-btn" onclick="openService('cleaning')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#26C6DA,#0097A7)">âœ¨</div><span class="svc-lbl">Nettoyage</span></button>
        <button class="svc-btn" onclick="openService('clothes')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#EC407A,#C2185B)">ğŸ‘—</div><span class="svc-lbl">PrÃªt-Ã -porter</span></button>
        <button class="svc-btn" onclick="openService('togo_expertise')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#9C27B0,#6A1B9A)">ğŸ†</div><span class="svc-lbl">TOGO Expertise</span></button>
        <button class="svc-btn" onclick="openService('immobilier')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#66BB6A,#388E3C)">ğŸ¢</div><span class="svc-lbl">Immobilier</span></button>
        <button class="svc-btn" onclick="openService('security')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#3F51B5,#283593)">ğŸ›¡ï¸</div><span class="svc-lbl">Gardiennage</span></button>
        <button class="svc-btn" onclick="openService('traiteur')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#FFC107,#F57C00)">ğŸ½ï¸</div><span class="svc-lbl">Traiteur</span></button>
        <button class="svc-btn" onclick="openService('omni_drink')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#26C6DA,#00838F)">ğŸ¾</div><span class="svc-lbl">Omni Drink</span></button>
        <button class="svc-btn" onclick="openService('marketplace')"><span class="svc-soon">7 Avr</span><div class="svc-ico" style="background:linear-gradient(135deg,#F48FB1,#E91E63)">ğŸ›ï¸</div><span class="svc-lbl">Marketplace</span></button>
      </div>
    </div>
    <div class="sec">
      <div class="sec-title" style="margin-bottom:14px">Pourquoi nous choisir ?</div>
      <div class="why-grid">
        <div class="why-card"><div class="why-ico" style="background:#E3F2FD">ğŸ›¡ï¸</div><div><div class="why-title">Organisation structurÃ©e</div><div class="why-desc">Chaque intervention planifiÃ©e et encadrÃ©e.</div></div></div>
        <div class="why-card"><div class="why-ico" style="background:#FFF3E0">â­</div><div><div class="why-title">Ã‰quipe identifiable</div><div class="why-desc">Personnel formÃ©, professionnel et fiable.</div></div></div>
        <div class="why-card"><div class="why-ico" style="background:#E3F2FD">âš¡</div><div><div class="why-title">Service moderne</div><div class="why-desc">Communication claire et suivi efficace.</div></div></div>
        <div class="why-card"><div class="why-ico" style="background:#FFF3E0">ğŸ•</div><div><div class="why-title">Engagement qualitÃ©</div><div class="why-desc">DÃ©lais et standards toujours respectÃ©s.</div></div></div>
      </div>
    </div>
    <div class="sec">
      <div class="cta-banner">
        <div class="cta-title">PrÃªt Ã  travailler avec des professionnels ?</div>
        <div class="cta-sub">Contactez OmniService TG et dÃ©couvrez une nouvelle maniÃ¨re de gÃ©rer vos services au quotidien.</div>
        <div class="cta-btns">
          <a href="tel:+22870652222" class="cta-btn">ğŸ“ Nous appeler</a>
          <a href="https://wa.me/22870652222" class="cta-btn cta-wa">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
            WhatsApp
          </a>
        </div>
      </div>
    </div>
  </div><!-- /home -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE : SERVICES
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="p-services">
    <!-- VUE 1 : Liste -->
    <div id="view-list">
      <div class="sec" style="padding-top:20px">
        <div class="sec-title">Nos Services</div>
        <div class="sec-sub" style="margin-bottom:16px">Une solution intÃ©grÃ©e pour tous vos besoins</div>
        <div class="svc-list">
          <button class="svc-row" onclick="openService('food')"><div class="svc-row-ico" style="background:linear-gradient(135deg,#66BB6A,#2E7D32)">ğŸ§º</div><div style="flex:1"><div class="svc-row-name">Produits Locaux/Frais<span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">Kits alimentaires, produits frais (Tilapia, Volailles, LÃ©gumes), NÃ©rÃ©, Vin de palme.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('restaurant')"><div class="svc-row-ico" style="background:#E3F2FD">ğŸ½ï¸</div><div style="flex:1"><div class="svc-row-name">Restaurants <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">DÃ©couvrez nos restaurants partenaires et commandez vos plats prÃ©fÃ©rÃ©s.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('delivery')"><div class="svc-row-ico" style="background:linear-gradient(135deg,#FB8C00,#E65100)">ğŸï¸</div><div style="flex:1"><div class="svc-row-name">Livraison et courses <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">Livraison express, courses personnalisÃ©es, livraison entreprise et de plats.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('maintenance')"><div class="svc-row-ico" style="background:#E3F2FD">ğŸ”§</div><div style="flex:1"><div class="svc-row-name">DÃ©pannage <span class="tag-soon">16 Mars</span></div><div class="svc-row-desc">Ã‰lectricitÃ©, plomberie, climatisation, Ã©lectromÃ©nager, informatique, pose TV/antenne.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('kits')"><div class="svc-row-ico" style="background:#E8F5E9">ğŸ“¦</div><div style="flex:1"><div class="svc-row-name">Kits &amp; Packs <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Associations d'articles prÃ©parÃ©s par notre Ã©quipe : kits repas, packs Ã©vÃ©nement, mode, nettoyage et plus.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('cleaning')"><div class="svc-row-ico" style="background:#E3F2FD">âœ¨</div><div style="flex:1"><div class="svc-row-name">Nettoyage professionnel <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Nettoyage rÃ©sidentiel, bureaux, entretien rÃ©gulier et industriel.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('clothes')"><div class="svc-row-ico" style="background:#FFF3E0">ğŸ‘—</div><div style="flex:1"><div class="svc-row-name">PrÃªt-Ã -porter <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">VÃªtements africains, boubous, robes, ensembles, accessoires de mode.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('togo_expertise')"><div class="svc-row-ico" style="background:#EDE7F6">ğŸ†</div><div style="flex:1"><div class="svc-row-name">TOGO Expertise <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Formation commerciale (Mathivick) et financement de projets (Omega Conseils) â€” deux expertises, un seul pÃ´le.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('immobilier')"><div class="svc-row-ico" style="background:#E8F5E9">ğŸ¢</div><div style="flex:1"><div class="svc-row-name">Service Immobilier <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Location, vente, gestion locative, assistance diaspora pour l'investissement immobilier.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('security')"><div class="svc-row-ico" style="background:#E3F2FD">ğŸ›¡ï¸</div><div style="flex:1"><div class="svc-row-name">Gardiennage &amp; SÃ©curitÃ© <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Gardiennage rÃ©sidentiel/boutique/bureau, sÃ©curitÃ© Ã©vÃ©nementielle.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('traiteur')"><div class="svc-row-ico" style="background:#FFF8E1">ğŸ½ï¸</div><div style="flex:1"><div class="svc-row-name">Service Traiteur <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Anniversaires, fÃªtes, Ã©vÃ©nements â€” repas prÃ©parÃ©s et servis sur mesure.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('omni_drink')"><div class="svc-row-ico" style="background:#E0F7FA">ğŸ¾</div><div style="flex:1"><div class="svc-row-name">Omni Drink TG <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Boissons fraÃ®ches, jus naturels, eau minÃ©rale et softs livrÃ©s chez vous.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
          <button class="svc-row" onclick="openService('marketplace')"><div class="svc-row-ico" style="background:#FCE4EC">ğŸ›ï¸</div><div style="flex:1"><div class="svc-row-name">Marketplace â€” Articles divers <span class="tag-soon">7 Avril</span></div><div class="svc-row-desc">Trouvez tout ce dont vous avez besoin : articles mÃ©nagers, Ã©lectronique, fournitures et plus.</div></div><span style="font-size:20px;color:#E8EAF0">â€º</span></button>
        </div>
      </div>
    </div>

    <!-- VUE 1b : Liste des Restaurants -->
    <div id="view-restaurants" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('list')">â†</button>
        <div id="rest-svc-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E3F2FD">ğŸ½ï¸</div>
        <div>
          <div id="rest-svc-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Restaurants</div>
          <div style="font-size:11px;color:#9999BB">Choisissez un restaurant</div>
        </div>
      </div>
      <div class="rst-section-title">ğŸª Nos restaurants partenaires</div>
      <div id="restaurants-list"></div>
    </div>

    <!-- VUE 1c : Liste des Kits/PACKS -->
    <div id="view-kits" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('list')">â†</button>
        <div id="kits-svc-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">ğŸ</div>
        <div>
          <div id="kits-svc-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Kits &amp; PACKS</div>
          <div style="font-size:11px;color:#9999BB">Des ensembles prÃªts Ã  commander</div>
        </div>
      </div>
      <div class="kits-section-title" id="kits-section-title">ğŸ“¦ Nos kits disponibles</div>
      <div id="kits-list"></div>
    </div>

    <!-- VUE 1d : DÃ©tail d'un Kit -->
    <div id="view-kit-detail" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('kits')">â†</button>
        <div id="kit-detail-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">ğŸ</div>
        <div>
          <div id="kit-detail-name" style="font-size:14px;font-weight:700;color:#1A1A2E">Kit</div>
          <div style="font-size:11px;color:#9999BB">DÃ©tail du kit</div>
        </div>
      </div>
      <!-- Hero du kit -->
      <div class="kit-detail-hero" id="kit-hero">
        <div class="kit-detail-hero-name" id="kit-hero-name">â€”</div>
        <div class="kit-detail-hero-desc" id="kit-detail-desc"></div>
        <div class="kit-detail-hero-price-label">Prix total du kit</div>
        <div class="kit-detail-hero-price" id="kit-detail-price">â€”</div>
      </div>
      <!-- Articles du kit -->
      <div class="kit-articles-card">
        <div class="kit-articles-title">ğŸ“‹ Articles inclus dans ce kit</div>
        <div id="kit-detail-items"></div>
      </div>
      <!-- Bouton commander -->
      <button class="kit-order-btn" onclick="commanderKit()">ğŸ›’ Commander ce kit</button>
    </div>

    <!-- VUE 1e : Options d'une catÃ©gorie Immobilier -->
    <div id="view-immo-options" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="immo-options-back-btn" onclick="showView('list')">â†</button>
        <div id="immo-options-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">ğŸ¢</div>
        <div>
          <div id="immo-options-title" style="font-size:14px;font-weight:700;color:#1A1A2E">CatÃ©gorie</div>
          <div style="font-size:11px;color:#9999BB">Choisissez une prestation</div>
        </div>
      </div>
      <div style="padding:8px 16px 4px;font-size:12px;font-weight:800;color:#9999BB;text-transform:uppercase;letter-spacing:.5px">ğŸ¡ Nos prestations disponibles</div>
      <div id="immo-options-list"></div>
    </div>

    <!-- VUE 1f : Formulaire d'une prestation Immobilier -->
    <div id="view-immo-form" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="immo-form-back-btn" onclick="immoFormGoBack()">â†</button>
        <div id="immo-form-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;background:#E8F5E9">ğŸ¢</div>
        <div>
          <div id="immo-form-title" style="font-size:14px;font-weight:700;color:#1A1A2E">Demande</div>
          <div style="font-size:11px;color:#9999BB">Formulaire de demande</div>
        </div>
      </div>
      <div id="immo-form-soon" style="display:none" class="warn-box">
        <div style="font-weight:700;font-size:13px;margin-bottom:3px">â³ BientÃ´t disponible</div>
        <div style="font-size:12px;opacity:.92">OpÃ©rationnel le 07 Avril 2026. Vous pouvez dÃ©jÃ  prÃ©-enregistrer votre demande.</div>
      </div>
      <!-- Hero de la prestation -->
      <div style="margin:0 16px 14px;background:linear-gradient(135deg,#1E6FBE,#155A9C);border-radius:20px;padding:20px 20px;color:#fff;position:relative;overflow:hidden">
        <div style="position:absolute;right:10px;top:50%;transform:translateY(-50%);font-size:60px;opacity:.18" id="immo-form-hero-emoji">ğŸ¢</div>
        <div style="font-size:10px;font-weight:700;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px" id="immo-form-category">Service Immobilier</div>
        <div style="font-size:17px;font-weight:800;font-family:'Nunito',sans-serif;margin-bottom:4px" id="immo-form-prestation-name">Prestation</div>
        <div style="font-size:11px;color:rgba(255,255,255,.75);line-height:1.5" id="immo-form-prestation-desc"></div>
      </div>
      <div class="order-card">
        <div class="order-card-title">ğŸ“‹ Votre demande</div>
        <div id="immo-form-fields">
          <label class="f-label">Description de votre besoin</label>
          <textarea class="f-textarea" rows="4" id="immo-ff-besoin" placeholder="DÃ©crivez votre besoin en dÃ©tail : superficie, budget, localisation souhaitÃ©e, dÃ©lai..."></textarea>
          <label class="f-label" data-immo-loc>Localisation / Quartier souhaitÃ©</label>
          <input type="text" class="f-input" id="immo-ff-localisation" placeholder="Ex : AdidogomÃ©, BÃ¨, Tokoin, AgoÃ¨..."/>
          <label class="f-label" data-immo-budget>Budget estimÃ© <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
          <input type="text" class="f-input" id="immo-ff-budget" placeholder="Ex : 500 000 FCFA/mois ou 15 000 000 FCFA"/>

          <label class="f-label">Date souhaitÃ©e <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
          <input type="date" class="f-input" id="immo-ff-date"/>
          <label class="f-label">Remarques supplÃ©mentaires <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
          <textarea class="f-textarea" rows="2" id="immo-ff-notes" placeholder="PrÃ©cisions additionnelles..."></textarea>
        </div>
        <button class="btn-primary" id="immo-form-submit-btn" onclick="submitImmoForm()">ğŸ“¨ Envoyer ma demande</button>
      </div>
    </div>

    <!-- VUE 2 : Catalogue -->
    <div id="view-catalogue" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="catalogue-back-btn" onclick="showView('list')">â†</button>
        <div id="cat-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0"></div>
        <div>
          <div id="cat-title" style="font-size:14px;font-weight:700;color:#1A1A2E"></div>
          <div style="font-size:11px;color:#9999BB">SÃ©lectionnez vos articles</div>
        </div>
      </div>
      <div id="catalogue-items" class="catalogue-grid"></div>
      <div class="cart-bar" id="cart-bar" style="display:none" onclick="showView('delivery')">
        <div class="cart-bar-left">
          <span class="cart-bar-count" id="cb-count">0 article</span>
          <span class="cart-bar-text">Voir ma commande</span>
        </div>
        <span class="cart-bar-total" id="cb-total">0 FCFA</span>
      </div>
    </div>

    <!-- VUE 3 : Formulaire standard -->
    <div id="view-form" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('list')">â†</button>
        <div id="form-ico" style="width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0"></div>
        <div>
          <div id="form-title" style="font-size:14px;font-weight:700;color:#1A1A2E"></div>
          <div style="font-size:11px;color:#9999BB">Formulaire de demande</div>
        </div>
      </div>
      <div id="form-soon" style="display:none" class="warn-box">
        <div style="font-weight:700;font-size:13px;margin-bottom:3px">â³ BientÃ´t disponible</div>
        <div style="font-size:12px;opacity:.92" id="form-soon-date"></div>
      </div>
      <div class="order-card">
        <div id="form-fields"></div>
        <button class="btn-primary" id="form-submit-btn" onclick="submitStandardForm()">ğŸ“¨ Envoyer ma demande</button>
      </div>
    </div>

    <!-- VUE 4 : Livraison (sans champ tÃ©lÃ©phone) -->
    <div id="view-delivery" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" id="delivery-back-btn" onclick="showView('catalogue')">â†</button>
        <div style="font-size:22px">ğŸ“</div>
        <div>
          <div style="font-size:14px;font-weight:700;color:#1A1A2E">Informations de livraison</div>
          <div style="font-size:11px;color:#9999BB">Ã‰tape 1 sur 2</div>
        </div>
      </div>
      <div class="step-bar">
        <div class="step active"><div class="step-num">1</div><span>Livraison</span></div>
        <div class="step-line"></div>
        <div class="step"><div class="step-num">2</div><span>Paiement</span></div>
      </div>
      <div class="order-card">
        <div class="order-card-title">ğŸ“ Votre position</div>
        <div class="loc-toggle">
          <button class="loc-btn on" id="loc-btn-gps"  onclick="setLocMode('gps')">ğŸ“¡ Par localisation GPS</button>
          <button class="loc-btn"    id="loc-btn-desc" onclick="setLocMode('desc')">âœï¸ Par description</button>
        </div>
        <div id="loc-gps-panel">
          <button class="btn-secondary" id="gps-btn" onclick="getGPS()">ğŸ“¡ Obtenir ma position</button>
          <div id="gps-result" style="margin-top:10px;font-size:12px;color:#4A4A6A;display:none"></div>
        </div>
        <div id="loc-desc-panel" style="display:none">
          <label class="f-label">Description de votre position</label>
          <textarea class="f-textarea" id="del-desc" rows="3" placeholder="Ex : Quartier AdidogomÃ©, derriÃ¨re le marchÃ©, maison bleue avec portail noir..."></textarea>
        </div>
      </div>
      <div class="order-card">
        <div class="order-card-title">ğŸ  Adresse de livraison</div>
        <label class="f-label">Rue / quartier / repÃ¨re</label>
        <input type="text" class="f-input" id="del-address" placeholder="Ex : AdidogomÃ©, rue des Cocotiers"/>
        <label class="f-label">Notes supplÃ©mentaires (optionnel)</label>
        <textarea class="f-textarea" id="del-notes" rows="2" placeholder="Ã‰tage, couleur de la maison..."></textarea>
      </div>
      <button class="btn-primary" onclick="goToPayment()">Continuer â†’ Paiement</button>
    </div>

    <!-- VUE 5 : Paiement -->
    <div id="view-payment" style="display:none">
      <div class="cat-hdr">
        <button class="back-btn" onclick="showView('delivery')">â†</button>
        <div style="font-size:22px">ğŸ’³</div>
        <div>
          <div style="font-size:14px;font-weight:700;color:#1A1A2E">Confirmation &amp; Paiement</div>
          <div style="font-size:11px;color:#9999BB">Ã‰tape 2 sur 2</div>
        </div>
      </div>
      <div class="step-bar">
        <div class="step done"><div class="step-num">âœ“</div><span>Livraison</span></div>
        <div class="step-line done"></div>
        <div class="step active"><div class="step-num">2</div><span>Paiement</span></div>
      </div>
      <div class="order-card">
        <div class="order-card-title">ğŸ›’ Votre commande</div>
        <div id="recap-items"></div>
        <div class="recap-total">
          <span class="recap-total-label">Total</span>
          <span class="recap-total-val" id="recap-total-val">0 FCFA</span>
        </div>
      </div>
      <div class="order-card" style="padding:0;overflow:hidden">
        <div style="padding:16px 18px 12px;font-size:15px;font-weight:700;color:#1A1A2E">ğŸ’³ Mode de paiement</div>
        <button class="pay-opt" id="pay-mixx" onclick="selectPay('mixx')">
          <div class="pay-ico" style="background:#E8F5E9">ğŸ’š</div>
          <div><div class="pay-name">Mixx By Yas</div><div class="pay-sub">Paiement mobile sÃ©curisÃ©</div></div>
          <span class="pay-soon">BientÃ´t</span>
          <div class="pay-radio"></div>
        </button>
        <button class="pay-opt" id="pay-flooz" onclick="selectPay('flooz')">
          <div class="pay-ico" style="background:#FFF3E0">ğŸ§¡</div>
          <div><div class="pay-name">Flooz</div><div class="pay-sub">Paiement mobile Moov</div></div>
          <span class="pay-soon">BientÃ´t</span>
          <div class="pay-radio"></div>
        </button>
        <button class="pay-opt selected" id="pay-livraison" onclick="selectPay('livraison')">
          <div class="pay-ico" style="background:#F3E5F5">ğŸ </div>
          <div><div class="pay-name">Payer Ã  la livraison</div><div class="pay-sub">EspÃ¨ces ou mobile Ã  la rÃ©ception</div></div>
          <div class="pay-radio"></div>
        </button>
      </div>
      <button class="btn-primary" id="confirm-btn" onclick="confirmOrder()">âœ… Confirmer la commande</button>
    </div>

    <!-- VUE 6 : SuccÃ¨s -->
    <div id="view-success" style="display:none">
      <div class="success">
        <div class="succ-emoji">âœ…</div>
        <div class="succ-title">Commande confirmÃ©e !</div>
        <div class="succ-desc" id="succ-msg">Votre commande a Ã©tÃ© reÃ§ue.<br/>Notre Ã©quipe vous contactera trÃ¨s bientÃ´t.</div>
        <div id="succ-redirect-msg" style="font-size:11px;color:#9999BB;margin:8px 0 14px;text-align:center">Redirection vers vos commandes dans <strong id="succ-countdown">3</strong>s...</div>
        <!-- Bouton "Voir mes commandes" â€” affichÃ© aprÃ¨s confirmation -->
        <button id="succ-view-orders-btn" class="btn-primary" style="max-width:300px;margin:0 auto 10px;background:linear-gradient(135deg,#2E7D32,#1B5E20)" onclick="goTab('orders')">ğŸ“¦ Voir mes commandes â†’</button>
        <button class="btn-primary" style="max-width:300px;margin:0 auto;background:#F4F6FA;color:#4A4A6A;box-shadow:none;border:1.5px solid #E8EAF0" onclick="showView('list')">â† Retour aux services</button>
      </div>
    </div>
  </div><!-- /services -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE : COMMANDES (suivi)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="p-orders">
    <div class="orders-page">
      <div class="orders-header">
        <div class="sec-title">Mes Commandes</div>
        <div class="sec-sub">Suivez l'Ã©tat de vos demandes en temps rÃ©el</div>
      </div>
      <!-- Info utilisateur connectÃ© + bouton actualiser -->
      <div class="orders-user-info" id="orders-user-bar" style="display:none">
        <div class="orders-user-avatar" id="orders-user-avatar">ğŸ‘¤</div>
        <div>
          <div class="orders-user-name" id="orders-user-name">â€”</div>
          <div class="orders-user-phone" id="orders-user-phone">â€”</div>
        </div>
        <button class="orders-refresh-btn" onclick="loadMyOrders()">ğŸ”„ Actualiser</button>
      </div>
      <div id="orders-out">
        <div class="orders-empty">
          <div class="orders-empty-ico">ğŸ”</div>
          <div class="orders-empty-title">Connexion requise</div>
          <div class="orders-empty-sub">Connectez-vous pour voir vos commandes et leur historique.</div>
          <button class="btn-primary" style="max-width:220px;margin:20px auto 0" onclick="openAuthModal('login')">Se connecter</button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE : Ã€ PROPOS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="p-about">
    <div style="padding-top:20px">
      <div class="about-hero">
        <div class="about-logo">
          <img src="assets/logo.png" alt="OmniService TG" onerror="this.parentElement.innerHTML='<div style=font-size:50px>ğŸ›¡ï¸</div>'"/>
        </div>
        <div class="about-name"><span class="brand-blue">Omni</span><span class="brand-ora">Service</span> <span class="brand-blue">TG</span></div>
        <div style="font-size:12px;color:var(--light);margin-top:4px">Appelez, on s'en charge</div>
        <div style="overflow:hidden;width:100%;margin-top:6px">
          <div style="display:inline-block;white-space:nowrap;animation:marquee-about 12s linear infinite;font-size:12px;color:var(--mid);font-weight:700">
            ğŸ›ï¸ Entreprise promotrice : StÃ©. ASSISTANCE GLOBALE &nbsp;â€¢&nbsp; 14 ans d'expÃ©rience &nbsp;â€¢&nbsp; ğŸ›ï¸ Entreprise promotrice : StÃ©. ASSISTANCE GLOBALE &nbsp;â€¢&nbsp; 14 ans d'expÃ©rience &nbsp;â€¢&nbsp;
          </div>
        </div>
        <style>@keyframes marquee-about{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}</style>
        <div class="about-flag">ğŸ‡¹ğŸ‡¬ Entreprise togolaise</div>
      </div>
      <div class="a-card" style="background:linear-gradient(135deg,rgba(30,111,190,.03),rgba(245,130,10,.03));border:1px solid rgba(30,111,190,.1)">
        <div class="a-card-title">ğŸš€ Notre Vision</div>
        <p>Construire un Togo oÃ¹ chaque foyer accÃ¨de Ã  des services fiables, modernes et dignes des standards internationaux. OmniService TG vise Ã  devenir une <strong style="color:var(--blue)">rÃ©fÃ©rence nationale</strong> dans le secteur des services professionnels.</p>
      </div>
      <div class="a-card">
        <div class="a-card-title">ğŸ¯ Notre Mission</div>
        <p>Offrir aux mÃ©nages et entreprises togolais des services multisectoriels professionnels, accessibles et structurÃ©s, qui simplifient leur quotidien et valorisent leur cadre de vie.</p>
      </div>
      <div class="sec-title" style="margin-bottom:12px">Nos Valeurs</div>
      <div class="val-row"><div class="val-ico">ğŸ¯</div><div><div class="val-name">Professionnalisme</div><div class="val-desc">Standards Ã©levÃ©s Ã  chaque intervention.</div></div></div>
      <div class="val-row"><div class="val-ico">ğŸ”’</div><div><div class="val-name">FiabilitÃ©</div><div class="val-desc">Vous pouvez compter sur nous.</div></div></div>
      <div class="val-row"><div class="val-ico">ğŸ¤</div><div><div class="val-name">Respect</div><div class="val-desc">De nos clients, Ã©quipes et partenaires.</div></div></div>
      <div class="val-row"><div class="val-ico">ğŸ”</div><div><div class="val-name">Transparence</div><div class="val-desc">Tarifs clairs, pas de surprises.</div></div></div>
      <div class="val-row" style="margin-bottom:18px"><div class="val-ico">â­</div><div><div class="val-name">Excellence</div><div class="val-desc">Toujours le meilleur rÃ©sultat.</div></div></div>
      <div class="who-grid">
        <div class="who-card"><div style="font-size:30px;margin-bottom:9px">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div><div style="font-size:13px;font-weight:700;color:var(--dark);margin-bottom:5px">Particuliers</div><div style="font-size:11px;color:var(--light);line-height:1.5">Familles et propriÃ©taires cherchant un service organisÃ©.</div></div>
        <div class="who-card"><div style="font-size:30px;margin-bottom:9px">ğŸ¢</div><div style="font-size:13px;font-weight:700;color:var(--dark);margin-bottom:5px">Entreprises</div><div style="font-size:11px;color:var(--light);line-height:1.5">Bureaux, commerces, sociÃ©tÃ©s en croissance.</div></div>
      </div>
      <div class="a-card">
        <div class="a-card-title">ğŸ“ Contact</div>
        <div class="ct-row"><div class="ct-ico">ğŸ“</div><span style="font-size:13px;color:var(--mid)">BasÃ© Ã  LomÃ©, Togo</span></div>
        <div class="ct-row"><div class="ct-ico">ğŸ“</div><a href="tel:+22870652222" style="font-size:13px;color:var(--blue);font-weight:600;text-decoration:none">+228 70 65 22 22</a></div>
        <div class="ct-row"><div class="ct-ico">ğŸ“§</div><a href="/cdn-cgi/l/email-protection#3c5f5352485d5f487c535152554f594e4a555f59485b125f5351" style="font-size:13px;color:var(--blue);font-weight:600;text-decoration:none"><span class="__cf_email__" data-cfemail="7f1c10110b1e1c0b3f101211160c1a0d09161c1a0b18511c1012">[email&#160;protected]</span></a></div>
        <div class="ct-row"><div class="ct-ico">ğŸŒ</div><span style="font-size:13px;color:var(--mid)">www.omniservicetg.com</span></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE : PROFIL
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="p-profile">
    <div style="padding-top:20px">
      <div class="prof-hero">
        <!-- Avatar dynamique homme/femme -->
        <div class="avatar" id="prof-avatar">ğŸ‘¤</div>
        <div style="font-family:'Nunito',sans-serif;font-size:22px;font-weight:900;color:#fff" id="prof-name-disp">Mon Profil</div>
        <div style="font-size:12px;color:rgba(255,255,255,.5);margin-top:5px" id="prof-phone-disp">Connectez-vous pour accÃ©der Ã  votre compte</div>
      </div>

      <!-- Carte si NON connectÃ© -->
      <div id="prof-auth-card">
        <div class="auth-card-title">Bienvenue sur OmniService TG !</div>
        <div class="auth-card-sub">Connectez-vous ou crÃ©ez un compte pour passer des commandes, suivre leur statut et gÃ©rer votre profil.</div>
        <div class="btn-row">
          <button class="btn-login" onclick="openAuthModal('login')">Se connecter</button>
          <button class="btn-signup" onclick="openAuthModal('signup')">S'inscrire</button>
        </div>
      </div>

      <!-- Carte si connectÃ© -->
      <div id="prof-logged-card" style="display:none">
        <div class="prof-card">
          <div style="font-size:14px;font-weight:700;color:var(--dark);margin-bottom:14px">âœï¸ Modifier mes informations</div>
          <div class="p-inw"><span class="p-pfx">ğŸ‘¤</span><input type="text" class="p-inp" placeholder="PrÃ©nom" id="pf-prenom"/></div>
          <div class="p-inw"><span class="p-pfx">ğŸ‘¤</span><input type="text" class="p-inp" placeholder="Nom" id="pf-nom"/></div>
          <div class="p-inw"><span class="p-pfx">ğŸ“</span><input type="tel" class="p-inp" placeholder="+228 XX XX XX XX" id="pf-phone"/></div>
          <div class="p-inw"><span class="p-pfx">ğŸ“</span><input type="text" class="p-inp" placeholder="Ville de rÃ©sidence" id="pf-ville"/></div>
          <div class="p-inw" style="margin-bottom:16px"><span class="p-pfx">ğŸ“§</span><input type="email" class="p-inp" placeholder="Email" id="pf-email" readonly style="opacity:.6"/></div>
          <button class="p-save" onclick="saveProfile()">ğŸ’¾ Enregistrer</button>
        </div>
        <div class="menu-list">
          <div class="menu-row" onclick="goTab('orders')"><div class="menu-ico" style="background:#E3F2FD">ğŸ“¦</div><span style="flex:1;font-size:13px;font-weight:600;color:var(--dark)">Mes commandes</span><span style="color:var(--border);font-size:18px">â€º</span></div>
          <div class="menu-row" onclick="openNotifPanel()" style="cursor:pointer"><div class="menu-ico" style="background:#FFF3E0">ğŸ””</div><span style="flex:1;font-size:13px;font-weight:600;color:var(--dark)">Notifications</span><span style="color:var(--border);font-size:18px">â€º</span></div>
          <div class="menu-row" onclick="openPrivacyModal()"><div class="menu-ico" style="background:#E3F2FD">ğŸ”’</div><span style="flex:1;font-size:13px;font-weight:600;color:var(--dark)">ConfidentialitÃ©</span><span style="color:var(--border);font-size:18px">â€º</span></div>
          <div class="menu-row" onclick="doLogout()"><div class="menu-ico" style="background:#FFEBEE">ğŸšª</div><span style="flex:1;font-size:13px;font-weight:600;color:#C62828">Se dÃ©connecter</span><span style="color:var(--border);font-size:18px">â€º</span></div>
        </div>
      </div>

    </div>
  </div>

</div><!-- /app-body -->

<!-- â•â• MODAL POLITIQUE DE CONFIDENTIALITÃ‰ â•â• -->
<div id="privacy-modal" onclick="if(event.target===this)closePrivacyModal()">
  <div class="privacy-box">
    <div class="privacy-header">
      <div class="privacy-title">ğŸ”’ Politique de ConfidentialitÃ©</div>
      <button class="privacy-close" onclick="closePrivacyModal()">âœ•</button>
    </div>
    <div class="privacy-body">

      <!-- Intro -->
      <div style="background:linear-gradient(135deg,#1E6FBE,#155A9C);border-radius:18px;padding:20px;color:#fff;margin-bottom:22px">
        <div style="font-size:28px;margin-bottom:8px">ğŸ›¡ï¸</div>
        <div style="font-family:'Nunito',sans-serif;font-size:16px;font-weight:800;margin-bottom:6px">Vos donnÃ©es sont en sÃ©curitÃ©</div>
        <div style="font-size:12px;color:rgba(255,255,255,.8);line-height:1.6">Chez OmniService TG, la protection de votre vie privÃ©e est une prioritÃ© absolue. Nous nous engageons Ã  ne jamais vendre, louer ou compromettre vos informations personnelles.</div>
      </div>

      <!-- Badges de confiance -->
      <div class="privacy-trust-badges" style="margin-bottom:22px">
        <div class="privacy-badge"><div class="privacy-badge-ico">ğŸ”</div><div class="privacy-badge-label">DonnÃ©es chiffrÃ©es</div><div class="privacy-badge-sub">Stockage sÃ©curisÃ© Firebase</div></div>
        <div class="privacy-badge"><div class="privacy-badge-ico">ğŸš«</div><div class="privacy-badge-label">Jamais revendues</div><div class="privacy-badge-sub">Aucun partage Ã  des tiers</div></div>
        <div class="privacy-badge"><div class="privacy-badge-ico">ğŸ‘ï¸â€ğŸ—¨ï¸</div><div class="privacy-badge-label">Transparence totale</div><div class="privacy-badge-sub">Vous contrÃ´lez vos donnÃ©es</div></div>
        <div class="privacy-badge"><div class="privacy-badge-ico">ğŸ‡¹ğŸ‡¬</div><div class="privacy-badge-label">Entreprise togolaise</div><div class="privacy-badge-sub">StÃ©. ASSISTANCE GLOBALE</div></div>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸ“‹ 1. Qui sommes-nous ?</div>
        <p>OmniService TG est un service dÃ©veloppÃ© et opÃ©rÃ© par la <strong>StÃ©. ASSISTANCE GLOBALE</strong>, entreprise togolaise forte de 14 ans d'expÃ©rience dans les services aux particuliers et aux entreprises. Nous sommes basÃ©s Ã  LomÃ©, Togo.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸ“¦ 2. DonnÃ©es collectÃ©es</div>
        <p>Nous collectons uniquement les informations nÃ©cessaires Ã  la fourniture de nos services : <strong>votre prÃ©nom et nom</strong> pour personnaliser votre expÃ©rience, <strong>votre numÃ©ro de tÃ©lÃ©phone</strong> comme identifiant unique de compte, <strong>votre ville de rÃ©sidence</strong> pour adapter notre offre, et <strong>vos adresses de livraison</strong> pour exÃ©cuter vos commandes. Nous ne collectons jamais de donnÃ©es de paiement directement â€” les transactions sont gÃ©rÃ©es par des opÃ©rateurs certifiÃ©s (Flooz, Mixx by Yas).</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸ¯ 3. Utilisation de vos donnÃ©es</div>
        <p>Vos donnÃ©es sont utilisÃ©es exclusivement pour : traiter et suivre vos commandes, vous contacter concernant l'exÃ©cution de vos services, amÃ©liorer la qualitÃ© de nos prestations et, avec votre accord, vous informer de nos nouvelles offres. <strong>Nous n'utilisons jamais vos donnÃ©es Ã  des fins publicitaires ou de profilage commercial.</strong></p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸ”’ 4. SÃ©curitÃ© & Stockage</div>
        <p>Toutes vos donnÃ©es sont stockÃ©es sur <strong>Firebase (Google Cloud)</strong>, une infrastructure certifiÃ©e et chiffrÃ©e de bout en bout. L'accÃ¨s Ã  vos donnÃ©es est strictement limitÃ© aux membres autorisÃ©s de l'Ã©quipe OmniService TG, qui sont soumis Ã  une obligation de confidentialitÃ©. Aucun tiers commercial n'a accÃ¨s Ã  vos informations personnelles.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">âš–ï¸ 5. Vos droits</div>
        <p>ConformÃ©ment aux principes de protection des donnÃ©es, vous disposez Ã  tout moment du droit de <strong>consulter, modifier ou supprimer</strong> vos informations personnelles depuis votre profil dans l'application. Pour toute demande concernant vos donnÃ©es, contactez-nous directement via WhatsApp ou par e-mail.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸª 6. DonnÃ©es locales (cookies)</div>
        <p>L'application utilise le stockage local de votre navigateur (<em>localStorage</em>) uniquement pour maintenir votre session ouverte entre les visites, Ã©vitant ainsi que vous ayez Ã  vous reconnectez Ã  chaque fois. Aucun cookie tiers ni outil de tracking publicitaire n'est utilisÃ©.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸ”” 7. Notifications</div>
        <p>Si vous acceptez les notifications dans votre navigateur, OmniService TG vous envoie uniquement des alertes utiles concernant l'Ã©tat de vos commandes (passage en cours, commande terminÃ©e). Ces notifications sont gÃ©rÃ©es localement et ne nÃ©cessitent aucun service tiers de tracking.</p>
      </div>

      <div class="privacy-section">
        <div class="privacy-section-title">ğŸ“ 8. Contact & RÃ©clamations</div>
        <p>Pour toute question relative Ã  la confidentialitÃ© de vos donnÃ©es, notre Ã©quipe est disponible 7j/7 :</p>
        <div style="margin-top:12px;display:flex;flex-direction:column;gap:8px">
          <a href="tel:+22870652222" style="display:flex;align-items:center;gap:10px;background:#E3F2FD;border-radius:12px;padding:12px;text-decoration:none">
            <span style="font-size:20px">ğŸ“</span>
            <div><div style="font-size:13px;font-weight:700;color:#1E6FBE">+228 70 65 22 22</div><div style="font-size:11px;color:#9999BB">Appel / WhatsApp</div></div>
          </a>
          <a href="/cdn-cgi/l/email-protection#8fece0e1fbeeecfbcfe0e2e1e6fceafdf9e6eceafbe8a1ece0e2" style="display:flex;align-items:center;gap:10px;background:#FFF3E0;border-radius:12px;padding:12px;text-decoration:none">
            <span style="font-size:20px">ğŸ“§</span>
            <div><div style="font-size:13px;font-weight:700;color:#F5820A"><span class="__cf_email__" data-cfemail="a4c7cbcad0c5c7d0e4cbc9cacdd7c1d6d2cdc7c1d0c38ac7cbc9">[email&#160;protected]</span></div><div style="font-size:11px;color:#9999BB">E-mail</div></div>
          </a>
        </div>
      </div>

      <div style="margin-top:22px;padding:16px;background:#F4F6FA;border-radius:14px;text-align:center">
        <div style="font-size:20px;margin-bottom:6px">ğŸ›ï¸</div>
        <div style="font-size:12px;color:#9999BB;line-height:1.6"><strong style="color:#1A1A2E">StÃ©. ASSISTANCE GLOBALE</strong><br/>14 ans d'expÃ©rience Â· LomÃ©, Togo ğŸ‡¹ğŸ‡¬<br/>Politique en vigueur depuis le 07 Avril 2026</div>
      </div>

    </div>
  </div>
</div>

<!-- â•â• MODAL CONFIRMATION D'ANNULATION â•â• -->
<div id="cancel-order-modal" style="display:none;position:fixed;inset:0;z-index:3500;background:rgba(10,18,32,.75);backdrop-filter:blur(6px);align-items:center;justify-content:center;padding:20px" onclick="if(event.target===this)closeCancelModal()">
  <div style="background:#fff;border-radius:24px;width:100%;max-width:360px;padding:28px 24px;box-shadow:0 30px 80px rgba(0,0,0,.3);text-align:center">
    <div style="width:64px;height:64px;background:#FFEBEE;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 16px">ğŸ—‘ï¸</div>
    <div style="font-family:'Nunito',sans-serif;font-size:18px;font-weight:800;color:#1A1A2E;margin-bottom:8px">Annuler la commande ?</div>
    <div style="font-size:13px;color:#4A4A6A;line-height:1.6;margin-bottom:6px">
      Vous Ãªtes sur le point d'annuler et de supprimer :<br/>
      <strong id="cancel-order-name" style="color:#1A1A2E"></strong>
    </div>
    <div style="font-size:11px;color:#9999BB;margin-bottom:22px">RÃ©f : <strong id="cancel-order-ref"></strong></div>
    <div style="background:#FFF3E0;border-radius:12px;padding:12px;font-size:12px;color:#B45309;margin-bottom:22px;text-align:left">
      âš ï¸ Cette action est <strong>irrÃ©versible</strong>. La suppression n'est possible que si la commande est encore <strong>En attente</strong>.
    </div>
    <div style="display:flex;gap:10px">
      <button onclick="closeCancelModal()" style="flex:1;background:#F4F6FA;border:1.5px solid #E8EAF0;border-radius:14px;padding:14px;font-size:13px;font-weight:700;color:#4A4A6A;cursor:pointer;font-family:'Poppins',sans-serif">Garder</button>
      <button onclick="confirmCancelOrder()" style="flex:1;background:linear-gradient(135deg,#C62828,#B71C1C);border:none;border-radius:14px;padding:14px;font-size:13px;font-weight:700;color:#fff;cursor:pointer;font-family:'Poppins',sans-serif;box-shadow:0 4px 16px rgba(198,40,40,.35)">ğŸ—‘ï¸ Supprimer</button>
    </div>
  </div>
</div>

<!-- â•â• PANNEAU NOTIFICATIONS â•â• -->
<div id="notif-panel" style="display:none;position:fixed;inset:0;z-index:3000;background:rgba(10,18,32,.65);backdrop-filter:blur(4px)" onclick="if(event.target===this)closeNotifPanel()">
  <div style="position:absolute;top:0;right:0;width:min(100vw,380px);height:100%;background:#fff;box-shadow:-8px 0 40px rgba(0,0,0,.18);display:flex;flex-direction:column;animation:slideInRight .25s cubic-bezier(.4,0,.2,1)">
    <div style="background:linear-gradient(135deg,#1E6FBE,#155A9C);padding:20px 20px 18px;display:flex;align-items:center;gap:12px;flex-shrink:0">
      <div style="font-size:24px">ğŸ””</div>
      <div style="flex:1">
        <div style="font-family:'Nunito',sans-serif;font-size:18px;font-weight:800;color:#fff">Notifications</div>
        <div style="font-size:11px;color:rgba(255,255,255,.65);margin-top:2px">Suivi de vos commandes en temps rÃ©el</div>
      </div>
      <button onclick="closeNotifPanel()" style="background:rgba(255,255,255,.15);border:none;color:#fff;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center">âœ•</button>
    </div>
    <div id="notif-list" style="flex:1;overflow-y:auto;padding:16px">
      <div id="notif-empty" style="text-align:center;padding:60px 20px;color:#9999BB">
        <div style="font-size:48px;margin-bottom:14px">ğŸ””</div>
        <div style="font-size:15px;font-weight:700;color:#1A1A2E;margin-bottom:6px">Aucune notification</div>
        <div style="font-size:12px;line-height:1.6">Vous recevrez des alertes ici dÃ¨s que le statut de vos commandes changera.</div>
      </div>
    </div>
    <div style="padding:14px 16px;border-top:1px solid #F0F0F8;flex-shrink:0">
      <button onclick="clearAllNotifs()" style="width:100%;background:#F4F6FA;border:1.5px solid #E8EAF0;border-radius:12px;padding:12px;font-size:12px;font-weight:700;color:#4A4A6A;cursor:pointer;font-family:'Poppins',sans-serif">ğŸ—‘ï¸ Effacer toutes les notifications</button>
    </div>
  </div>
</div>
<style>
@keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }
/* â•â• Override grille services : 2 colonnes mobiles, grandes cases â•â• */
.svc-grid {
  display: grid !important;
  grid-template-columns: repeat(2, 1fr) !important;
  gap: 14px !important;
  padding: 0 4px;
}
.svc-btn {
  background: #fff;
  border: none;
  border-radius: 22px !important;
  padding: 22px 10px 18px !important;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  box-shadow: 0 2px 14px rgba(0,0,0,.09);
  transition: all .22s;
  position: relative;
  min-height: 148px !important;
  justify-content: center;
  width: 100%;
}
.svc-btn:active { transform: scale(.96); }
.svc-ico {
  width: 70px !important;
  height: 70px !important;
  border-radius: 20px !important;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 36px !important;
  box-shadow: 0 3px 10px rgba(0,0,0,.13);
  filter: drop-shadow(0 1px 4px rgba(0,0,0,.10));
}
.svc-lbl {
  font-size: 13px !important;
  font-weight: 800;
  color: #4A4A6A;
  text-align: center;
  line-height: 1.3;
}
.svc-soon {
  position: absolute;
  top: -8px;
  right: -2px;
  background: #F5820A;
  color: #fff;
  font-size: 8px !important;
  font-weight: 800;
  padding: 3px 8px;
  border-radius: 999px;
  line-height: 1.6;
}
@media(min-width: 520px) {
  .svc-grid { grid-template-columns: repeat(3, 1fr) !important; }
}
@media(min-width: 768px) {
  .svc-grid { grid-template-columns: repeat(4, 1fr) !important; }
}

/* â•â• BANDEAU ADCARD â€” image plein fond, textes transparents, CTA en couleur â•â• */

/* Wrapper plus large */
.adband-wrap {
  margin: 0 -4px !important;
}

/* Carte : image couvre tout, hauteur augmentÃ©e */
.adcard {
  position: relative !important;
  overflow: hidden !important;
  border-radius: 18px !important;
  height: 190px !important;
  min-width: 100% !important;
  flex-shrink: 0 !important;
}

/* Image occupe tout le fond */
.adcard-img {
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  overflow: hidden !important;
}

/* DÃ©gradÃ© sombre en bas pour lisibilitÃ© */
.adcard-gradient {
  position: absolute !important;
  inset: 0 !important;
  background: linear-gradient(
    to bottom,
    rgba(0,0,0,.05) 0%,
    rgba(0,0,0,.25) 50%,
    rgba(0,0,0,.72) 100%
  ) !important;
  z-index: 1 !important;
}

/* Emoji dÃ©coratif en filigrane */
.adcard-emoji-bg {
  font-size: 110px !important;
  opacity: .18 !important;
  position: absolute !important;
  right: -10px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  z-index: 0 !important;
  user-select: none !important;
}

/* Badge en haut Ã  gauche */
.adcard-badge {
  position: absolute !important;
  top: 12px !important;
  left: 12px !important;
  z-index: 10 !important;
  background: rgba(255,255,255,.9) !important;
  border-radius: 999px !important;
  padding: 4px 11px !important;
  font-size: 9px !important;
  font-weight: 800 !important;
  letter-spacing: .2px !important;
}

/* Corps du texte : en bas sur fond transparent */
.adcard-body {
  position: absolute !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  z-index: 5 !important;
  padding: 10px 14px 12px !important;
  background: transparent !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 2px !important;
}

/* Promo label */
.adcard-promo {
  font-size: 8px !important;
  font-weight: 800 !important;
  letter-spacing: 1.2px !important;
  color: rgba(255,255,255,.7) !important;
  text-transform: uppercase !important;
}

/* Titre blanc, lisible sur le dÃ©gradÃ© */
.adcard-title {
  font-size: 16px !important;
  font-weight: 900 !important;
  color: #fff !important;
  line-height: 1.2 !important;
  text-shadow: 0 1px 4px rgba(0,0,0,.4) !important;
}

/* Sous-titre semi-transparent */
.adcard-sub {
  font-size: 11px !important;
  color: rgba(255,255,255,.8) !important;
  line-height: 1.35 !important;
}

/* CTA sur fond couleur (pas transparent) */
.adcard-cta {
  margin-top: 7px !important;
  align-self: flex-start !important;
  background: #F5820A !important;
  color: #fff !important;
  border-radius: 999px !important;
  padding: 6px 16px !important;
  font-size: 11px !important;
  font-weight: 700 !important;
  font-family: 'Poppins', sans-serif !important;
  box-shadow: 0 2px 8px rgba(245,130,10,.4) !important;
  display: inline-block !important;
}

/* â•â• ADBAND TRACK â€” pleine largeur â•â• */
.adband-wrap {
  width: 100% !important;
  padding: 0 !important;
  margin: 0 0 12px !important;
  overflow: hidden !important;
}
.adband-track {
  display: flex !important;
  overflow-x: hidden !important;
  scroll-snap-type: x mandatory !important;
}
.adband-track .adcard {
  min-width: 100% !important;
  scroll-snap-align: start !important;
  flex-shrink: 0 !important;
  border-radius: 16px !important;
}
/* Notification item */
.notif-item {
  background: #fff;
  border: 1.5px solid #F0F0F8;
  border-radius: 14px;
  padding: 14px 15px;
  margin-bottom: 10px;
  display: flex;
  align-items: flex-start;
  gap: 12px;
  position: relative;
  cursor: pointer;
  transition: all .15s;
}
.notif-item:hover { box-shadow: 0 4px 16px rgba(30,111,190,.1); border-color: #1E6FBE; }
.notif-item.unread { border-color: #1E6FBE; background: #F0F7FF; }
.notif-item.unread::before { content:''; position:absolute; top:12px; right:12px; width:8px; height:8px; background:#1E6FBE; border-radius:50%; }
.notif-ico { width:40px; height:40px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0; }
.notif-title { font-size:13px; font-weight:700; color:#1A1A2E; margin-bottom:3px; }
.notif-sub { font-size:11px; color:#4A4A6A; line-height:1.5; }
.notif-time { font-size:10px; color:#9999BB; margin-top:4px; }
/* Cloche badge */
#notif-badge {
  position:absolute;top:4px;right:4px;
  background:#C62828;color:#fff;
  font-size:9px;font-weight:800;
  min-width:16px;height:16px;
  border-radius:999px;
  align-items:center;justify-content:center;
  padding:0 3px;line-height:1;
}
/* Bouton suppression commande */
.o-delete-btn {
  width: 100%;
  background: transparent;
  border: 1.5px solid #FFCDD2;
  border-radius: 12px;
  padding: 11px 14px;
  font-size: 12px;
  font-weight: 700;
  color: #C62828;
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: all .2s;
}
.o-delete-btn:hover {
  background: #FFEBEE;
  border-color: #C62828;
  box-shadow: 0 2px 12px rgba(198,40,40,.15);
}
/* Privacy modal */
#privacy-modal{
  display:none;position:fixed;inset:0;z-index:2500;
  background:rgba(10,18,32,.75);backdrop-filter:blur(6px);
  align-items:center;justify-content:center;padding:16px;overflow-y:auto;
}
.privacy-box{
  background:#fff;border-radius:24px;width:100%;max-width:520px;
  box-shadow:0 30px 80px rgba(0,0,0,.3);max-height:90vh;
  display:flex;flex-direction:column;
}
.privacy-header{
  background:linear-gradient(135deg,#1E6FBE,#155A9C);
  padding:20px 22px;display:flex;align-items:center;justify-content:space-between;
  border-radius:24px 24px 0 0;flex-shrink:0;
}
.privacy-title{font-family:'Nunito',sans-serif;font-size:17px;font-weight:800;color:#fff}
.privacy-close{background:rgba(255,255,255,.15);border:none;color:#fff;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center}
.privacy-body{padding:20px 22px;overflow-y:auto;flex:1}
.privacy-section{margin-bottom:18px}
.privacy-section-title{font-size:13px;font-weight:800;color:#1A1A2E;margin-bottom:8px}
.privacy-section p{font-size:12px;color:#4A4A6A;line-height:1.7;margin:0}
.privacy-trust-badges{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.privacy-badge{background:#F4F6FA;border-radius:14px;padding:12px;text-align:center}
.privacy-badge-ico{font-size:22px;margin-bottom:4px}
.privacy-badge-label{font-size:11px;font-weight:700;color:#1A1A2E}
.privacy-badge-sub{font-size:10px;color:#9999BB;margin-top:2px}
</style>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Bottom Nav -->
<nav class="botnav">
  <button class="btab on" id="t-home"     onclick="goTab('home')">    <div class="btab-ico">ğŸ </div><span class="btab-lbl">Accueil</span></button>
  <button class="btab"    id="t-services" onclick="goTab('services')"><div class="btab-ico">ğŸ› ï¸</div><span class="btab-lbl">Services</span></button>
  <button class="btab"    id="t-orders"   onclick="goTab('orders')">  <div class="btab-ico">ğŸ“¦</div><span class="btab-lbl">Commandes</span></button>
  <button class="btab"    id="t-about"    onclick="goTab('about')">   <div class="btab-ico">â„¹ï¸</div><span class="btab-lbl">Ã€ propos</span></button>
</nav>

<!-- Script principal -->
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="module" src="app.js"></script>
<script>
/* â•â• PATCH : Nouveaux services + Immobilier restructurÃ© â•â• */

// DonnÃ©es Immobilier â€” 4 sous-services
const IMMO_ENVELOPE = {
  id: 'immobilier',
  name: 'Service Immobilier',
  emoji: 'ğŸ¢',
  color: '#E8F5E9',
  subServices: [
    {
      id: 'immo_vendre',
      name: 'Ã€ Vendre',
      emoji: 'ğŸ¡',
      color: '#E8F5E9',
      type: 'catalogue', // comme Alimentation : grille d'articles
      desc: 'Biens immobiliers disponibles Ã  la vente',
      items: [
        { name: 'Villa 4 ch + S Ã  AgoÃ¨', price: 200000000, unit: 'FCFA', emoji: 'ğŸ¡', desc: '4 chambres, salon, cuisine Ã©quipÃ©e, clÃ´turÃ©e' },
        { name: 'Terrain 600mÂ² (1 lot) Ã  BÃ¨', price: 100000000, unit: 'FCFA', emoji: 'ğŸŒ', desc: 'Titre foncier disponible, bien localisÃ©' },
      ]
    },
    {
      id: 'immo_louer',
      name: 'Ã€ Louer',
      emoji: 'ğŸ”‘',
      color: '#E3F2FD',
      type: 'catalogue', // comme Alimentation : grille d'articles
      desc: 'Biens immobiliers disponibles Ã  la location',
      items: [
        { name: 'Appartement 2 Ch + S Ã  Sagbado', price: 65000, unit: 'FCFA/mois', emoji: 'ğŸ ', desc: '2 chambres, salon, sanitaires' },
        { name: 'Villa 4 Ch + S Ã  AgoÃ¨', price: 200000, unit: 'FCFA/mois', emoji: 'ğŸ¡', desc: '4 chambres, salon, cuisine, garage' },
        { name: 'Bureau', price: 0, unit: 'Sur devis', emoji: 'ğŸ¢', desc: 'Espaces bureaux professionnels disponibles' },
        { name: 'Espace commercial', price: 0, unit: 'Sur devis', emoji: 'ğŸª', desc: 'Boutiques et locaux commerciaux' },
        { name: 'EntrepÃ´t', price: 0, unit: 'Sur devis', emoji: 'ğŸ­', desc: 'EntrepÃ´ts de diverses capacitÃ©s' },
      ]
    },
    {
      id: 'immo_assistance',
      name: 'Assistance ImmobiliÃ¨re',
      emoji: 'ğŸ¤',
      color: '#EDE7F6',
      type: 'selection',
      desc: 'Services d\'assistance et d\'accompagnement immobilier',
      options: [
        { id: 'terrain_sec',   label: 'Recherche de terrain sÃ©curisÃ©',                      emoji: 'ğŸ—ºï¸', desc: 'Identification et vÃ©rification de terrains selon vos critÃ¨res' },
        { id: 'recherche_bien',label: 'Recherche de Villa / Appartement / Bureau / Magasin', emoji: 'ğŸ”', desc: 'Recherche personnalisÃ©e du bien adaptÃ© Ã  vos besoins' },
        { id: 'supervision',   label: 'Suivi et Supervision de construction / chantier',     emoji: 'ğŸ—ï¸', desc: 'Suivi et supervision de vos travaux de construction' },
        { id: 'titres',        label: 'VÃ©rification de titres fonciers',                     emoji: 'ğŸ“œ', desc: 'ContrÃ´le et validation des documents de propriÃ©tÃ©' },
        { id: 'juridique',     label: 'Accompagnement juridique',                            emoji: 'âš–ï¸', desc: 'Aide aux dÃ©marches lÃ©gales et contrats immobiliers' },
        { id: 'loyers',        label: 'Encaissement des loyers / Suivi des locataires',      emoji: 'ğŸ’µ', desc: 'Gestion locative, suivi des paiements et des locataires' },
      ]
    },
    {
      id: 'immo_gestion',
      name: 'Gestion Locative',
      emoji: 'ğŸ›ï¸',
      color: '#FFF3E0',
      type: 'selection',
      desc: 'Gestion locative complÃ¨te de votre bien immobilier',
      options: [
        { id: 'appartement', label: 'Appartement',        emoji: 'ğŸ ', desc: 'Studio, F1, F2, F3 et plus' },
        { id: 'villa',       label: 'Villa',              emoji: 'ğŸ¡', desc: 'Maison individuelle, villa' },
        { id: 'bureau',      label: 'Bureau / Local',     emoji: 'ğŸ¢', desc: 'Bureau, open-space, local professionnel' },
        { id: 'magasin',     label: 'Commerce / Magasin', emoji: 'ğŸª', desc: 'Boutique, magasin, local commercial' },
        { id: 'terrain',     label: 'Terrain',            emoji: 'ğŸŒ', desc: 'Parcelle, terrain nu ou viabilisÃ©' },
        { id: 'entrepot',    label: 'EntrepÃ´t',           emoji: 'ğŸ­', desc: 'Stockage, entrepÃ´t, hangar' },
      ]
    },
  ]
};

// DonnÃ©es Traiteur
const TRAITEUR_DATA = {
  id: 'traiteur',
  name: 'Service Traiteur',
  emoji: 'ğŸ½ï¸',
  color: '#FFF8E1',
  type: 'form',
  desc: 'Repas prÃ©parÃ©s pour vos Ã©vÃ©nements',
  options: [
    { id: 'anniversaire', label: 'Anniversaire', emoji: 'ğŸ‚' },
    { id: 'fete_famille', label: 'FÃªte de famille', emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' },
    { id: 'mariage', label: 'Mariage / CÃ©rÃ©monie', emoji: 'ğŸ’' },
    { id: 'bapteme', label: 'BaptÃªme / Communion', emoji: 'ğŸ•Šï¸' },
    { id: 'evenement_entreprise', label: 'Ã‰vÃ©nement d\'entreprise', emoji: 'ğŸ¢' },
    { id: 'fete_nationale', label: 'FÃªte nationale / Culturelle', emoji: 'ğŸ‰' },
    { id: 'autre', label: 'Autre Ã©vÃ©nement', emoji: 'ğŸŠ' },
  ]
};

// DonnÃ©es Omni Drink TG
const OMNI_DRINK_DATA = {
  id: 'omni_drink',
  name: 'Omni Drink TG',
  emoji: 'ğŸ¾',
  color: '#E0F7FA',
  type: 'catalogue',
  desc: 'Boissons fraÃ®ches livrÃ©es chez vous',
  items: [
    { name: 'Eau minÃ©rale (casier 24Ã—50cl)', price: 3500, unit: 'FCFA', emoji: 'ğŸ’§', desc: 'Eau minÃ©rale pure, casier de 24 bouteilles' },
    { name: 'Jus de fruits naturels (1L)', price: 1500, unit: 'FCFA', emoji: 'ğŸŠ', desc: 'Jus frais sans conservateurs : orange, ananas, bissap...' },
    { name: 'Sodas assortis (casier 24)', price: 9000, unit: 'FCFA', emoji: 'ğŸ¥¤', desc: 'Coca-Cola, Fanta, Sprite et autres' },
    { name: 'BiÃ¨res locales (casier 24)', price: 14000, unit: 'FCFA', emoji: 'ğŸº', desc: 'Awooyo, Castel, Flag et autres biÃ¨res du Togo' },
    { name: 'Vin de palme (5L)', price: 4000, unit: 'FCFA', emoji: 'ğŸŒ´', desc: 'Vin de palme artisanal frais, production locale' },
    { name: 'Pack Ã©vÃ©nement boissons', price: 45000, unit: 'FCFA', emoji: 'ğŸ‰', desc: 'Assortiment complet pour 50 personnes' },
  ]
};

// DonnÃ©es Marketplace
const MARKETPLACE_DATA = {
  id: 'marketplace',
  name: 'Marketplace â€” Articles divers',
  emoji: 'ğŸ›ï¸',
  color: '#FCE4EC',
  type: 'catalogue',
  desc: 'Tous vos articles livrÃ©s Ã  domicile',
  items: [
    { name: 'Articles mÃ©nagers', price: 0, unit: 'Sur devis', emoji: 'ğŸ ', desc: 'Ustensiles, vaisselle, electromÃ©nager petit format' },
    { name: 'Fournitures de bureau', price: 0, unit: 'Sur devis', emoji: 'âœï¸', desc: 'Papeterie, classeurs, stylos, cartouches...' },
    { name: 'Produits d\'hygiÃ¨ne & beautÃ©', price: 0, unit: 'Sur devis', emoji: 'ğŸ§´', desc: 'Savons, shampooings, produits de soin' },
    { name: 'Ã‰lectronique & Accessoires', price: 0, unit: 'Sur devis', emoji: 'ğŸ“±', desc: 'CÃ¢bles, batteries, accessoires informatiques' },
    { name: 'Jouets & Articles enfants', price: 0, unit: 'Sur devis', emoji: 'ğŸ§¸', desc: 'Jouets, fournitures scolaires, articles bÃ©bÃ©' },
    { name: 'Article personnalisÃ©', price: 0, unit: 'Sur devis', emoji: 'ğŸ›’', desc: 'Dites-nous ce que vous cherchez, on le trouve!' },
  ]
};

// â•â• VUE IMMO ENVELOPE â•â• 
// Nouvelle vue : enveloppe Immobilier avec 4 options (style service principal)
function renderImmoEnvelope() {
  const container = document.getElementById('immo-options-list');
  if (!container) return;
  
  // Mettre Ã  jour le header
  const titleEl = document.getElementById('immo-options-title');
  const icoEl = document.getElementById('immo-options-ico');
  if (titleEl) titleEl.textContent = 'Service Immobilier';
  if (icoEl) icoEl.textContent = 'ğŸ¢';

  container.innerHTML = IMMO_ENVELOPE.subServices.map(sub => `
    <button class="svc-row" style="margin:0 16px 12px;display:flex;align-items:center;gap:14px;background:#fff;border-radius:18px;padding:14px 16px;box-shadow:0 2px 12px rgba(0,0,0,.08);cursor:pointer;border:none;width:calc(100% - 32px);transition:transform .15s;" 
      onclick="openImmoSubService('${sub.id}')">
      <div style="width:44px;height:44px;border-radius:12px;background:${sub.color};display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">${sub.emoji}</div>
      <div style="flex:1;text-align:left">
        <div style="font-size:14px;font-weight:700;color:#1A1A2E;margin-bottom:3px">${sub.name}</div>
        <div style="font-size:11px;color:#9999BB">${sub.desc}</div>
      </div>
      <span style="font-size:20px;color:#E8EAF0">â€º</span>
    </button>
  `).join('');
}

// Ouvrir un sous-service immobilier
function openImmoSubService(subId) {
  const sub = IMMO_ENVELOPE.subServices.find(s => s.id === subId);
  if (!sub) return;
  
  if (sub.type === 'catalogue') {
    renderImmoSubCatalogue(sub);
  } else if (sub.type === 'selection') {
    renderImmoSelection(sub);
  } else if (sub.type === 'kits') {
    renderImmoAssistance(sub);
  } else if (sub.type === 'form') {
    renderImmoGestion(sub);
  }
}

// â•â• Catalogue Immobilier (Ã€ Vendre / Ã€ Louer) â€” mÃªme design qu'Alimentation â•â•
let _immoCartItems = [];
let _immoCurrentSub = null;

function renderImmoSubCatalogue(sub) {
  _immoCurrentSub = sub;

  // Utiliser view-catalogue existant comme Alimentation
  const catTitle = document.getElementById('cat-title');
  const catIco = document.getElementById('cat-ico');
  const catItems = document.getElementById('catalogue-items');
  const backBtn = document.getElementById('catalogue-back-btn');
  const cartBar = document.getElementById('cart-bar');

  if (catTitle) catTitle.textContent = sub.name;
  if (catIco) { catIco.textContent = sub.emoji; catIco.style.background = sub.color; }
  if (backBtn) backBtn.onclick = () => showView('immo-options');

  // Convertir les items en format article compatible avec renderArticleCard
  // Pour immo : le "+" ouvre le formulaire immo au lieu de la livraison
  if (catItems) {
    catItems.innerHTML = sub.items.map((item, i) => {
      const id = `immo_${sub.id}_${i}`;
      const priceStr = item.price > 0
        ? Number(item.price).toLocaleString('fr-FR') + ' FCFA'
        : item.unit;
      const unitStr = item.price > 0 ? '' : '';
      return `
      <div class="article-card" id="acard-${id}">
        <div class="art-img-wrap" style="background:${sub.color};display:flex;align-items:center;justify-content:center;font-size:44px">
          ${item.emoji}
        </div>
        <div class="art-check">âœ“</div>
        <div class="art-body">
          <div class="art-name">${item.name}</div>
          <div class="art-desc">${item.desc}</div>
          <div class="art-footer">
            <div>
              <span class="art-price">${priceStr}</span>
              ${item.price > 0 ? `<span class="art-price-unit">/ ${item.unit}</span>` : ''}
            </div>
            <button class="art-add" onclick="addImmoItem(${i})" title="Faire une demande">â†’</button>
          </div>
        </div>
      </div>`;
    }).join('');
  }

  // Cacher la cart-bar (immo va vers formulaire, pas livraison)
  if (cartBar) cartBar.style.display = 'none';
  showView('catalogue');
}

function addImmoItem(idx) {
  const item = _immoCurrentSub.items[idx];
  const subId = _immoCurrentSub.id;
  
  // Pour Ã€ vendre (immo_vendre) et Ã€ Louer (immo_louer) : masquer localisation et budget
  const isVenteOuLocation = subId === 'immo_vendre' || subId === 'immo_louer';
  
  const nameEl = document.getElementById('immo-form-prestation-name');
  const descEl = document.getElementById('immo-form-prestation-desc');
  const catEl = document.getElementById('immo-form-category');
  const heroEmoji = document.getElementById('immo-form-hero-emoji');
  const formTitle = document.getElementById('immo-form-title');
  const backBtn2 = document.getElementById('immo-form-back-btn');
  const besoin = document.getElementById('immo-ff-besoin');
  
  // Masquer/afficher les champs selon le sous-service
  const locRow = document.getElementById('immo-ff-localisation')?.closest('.f-row') || 
                  (() => {
                    const el = document.getElementById('immo-ff-localisation');
                    return el ? el.parentNode.querySelector('label[for="immo-ff-localisation"], label + #immo-ff-localisation') : null;
                  })();
  
  setImmoFormFieldsVisibility(isVenteOuLocation ? 'vente-location' : 'default');
  
  if (nameEl) nameEl.textContent = item.name;
  if (descEl) descEl.textContent = item.desc;
  if (catEl) catEl.textContent = _immoCurrentSub.name;
  if (heroEmoji) heroEmoji.textContent = item.emoji;
  if (formTitle) formTitle.textContent = item.name;
  if (backBtn2) backBtn2.onclick = () => showView('catalogue');
  if (besoin) besoin.placeholder = `Je suis intÃ©ressÃ©(e) par : ${item.name}. PrÃ©cisez vos souhaits...`;
  
  const soonBox = document.getElementById('immo-form-soon');
  if (soonBox) soonBox.style.display = 'block';
  
  showView('immo-form');
}

// â•â• GESTION DYNAMIQUE DU BOUTON RETOUR FORMULAIRE IMMO â•â•
let _immoFormBackFn = null;
function immoFormGoBack() {
  if (typeof _immoFormBackFn === 'function') { _immoFormBackFn(); }
  else { showView('immo-options'); }
}
window.immoFormGoBack = immoFormGoBack;

// â•â• SÃ©lection de type (Gestion Locative & Assistance ImmobiliÃ¨re) â•â•
// DIRECT : affiche le formulaire avec un <select> dÃ©roulant en premier champ
function renderImmoSelection(sub) {
  const isGestion = sub.id === 'immo_gestion';

  // â”€â”€ Mettre Ã  jour le header du formulaire â”€â”€
  const icoEl     = document.getElementById('immo-form-ico');
  const titleEl   = document.getElementById('immo-form-title');
  const heroEmoji = document.getElementById('immo-form-hero-emoji');
  const catEl     = document.getElementById('immo-form-category');
  const nameEl    = document.getElementById('immo-form-prestation-name');
  const descEl    = document.getElementById('immo-form-prestation-desc');
  const backBtn   = document.getElementById('immo-form-back-btn');
  const soonBox   = document.getElementById('immo-form-soon');

  if (icoEl)     { icoEl.textContent = sub.emoji; icoEl.style.background = sub.color; }
  if (titleEl)   titleEl.textContent = sub.name;
  if (heroEmoji) heroEmoji.textContent = sub.emoji;
  if (catEl)     catEl.textContent = sub.name;
  if (nameEl)    nameEl.textContent = isGestion ? 'SÃ©lectionnez le type de bien' : 'SÃ©lectionnez une prestation';
  if (descEl)    descEl.textContent = sub.desc || '';
  if (soonBox)   soonBox.style.display = 'block';

  // Bouton retour â†’ revenir Ã  l'enveloppe immobilier
  _immoFormBackFn = () => { renderImmoEnvelope(); showView('immo-options'); };

  // â”€â”€ Construire le select et les champs â”€â”€
  const labelSelect = isGestion ? 'TYPE DE BIEN *' : 'TYPE DE PRESTATION *';
  const placeholder = isGestion
    ? 'DÃ©crivez votre bien : adresse, superficie, loyer actuel, vos attentes...'
    : 'DÃ©crivez votre besoin en dÃ©tail...';

  const selectOpts = sub.options.map((opt, i) =>
    `<option value="${i}">${opt.emoji} ${opt.label}</option>`
  ).join('');

  const fieldsEl = document.getElementById('immo-form-fields');
  if (fieldsEl) {
    // RÃ©initialiser le HTML des champs avec le select en premier
    fieldsEl.innerHTML = `
      <label class="f-label">${labelSelect}</label>
      <select class="f-select" id="immo-ff-type-select" onchange="onImmoTypeSelectChange('${sub.id}', this.value)">
        <option value="">â€” SÃ©lectionnez â€”</option>
        ${selectOpts}
      </select>
      <label class="f-label" style="margin-top:14px">Description de votre besoin *</label>
      <textarea class="f-textarea" rows="4" id="immo-ff-besoin" placeholder="${placeholder}"></textarea>
      <label class="f-label" data-immo-loc>Localisation / Quartier</label>
      <input type="text" class="f-input" id="immo-ff-localisation" placeholder="Ex : AdidogomÃ©, BÃ¨, Tokoin, AgoÃ¨..."/>
      <label class="f-label" data-immo-budget>Budget estimÃ© <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
      <input type="text" class="f-input" id="immo-ff-budget" placeholder="Ex : 500 000 FCFA/mois"/>
      <label class="f-label">Date souhaitÃ©e <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
      <input type="date" class="f-input" id="immo-ff-date"/>
      <label class="f-label">Remarques <span style="font-weight:400;font-size:10px;color:#C5C5D8;text-transform:none">(optionnel)</span></label>
      <textarea class="f-textarea" rows="2" id="immo-ff-notes" placeholder="PrÃ©cisions additionnelles..."></textarea>
    `;
  }

  // Stocker le sub courant pour la soumission
  window._immoCurrentSelectionSub = sub;
  window._immoCurrentSelectionOpt = null;

  showView('immo-form');
}

// â”€â”€ Callback quand l'utilisateur choisit dans le select â”€â”€
function onImmoTypeSelectChange(subId, val) {
  const sub = IMMO_ENVELOPE.subServices.find(s => s.id === subId);
  if (!sub) return;
  const idx = parseInt(val, 10);
  if (isNaN(idx) || idx < 0) {
    window._immoCurrentSelectionOpt = null;
    const nameEl = document.getElementById('immo-form-prestation-name');
    const heroEmoji = document.getElementById('immo-form-hero-emoji');
    const icoEl = document.getElementById('immo-form-ico');
    if (nameEl) nameEl.textContent = sub.id === 'immo_gestion' ? 'SÃ©lectionnez le type de bien' : 'SÃ©lectionnez une prestation';
    if (heroEmoji) heroEmoji.textContent = sub.emoji;
    if (icoEl) icoEl.textContent = sub.emoji;
    return;
  }
  const opt = sub.options[idx];
  if (!opt) return;

  window._immoCurrentSelectionOpt = { subId, optIdx: idx, opt, sub };

  // Mettre Ã  jour le hero dynamiquement
  const nameEl    = document.getElementById('immo-form-prestation-name');
  const descEl    = document.getElementById('immo-form-prestation-desc');
  const heroEmoji = document.getElementById('immo-form-hero-emoji');
  const icoEl     = document.getElementById('immo-form-ico');
  const besoin    = document.getElementById('immo-ff-besoin');

  if (nameEl)    nameEl.textContent    = sub.id === 'immo_gestion' ? 'Gestion de : ' + opt.label : opt.label;
  if (descEl)    descEl.textContent    = opt.desc || sub.desc;
  if (heroEmoji) heroEmoji.textContent = opt.emoji;
  if (icoEl)     icoEl.textContent     = opt.emoji;

  if (besoin) {
    besoin.placeholder = sub.id === 'immo_gestion'
      ? `DÃ©crivez votre ${opt.label.toLowerCase()} : adresse, superficie, loyer actuel, vos attentes...`
      : `DÃ©crivez votre besoin pour : ${opt.label}...`;
  }

  setImmoFormFieldsVisibility(sub.id === 'immo_gestion' ? 'gestion' : 'default');
}
window.onImmoTypeSelectChange = onImmoTypeSelectChange;

function openImmoSelectionForm(subId, optIdx) {
  // ConservÃ© pour compatibilitÃ© â€” redirige vers renderImmoSelection
  const sub = IMMO_ENVELOPE.subServices.find(s => s.id === subId);
  if (sub) renderImmoSelection(sub);
}
window.openImmoSelectionForm = openImmoSelectionForm;

// â•â• Assistance ImmobiliÃ¨re legacy (conservÃ© pour compatibilitÃ©) â•â•
function renderImmoAssistance(sub) { renderImmoSelection(sub); }

// â•â• Gestion Locative legacy (conservÃ© pour compatibilitÃ©) â•â•
function renderImmoGestion(sub) { renderImmoSelection(sub); }

// â•â• Helper : contrÃ´le visibilitÃ© champs formulaire immo â•â•
function setImmoFormFieldsVisibility(mode) {
  // mode: 'vente-location' | 'gestion' | 'default'
  const locLabel  = document.querySelector('label[data-immo-loc]');
  const locInput  = document.getElementById('immo-ff-localisation');
  const budgetLabel = document.querySelector('label[data-immo-budget]');
  const budgetInput = document.getElementById('immo-ff-budget');
  
  if (!locLabel || !locInput) return;
  
  if (mode === 'vente-location') {
    // Ã€ vendre / Ã€ Louer : masquer localisation ET budget
    locLabel.style.display = 'none';
    locInput.style.display = 'none';
    if (budgetLabel) budgetLabel.style.display = 'none';
    if (budgetInput) budgetInput.style.display = 'none';
  } else if (mode === 'gestion') {
    // Votre PropriÃ©tÃ© Notre Gestion : label "Quartier de votre propriÃ©tÃ©", budget visible
    locLabel.style.display = '';
    locInput.style.display = '';
    locLabel.childNodes[0].textContent = 'Quartier de votre propriÃ©tÃ©';
    locInput.placeholder = 'Ex : AdidogomÃ©, BÃ¨, Tokoin, AgoÃ¨...';
    if (budgetLabel) budgetLabel.style.display = '';
    if (budgetInput) budgetInput.style.display = '';
  } else {
    // Default (Assistance) : tout visible
    locLabel.style.display = '';
    locInput.style.display = '';
    locLabel.childNodes[0].textContent = 'Localisation / Quartier souhaitÃ©';
    locInput.placeholder = 'Ex : AdidogomÃ©, BÃ¨, Tokoin, AgoÃ¨...';
    if (budgetLabel) budgetLabel.style.display = '';
    if (budgetInput) budgetInput.style.display = '';
  }
}
window.setImmoFormFieldsVisibility = setImmoFormFieldsVisibility;
window.addEventListener('load', () => {
  // â”€â”€ Gestionnaire de liens bandeaux (openService:xxx ou https://...) â”€â”€
  window.handleBandeauLien = function(lien) {
    if (!lien) return;
    if (lien.startsWith('openService:')) {
      const svcId = lien.replace('openService:', '').trim();
      if (window.openService) window.openService(svcId);
    } else if (lien.startsWith('http')) {
      window.open(lien, '_blank');
    }
  };

  // Patcher openService aprÃ¨s chargement de app.js
  setTimeout(() => {
    const _origOpen = window.openService;
    window.openService = function(id) {
      if (id === 'immobilier') {
        // Aller vers la vue immo-options et rendre l'enveloppe
        goTab('services');
        setTimeout(() => {
          renderImmoEnvelope();
          showView('immo-options');
        }, 50);
        return;
      }
      if (id === 'traiteur') {
        openTraiteur();
        return;
      }
      // omni_drink et marketplace sont gÃ©rÃ©s nativement par app.js (CATALOGUE_SERVICES)
      if (_origOpen) _origOpen(id);
    };
  }, 500);
});

// â•â• Service Traiteur â•â•
function openTraiteur() {
  goTab('services');
  setTimeout(() => {
    // Utiliser view-form avec champs personnalisÃ©s
    const titleEl = document.getElementById('form-title');
    const icoEl = document.getElementById('form-ico');
    const fieldsEl = document.getElementById('form-fields');
    const soonEl = document.getElementById('form-soon');
    const soonDate = document.getElementById('form-soon-date');
    
    if (titleEl) titleEl.textContent = 'Service Traiteur';
    if (icoEl) { icoEl.textContent = 'ğŸ½ï¸'; icoEl.style.background = '#FFF8E1'; }
    if (soonEl) soonEl.style.display = 'block';
    if (soonDate) soonDate.textContent = 'OpÃ©rationnel le 07 Avril 2026. PrÃ©-enregistrez votre demande dÃ¨s maintenant.';
    
    if (fieldsEl) {
      fieldsEl.innerHTML = `
        <div class="order-card-title">ğŸ½ï¸ Votre Ã©vÃ©nement</div>
        <label class="f-label">Type d'Ã©vÃ©nement *</label>
        <select class="f-input" id="traiteur-type">
          <option value="">â€” SÃ©lectionnez â€”</option>
          ${TRAITEUR_DATA.options.map(o => `<option value="${o.id}">${o.emoji} ${o.label}</option>`).join('')}
        </select>
        <label class="f-label">Description de l'Ã©vÃ©nement *</label>
        <textarea class="f-textarea" rows="4" id="traiteur-desc" placeholder="Date, heure, lieu, thÃ¨me, nombre de personnes attendues, type de repas souhaitÃ©..."></textarea>
        <label class="f-label">Nombre de personnes *</label>
        <input type="number" class="f-input" id="traiteur-nb" placeholder="Ex : 50"/>
        <label class="f-label">Date de l'Ã©vÃ©nement *</label>
        <input type="date" class="f-input" id="traiteur-date"/>
        <label class="f-label">Budget estimÃ© <span style="font-weight:400;font-size:10px;color:#C5C5D8">(optionnel)</span></label>
        <input type="text" class="f-input" id="traiteur-budget" placeholder="Ex : 150 000 FCFA"/>
        <label class="f-label">Remarques <span style="font-weight:400;font-size:10px;color:#C5C5D8">(optionnel)</span></label>
        <textarea class="f-textarea" rows="2" id="traiteur-notes" placeholder="Allergies, restrictions alimentaires, spÃ©cialitÃ©s souhaitÃ©es..."></textarea>
      `;
    }
    showView('form');
  }, 50);
}


</script>
<script>
// Mettre Ã  jour aussi l'icÃ´ne du bas nav aprÃ¨s connexion
const _origUpdateNav = window.updateNavForAuth;
window.addEventListener('auth-changed', () => {});
// Patch pour l'icÃ´ne bottom nav - profil supprimÃ© du bas nav, rien Ã  patcher
function patchBottomNavAvatar(genre) {
  // Profil est uniquement en haut nav, plus besoin de patch bottom nav
}

// â•â• POLITIQUE DE CONFIDENTIALITÃ‰ â•â•
function openPrivacyModal() {
  const m = document.getElementById('privacy-modal');
  if (m) { m.style.display = 'flex'; }
}
function closePrivacyModal() {
  const m = document.getElementById('privacy-modal');
  if (m) { m.style.display = 'none'; }
}
window.openPrivacyModal = openPrivacyModal;
window.closePrivacyModal = closePrivacyModal;

// â•â• SYSTÃˆME DE NOTIFICATIONS â•â•
let _notifList = JSON.parse(localStorage.getItem('omni_notifs') || '[]');

function saveNotifs() {
  localStorage.setItem('omni_notifs', JSON.stringify(_notifList.slice(0, 50)));
}

// â”€â”€ Moteur audio notifications client â”€â”€
let _audioCtx = null;

// Initialiser le contexte audio au premier geste utilisateur
// (obligation navigateur : l'audio ne peut pas dÃ©marrer sans interaction)
function _initAudioCtx() {
  if (_audioCtx) return _audioCtx;
  try {
    _audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  } catch(e) {}
  return _audioCtx;
}
// Initialiser dÃ¨s le premier tap/clic n'importe oÃ¹ sur la page
document.addEventListener('click',     () => _initAudioCtx(), { once: false, passive: true });
document.addEventListener('touchstart',() => _initAudioCtx(), { once: false, passive: true });

function _playNotifSound(type) {
  const ctx = _initAudioCtx();
  if (!ctx) return;
  // Reprendre si suspendu (politique navigateur)
  if (ctx.state === 'suspended') { ctx.resume(); }

  try {
    // Sons diffÃ©rents selon le type de notification
    const presets = {
      // Commande confirmÃ©e / en cours : double ding montant doux
      'en_cours': [[880, 0, 0.18], [1108, 0.18, 0.22]],
      // Commande terminÃ©e : ding-dong-ding joyeux
      'terminee': [[1046, 0, 0.15], [1318, 0.16, 0.18], [1568, 0.34, 0.28]],
      // Info / broadcast / annulÃ©e : ding simple discret
      'default':  [[880, 0, 0.22]],
    };
    const notes = presets[type] || presets['default'];

    notes.forEach(([freq, delay, dur]) => {
      const osc  = ctx.createOscillator();
      const gain = ctx.createGain();
      // Filtre passe-bas pour un son plus doux (moins agressif que l'admin)
      const filter = ctx.createBiquadFilter();
      filter.type = 'lowpass';
      filter.frequency.value = 2200;

      osc.connect(filter);
      filter.connect(gain);
      gain.connect(ctx.destination);

      osc.type = 'sine';
      osc.frequency.setValueAtTime(freq, ctx.currentTime + delay);

      // Enveloppe douce : attaque rapide, dÃ©clin progressif
      gain.gain.setValueAtTime(0,    ctx.currentTime + delay);
      gain.gain.linearRampToValueAtTime(0.28, ctx.currentTime + delay + 0.012);
      gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + delay + dur);

      osc.start(ctx.currentTime + delay);
      osc.stop( ctx.currentTime + delay + dur + 0.05);
    });
  } catch(e) { /* audio non dispo */ }
}

function addNotification(title, message, type = 'info', orderId = null) {
  const notif = {
    id: Date.now(),
    title,
    message,
    type, // 'en_cours' | 'terminee' | 'info'
    orderId,
    time: new Date().toISOString(),
    read: false
  };
  _notifList.unshift(notif);
  saveNotifs();
  updateNotifBadge();
  renderNotifList();
  // Son de notification
  _playNotifSound(type);
  // Notification navigateur si autorisÃ©
  if (Notification.permission === 'granted') {
    const ico = type === 'en_cours' ? 'ğŸš€' : type === 'terminee' ? 'âœ…' : 'ğŸ””';
    try {
      new Notification(`${ico} OmniService TG`, { body: `${title}\n${message}`, icon: 'assets/logo.png' });
    } catch(e) {}
  }
}
window.addNotification = addNotification;

function updateNotifBadge() {
  const badge = document.getElementById('notif-badge');
  const unread = _notifList.filter(n => !n.read).length;
  if (!badge) return;
  if (unread > 0) {
    badge.textContent = unread > 9 ? '9+' : unread;
    badge.style.display = 'flex';
  } else {
    badge.style.display = 'none';
  }
}

// â”€â”€ Notifications Firestore â†’ client (broadcast + ciblÃ©es) â”€â”€
// Ã‰coute en temps rÃ©el via onSnapshot â€” rÃ©action instantanÃ©e
let _notifUnsubscribe = null;
let _notifListenerReady = false;
let _lastBroadcastCheck = parseInt(localStorage.getItem('omni_last_broadcast') || '0');

function _processNotifDoc(docSnap) {
  // Traite un document notifications_broadcast reÃ§u du listener
  const n = docSnap.data();
  const uid = window._currentUser?.uid || null;

  // Filtrer : accepter les broadcast gÃ©nÃ©raux OU les notifs ciblÃ©es pour ce client
  const isBroadcast = n.broadcast === true;
  const isTargeted  = n.broadcast === false && n.targetUid && n.targetUid === uid;
  if (!isBroadcast && !isTargeted) return;

  const notifId = 'notif_' + docSnap.id;
  if (_notifList.find(x => x.id === notifId)) return; // dÃ©jÃ  reÃ§ue

  const sentTs = n.sentAt ? n.sentAt.seconds * 1000 : Date.now();

  // Pour les broadcast, respecter le filtre lastBroadcastCheck
  if (isBroadcast && sentTs <= _lastBroadcastCheck) return;

  _notifList.unshift({
    id:       notifId,
    title:    n.titre   || 'Message de OmniService TG',
    message:  n.contenu || '',
    type:     n.type    || 'info',
    lien:     n.lien    || null,
    time:     new Date(sentTs).toISOString(),
    read:     false,
    broadcast: isBroadcast
  });

  if (isBroadcast && sentTs > _lastBroadcastCheck) {
    _lastBroadcastCheck = sentTs;
    localStorage.setItem('omni_last_broadcast', String(sentTs));
  }

  saveNotifs();
  updateNotifBadge();
  renderNotifList();
}

function startNotifListener() {
  // Attendre que Firebase soit prÃªt
  const db = window._firestoreDb;
  const utils = window._firestoreUtils;
  if (!db || !utils) {
    setTimeout(startNotifListener, 1500);
    return;
  }

  if (_notifUnsubscribe) { _notifUnsubscribe(); _notifUnsubscribe = null; }
  _notifListenerReady = false;

  const { collection, query, orderBy, onSnapshot: oS } = utils;
  // onSnapshot n'est peut-Ãªtre pas dans utils â€” rÃ©cupÃ©rer depuis window
  const _onSnap = oS || window._onSnapshot;
  if (!_onSnap) {
    // Fallback : polling toutes les 30s
    setTimeout(() => setInterval(checkBroadcastPoll, 30000), 5000);
    checkBroadcastPoll();
    return;
  }

  try {
    const q = query(collection(db, 'notifications_broadcast'), orderBy('sentAt', 'desc'));
    _notifUnsubscribe = _onSnap(q, snap => {
      if (!_notifListenerReady) {
        // PremiÃ¨re lecture : marquer les anciens comme dÃ©jÃ  vus
        _notifListenerReady = true;
        // Traiter quand mÃªme les rÃ©cents (< 5 min) lors de la premiÃ¨re lecture
        snap.docs.forEach(d => {
          const sentTs = d.data().sentAt ? d.data().sentAt.seconds * 1000 : 0;
          if (Date.now() - sentTs < 300000) _processNotifDoc(d);
        });
        return;
      }
      // AprÃ¨s init : traiter seulement les nouvelles
      snap.docChanges().forEach(change => {
        if (change.type === 'added') _processNotifDoc(change.doc);
      });
    }, err => {
      console.warn('[Notifs] onSnapshot Ã©chouÃ©, fallback polling:', err.message);
      checkBroadcastPoll();
      setInterval(checkBroadcastPoll, 30000);
    });
  } catch(e) {
    console.warn('[Notifs] startNotifListener erreur:', e.message);
    checkBroadcastPoll();
  }
}

// Fallback polling si onSnapshot non dispo
async function checkBroadcastPoll() {
  const db = window._firestoreDb;
  const utils = window._firestoreUtils;
  if (!db || !utils) return;
  const { getDocs, collection, query, orderBy } = utils;
  try {
    let snap;
    try { snap = await getDocs(query(collection(db,'notifications_broadcast'), orderBy('sentAt','desc'))); }
    catch(_) { snap = await getDocs(collection(db,'notifications_broadcast')); }
    snap.docs.forEach(d => _processNotifDoc(d));
  } catch(e) {}
}
window.checkBroadcastNotifications = checkBroadcastPoll; // compatibilitÃ©

// DÃ©marrer le listener aprÃ¨s chargement de Firebase
window.addEventListener('load', () => setTimeout(startNotifListener, 3000));

function renderNotifList() {
  const list = document.getElementById('notif-list');
  const empty = document.getElementById('notif-empty');
  if (!list) return;

  if (!_notifList.length) {
    if (empty) empty.style.display = 'block';
    list.querySelectorAll('.notif-item').forEach(n => n.remove());
    return;
  }
  if (empty) empty.style.display = 'none';

  // Remove old items (keep empty div)
  list.querySelectorAll('.notif-item').forEach(n => n.remove());

  const typeConfig = {
    en_cours:   { ico: 'ğŸš€', bg: '#E3F2FD', color: '#1E6FBE' },
    terminee:   { ico: 'âœ…', bg: '#E8F5E9', color: '#2E7D32' },
    info:       { ico: 'â„¹ï¸', bg: '#FFF3E0', color: '#F5820A' },
    promo:      { ico: 'ğŸ·ï¸', bg: '#FFF3E0', color: '#E65100' },
    alerte:     { ico: 'âš ï¸', bg: '#FFEBEE', color: '#C62828' },
    nouveaute:  { ico: 'âœ¨', bg: '#F3E5F5', color: '#7B1FA2' },
    evenement:  { ico: 'ğŸ‰', bg: '#E8F5E9', color: '#2E7D32' },
  };

  _notifList.forEach(n => {
    const cfg = typeConfig[n.type] || typeConfig.info;
    const timeAgo = formatTimeAgo(n.time);
    const el = document.createElement('div');
    el.className = `notif-item${n.read ? '' : ' unread'}`;
    el.dataset.id = n.id;
    el.innerHTML = `
      <div class="notif-ico" style="background:${cfg.bg}">
        ${cfg.ico}
      </div>
      <div style="flex:1;min-width:0">
        <div class="notif-title">${n.title}</div>
        <div class="notif-sub">${n.message}</div>
        <div class="notif-time">ğŸ• ${timeAgo}</div>
      </div>
    `;
    el.onclick = () => markNotifRead(n.id);
    list.insertBefore(el, list.querySelector('.notif-item'));
    if (!list.querySelector('.notif-item')) list.appendChild(el);
    else list.insertBefore(el, list.firstChild);
  });
}

function markNotifRead(id) {
  const n = _notifList.find(x => x.id === id);
  if (n) { n.read = true; saveNotifs(); updateNotifBadge(); renderNotifList(); }
}

function clearAllNotifs() {
  _notifList = [];
  saveNotifs();
  updateNotifBadge();
  renderNotifList();
}
window.clearAllNotifs = clearAllNotifs;

function formatTimeAgo(iso) {
  const diff = Date.now() - new Date(iso).getTime();
  const mins = Math.floor(diff / 60000);
  if (mins < 1) return "Ã€ l'instant";
  if (mins < 60) return `Il y a ${mins} min`;
  const hrs = Math.floor(mins / 60);
  if (hrs < 24) return `Il y a ${hrs}h`;
  const days = Math.floor(hrs / 24);
  return `Il y a ${days} jour${days > 1 ? 's' : ''}`;
}

function openNotifPanel() {
  const panel = document.getElementById('notif-panel');
  if (panel) {
    panel.style.display = 'flex';
    // Mark all as read after 2s
    renderNotifList();
    setTimeout(() => {
      _notifList.forEach(n => n.read = true);
      saveNotifs();
      updateNotifBadge();
    }, 2000);
  }
}
function closeNotifPanel() {
  const panel = document.getElementById('notif-panel');
  if (panel) panel.style.display = 'none';
}
window.openNotifPanel = openNotifPanel;
window.closeNotifPanel = closeNotifPanel;

// â•â• DEMANDE DE PERMISSION NOTIFICATION NAVIGATEUR â•â•
function requestNotifPermission() {
  if (!('Notification' in window)) return;
  if (Notification.permission === 'default') {
    Notification.requestPermission().then(perm => {
      if (perm === 'granted') {
        addNotification('Notifications activÃ©es !', 'Vous recevrez des alertes sur vos commandes.', 'info');
      }
    });
  }
}

// â•â• SURVEILLANCE DES CHANGEMENTS DE STATUT â•â•
// Polling Firestore toutes les 30s pour dÃ©tecter les changements de statut
let _lastOrderStatuts = {};
let _pollingInterval = null;

async function pollOrderStatuses() {
  // On a besoin de Firebase â€” attendre que app.js l'ait initialisÃ©
  if (typeof window._firestoreDb === 'undefined' || !window._currentUser) return;

  try {
    const { collection, query, where, getDocs } = window._firestoreUtils || {};
    if (!getDocs) return;
    const db = window._firestoreDb;
    const user = window._currentUser;
    const q = query(collection(db, 'commandes'), where('uid', '==', user.uid));
    const snap = await getDocs(q);
    snap.forEach(d => {
      const data = d.data();
      const id = d.id;
      const statut = data.statut || '';
      const prev = _lastOrderStatuts[id];

      if (prev !== undefined && prev !== statut) {
        // Statut changÃ© !
        const ref = '#' + id.slice(0, 8).toUpperCase();
        const svcName = data.serviceName || data.service || 'votre service';

        const _notifMap = {
          'ConfirmÃ©e': ['âœ… Commande confirmÃ©e !',
            `Votre commande ${ref} (${svcName}) a Ã©tÃ© confirmÃ©e. Notre Ã©quipe se prÃ©pare.`, 'en_cours'],
          'En cours':  ['ğŸš€ Commande en cours !',
            `Votre commande ${ref} (${svcName}) est prise en charge par notre Ã©quipe.`, 'en_cours'],
          'TerminÃ©e':  ['ğŸ‰ Commande terminÃ©e !',
            `Votre commande ${ref} (${svcName}) est terminÃ©e. Merci de votre confiance â€” OmniService TG ğŸ™`, 'terminee'],
          'AnnulÃ©e':   ['âŒ Commande annulÃ©e',
            `Votre commande ${ref} (${svcName}) a Ã©tÃ© annulÃ©e. Contactez-nous pour plus d'informations.`, 'info'],
        };
        const _nm = _notifMap[statut];
        if (_nm) addNotification(_nm[0], _nm[1], _nm[2], id);
      }
      _lastOrderStatuts[id] = statut;
    });
  } catch(e) {
    // Silencieux en cas d'erreur
  }
}

// Exposer les utils Firestore depuis app.js via window
// (app.js doit exposer window._firestoreDb, window._firestoreUtils, window._currentUser)

// â•â• COMPTE Ã€ REBOURS PAGE SUCCÃˆS â•â•
let _succCountdownTimer = null;
// Patch showView pour dÃ©marrer le compte Ã  rebours quand on arrive sur 'success'
const _origShowView = window.showView;
window.showView = function(v) {
  if (_origShowView) _origShowView(v);
  if (v === 'success') {
    startSuccessCountdown();
  } else {
    stopSuccessCountdown();
  }
};

function startSuccessCountdown() {
  stopSuccessCountdown();
  let count = 3;
  const el = document.getElementById('succ-countdown');
  const msgEl = document.getElementById('succ-redirect-msg');
  if (el) el.textContent = count;
  if (msgEl) msgEl.style.display = 'block';

  _succCountdownTimer = setInterval(() => {
    count--;
    if (el) el.textContent = count;
    if (count <= 0) {
      stopSuccessCountdown();
      if (typeof goTab === 'function') goTab('orders');
    }
  }, 1000);
}

function stopSuccessCountdown() {
  if (_succCountdownTimer) {
    clearInterval(_succCountdownTimer);
    _succCountdownTimer = null;
  }
}

// â•â• PATCH submitImmoForm : gÃ¨re le select dÃ©roulant direct (Gestion & Assistance) â•â•
window.addEventListener('load', () => {
  setTimeout(() => {
    const _origSubmitImmo = window.submitImmoForm;
    window.submitImmoForm = async function() {
      // Si on vient du formulaire direct avec select (renderImmoSelection)
      if (window._immoCurrentSelectionSub) {
        const currentUser = window._currentUser;
        if (!currentUser) { if (window.openAuthModal) window.openAuthModal('login'); return; }

        // VÃ©rifier qu'une option a Ã©tÃ© sÃ©lectionnÃ©e dans le select
        if (!window._immoCurrentSelectionOpt) {
          const sel = document.getElementById('immo-ff-type-select');
          if (sel) sel.style.borderColor = '#F5820A';
          if (window.showToast) window.showToast('âš ï¸ Veuillez sÃ©lectionner un type', '#F5820A');
          return;
        }

        const { sub, opt } = window._immoCurrentSelectionOpt;
        const besoin       = document.getElementById('immo-ff-besoin')?.value.trim();
        const localisation = document.getElementById('immo-ff-localisation')?.value.trim();
        const budget       = document.getElementById('immo-ff-budget')?.value.trim();
        const date         = document.getElementById('immo-ff-date')?.value.trim();
        const notes        = document.getElementById('immo-ff-notes')?.value.trim();

        if (!besoin) {
          const el = document.getElementById('immo-ff-besoin');
          if (el) el.style.borderColor = '#F5820A';
          if (window.showToast) window.showToast('âš ï¸ Remplissez la description de votre besoin', '#F5820A');
          return;
        }

        const btn = document.getElementById('immo-form-submit-btn');
        if (btn) { btn.innerHTML = '<span class="spinner"></span> Envoi...'; btn.disabled = true; }

        try {
          const db    = window._firestoreDb;
          const utils = window._firestoreUtils;
          const { collection, serverTimestamp, addDoc } = await import('https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js');

          const isGestion = sub.id === 'immo_gestion';
          const serviceName = isGestion
            ? `Immobilier â€” Gestion Locative â€” ${opt.label}`
            : `Immobilier â€” Assistance â€” ${opt.label}`;

          const docRef = await addDoc(collection(db, 'commandes'), {
            service:           'immobilier',
            serviceName,
            statut:            'En attente',
            immoCategorieId:   sub.id,
            immoCategorieNom:  sub.name,
            immoPrestation:    opt.label,
            immoPrestationEmoji: opt.emoji || 'ğŸ¢',
            besoin,
            localisation:      localisation || '',
            budget:            budget       || '',
            dateSouhaitee:     date         || '',
            notes:             notes        || '',
            uid:               currentUser.uid,
            clientNom:         currentUser.nom    || '',
            clientPrenom:      currentUser.prenom || '',
            clientGenre:       currentUser.genre  || '',
            phone:             currentUser.phone  || '',
            clientVille:       currentUser.ville  || '',
            createdAt:         serverTimestamp()
          });

          // RÃ©initialiser les Ã©tats
          window._immoCurrentSelectionSub = null;
          window._immoCurrentSelectionOpt = null;

          const succMsg = document.getElementById('succ-msg');
          if (succMsg) succMsg.innerHTML =
            `Demande <strong style="color:var(--blue)">${opt.label}</strong> envoyÃ©e !<br/>
             RÃ©fÃ©rence : <strong>#${docRef.id.slice(0,8).toUpperCase()}</strong><br/>
             Notre Ã©quipe vous contactera trÃ¨s bientÃ´t.<br/>
             <small style="color:var(--light)">Contact : ${currentUser.phone || ''}</small>`;

          if (window.showSuccessView) window.showSuccessView();
        } catch(err) {
          console.error(err);
          if (window.showToast) window.showToast('âŒ Erreur d\'envoi. VÃ©rifiez votre connexion.', '#C62828');
          if (btn) { btn.innerHTML = 'ğŸ“¨ Envoyer ma demande'; btn.disabled = false; }
        }
        return;
      }

      // Sinon, comportement original (autres sous-services immo)
      if (_origSubmitImmo) _origSubmitImmo();
    };
  }, 600);
});Ali

// DÃ©marrer le polling et les initialisations
window.addEventListener('DOMContentLoaded', () => {
  updateNotifBadge();
  renderNotifList();

  // Demander permission notification aprÃ¨s 5s
  setTimeout(requestNotifPermission, 5000);

  // Polling toutes les 30s
  _pollingInterval = setInterval(pollOrderStatuses, 30000);
});

</script>
</body>
</html>
